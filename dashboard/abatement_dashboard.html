<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="robots" content="noindex, nofollow">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The 8,760 Problem — CO₂ Abatement Analysis</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Rajdhani:wght@400;500;600;700&family=Barlow+Semi+Condensed:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles/shared.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
<style>
/* Page-specific background */
body { background: #F3F4F8; }

/* ========== FOOTER ========== */
.page-footer {
    background: #0F1A2E;
    color: rgba(255,255,255,0.7);
    padding: 32px 24px;
    text-align: center;
}
.footer-links { display: flex; flex-wrap: wrap; gap: 24px; justify-content: center; margin-bottom: 12px; }
.footer-links a { color: rgba(255,255,255,0.65); text-decoration: none; font-size: 0.85rem; font-weight: 500; transition: color 0.2s; }
.footer-links a:hover { color: #ffffff; }
.footer-note { font-size: 0.78rem; color: rgba(255,255,255,0.4); }

.bottom-banner {
    height: 4px;
    background: linear-gradient(90deg, #1A2744 0%, #0EA5E9 25%, #22C55E 50%, #F59E0B 75%, #EF4444 100%);
}

/* ========== HERO SCROLLYTELL ========== */
.hero-scrolly {
    background: linear-gradient(180deg, #0B1120 0%, #13203D 100%);
    position: relative;
    overflow: hidden;
}
.hero-scrolly::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse at 30% 20%, rgba(14,165,233,0.08) 0%, transparent 60%),
                radial-gradient(ellipse at 70% 80%, rgba(233,30,99,0.06) 0%, transparent 60%);
    pointer-events: none;
}
.hero-scrolly-container {
    position: relative;
    display: flex;
    max-width: 1400px;
    margin: 0 auto;
}
.hero-scrolly-sticky {
    position: sticky;
    top: 0;
    width: 55%;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 32px;
    z-index: 1;
}

/* ---- Multi-panel chart container ---- */
.hero-chart-panels {
    position: relative;
    width: 100%;
}
.chart-panel {
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border: 1px solid rgba(74,144,217,0.2);
    border-radius: 16px;
    padding: 28px 24px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.3);
    width: 100%;
    height: 480px;
}
.chart-panel canvas {
    width: 100% !important;
    height: 380px !important;
}
/* Default panel (overview) — dark blue glass */
.chart-panel-overview {
    background: rgba(15,26,46,0.85);
}
/* Regional panels — black background */
.chart-panel-region {
    background: rgba(0,0,0,0.95);
    border-color: rgba(255,255,255,0.08);
}
/* Hidden panel */
.chart-panel.panel-hidden {
    display: none;
}
/* Fade-in animation when panel appears */
@keyframes chartPanelIn {
    from { opacity: 0; transform: scale(0.97); }
    to   { opacity: 1; transform: scale(1); }
}
.chart-panel.panel-animate {
    animation: chartPanelIn 0.5s ease forwards;
}

.hero-chart-title {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-size: 0.85rem;
    font-weight: 700;
    color: rgba(255,255,255,0.85);
    text-align: center;
    margin-bottom: 10px;
    letter-spacing: 0.02em;
    transition: opacity 0.4s;
}
.hero-chart-subtitle {
    font-family: 'Barlow Semi Condensed', sans-serif;
    font-size: 0.72rem;
    color: rgba(255,255,255,0.45);
    text-align: center;
    margin-top: 6px;
}
.hero-scrolly-steps {
    width: 45%;
    position: relative;
    z-index: 2;
}
.hero-scrolly-step {
    min-height: 85vh;
    display: flex;
    align-items: center;
    padding: 80px 48px 80px 40px;
    opacity: 0;
    transform: translateY(40px);
    transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}
.hero-scrolly-step:first-child { padding-top: 120px; }
.hero-scrolly-step:last-child { padding-bottom: 120px; }
.hero-scrolly-step.visible {
    opacity: 1;
    transform: translateY(0);
}
.hero-step-card {
    background: rgba(255,255,255,0.06);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 16px;
    padding: 32px;
    transition: border-color 0.4s, box-shadow 0.4s, transform 0.4s;
}
.hero-scrolly-step.active .hero-step-card {
    border-color: rgba(14,165,233,0.4);
    box-shadow: 0 10px 30px rgba(14,165,233,0.1);
    transform: translateY(-2px);
}
.hero-step-card h3 {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-size: 1.5rem;
    font-weight: 800;
    color: #fff;
    margin-bottom: 12px;
    line-height: 1.25;
    letter-spacing: -0.3px;
}
.hero-step-card p {
    font-size: 0.92rem;
    color: rgba(255,255,255,0.75);
    line-height: 1.75;
    margin-bottom: 0;
}
.hero-step-card .step-stat {
    display: inline-block;
    margin-top: 14px;
    padding: 8px 16px;
    border-radius: 10px;
    font-family: 'Barlow Semi Condensed', sans-serif;
    font-size: 0.88rem;
    font-weight: 700;
}
.step-stat-green {
    background: rgba(34,197,94,0.12);
    border: 1px solid rgba(34,197,94,0.25);
    color: #4ade80;
}
.step-stat-amber {
    background: rgba(245,158,11,0.12);
    border: 1px solid rgba(245,158,11,0.25);
    color: #fbbf24;
}
.step-stat-red {
    background: rgba(239,68,68,0.12);
    border: 1px solid rgba(239,68,68,0.25);
    color: #f87171;
}
.step-stat-blue {
    background: rgba(14,165,233,0.12);
    border: 1px solid rgba(14,165,233,0.25);
    color: #38bdf8;
}
/* Region color accent tags */
.hero-step-card .region-tag {
    display: inline-block;
    padding: 3px 10px;
    border-radius: 6px;
    font-family: 'Barlow Semi Condensed', sans-serif;
    font-size: 0.75rem;
    font-weight: 700;
    letter-spacing: 0.04em;
    margin-bottom: 10px;
    text-transform: uppercase;
}

/* ========== FIGURE LEGENDS ========== */
.chart-legend {
    display: flex;
    flex-wrap: wrap;
    gap: 6px 16px;
    justify-content: center;
    padding: 8px 12px 2px;
    margin-top: 4px;
}
.chart-legend-item {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-family: 'Barlow Semi Condensed', sans-serif;
    font-size: 0.7rem;
    color: rgba(255,255,255,0.6);
    white-space: nowrap;
}
.chart-legend-swatch {
    display: inline-block;
    flex-shrink: 0;
}
/* Solid line swatch */
.swatch-line {
    width: 18px;
    height: 3px;
    border-radius: 1.5px;
}
/* Dashed line swatch */
.swatch-dashed {
    width: 18px;
    height: 0;
    border-top: 2px dashed;
}
/* Shaded band swatch */
.swatch-band {
    width: 18px;
    height: 10px;
    border-radius: 2px;
    border: 1px solid rgba(255,255,255,0.15);
}
/* Dot swatch for regional envelope */
.swatch-dot-line {
    width: 18px;
    height: 3px;
    border-radius: 1.5px;
    position: relative;
}
.swatch-dot-line::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 5px;
    height: 5px;
    border-radius: 50%;
    background: inherit;
    border: 1px solid rgba(0,0,0,0.5);
}
/* Legend divider */
.chart-legend-divider {
    width: 1px;
    height: 12px;
    background: rgba(255,255,255,0.15);
    align-self: center;
}

/* ========== RESPONSIVE ========== */
@media (max-width: 900px) {
    .hero-scrolly-container { flex-direction: column; }
    .hero-scrolly-sticky { width: 100%; height: 45vh; min-height: 350px; position: sticky; top: 0; padding: 16px; }
    .chart-panel { height: 350px; padding: 16px 14px; }
    .chart-panel canvas { height: 240px !important; }
    .hero-scrolly-steps { width: 100%; }
    .hero-scrolly-step { min-height: auto; padding: 40px 20px; }
    .hero-step-card { padding: 24px 20px; }
    .hero-step-card h3 { font-size: 1.25rem; }
    .chart-legend { gap: 4px 10px; padding: 6px 8px 2px; }
    .chart-legend-item { font-size: 0.62rem; }
    .swatch-line, .swatch-dashed, .swatch-dot-line { width: 14px; }
    .swatch-band { width: 14px; height: 8px; }
}
@media (max-width: 600px) {
    .hero-scrolly-sticky { height: 38vh; min-height: 320px; padding: 10px; }
    .chart-panel { height: 320px; padding: 12px 10px; }
    .chart-panel canvas { height: 200px !important; }
    .hero-scrolly-step { padding: 28px 14px; }
    .hero-step-card { padding: 18px 14px; }
    .hero-step-card h3 { font-size: 1.05rem; }
    .hero-step-card p { font-size: 0.85rem; }
    .chart-legend { gap: 3px 8px; padding: 4px 4px 0; }
    .chart-legend-item { font-size: 0.58rem; gap: 4px; }
    .swatch-line, .swatch-dashed, .swatch-dot-line { width: 12px; }
    .swatch-band { width: 12px; height: 7px; }
    .chart-legend-divider { height: 10px; }
}
</style>
</head>
<body>

<!-- TOP NAV (injected by nav.js) -->
<nav id="topNav"></nav>
<script src="js/nav.js"></script>
<div style="background:#F3F4F8;padding:8px 24px;"><a href="index.html" style="font-family:'Franklin Gothic Demi','Barlow Semi Condensed',sans-serif;font-size:0.82rem;font-weight:600;color:#1A2744;text-decoration:none;display:inline-flex;align-items:center;gap:6px;letter-spacing:0.03em;min-height:44px;"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>Back to Home</a></div>

<!-- HEADER BANNER -->
<header class="header">
    <h1>The 8,760 Problem</h1>
    <p class="subtitle">Comparing the cost of CO₂ abatement through hourly clean energy procurement across regions and ambition levels</p>
    <div class="header-accent"></div>
</header>

<!-- HERO SCROLLYTELL -->
<section class="hero-scrolly">
    <div class="hero-scrolly-container">
        <!-- Sticky chart panel — swaps between overview + per-region envelopes -->
        <div class="hero-scrolly-sticky">
            <div class="hero-chart-panels">
                <!-- Overview panel (all regions) -->
                <div class="chart-panel chart-panel-overview panel-animate" id="chartPanel_overview">
                    <div class="hero-chart-title" id="heroChartTitle">Marginal Abatement Cost vs. Projected DAC — All Regions</div>
                    <canvas id="heroScrollyChart"></canvas>
                    <div class="chart-legend">
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-line" style="background:#22C55E;"></span>ERCOT</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-line" style="background:#4a90d9;"></span>PJM</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-line" style="background:#F59E0B;"></span>CAISO</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-line" style="background:#E91E63;"></span>NYISO</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-line" style="background:#9C27B0;"></span>NEISO</span>
                        <span class="chart-legend-divider"></span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-band" style="background:rgba(255,255,255,0.12);"></span>P10&ndash;P90 band</span>
                        <span class="chart-legend-divider"></span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dashed" style="border-color:#E91E6399;"></span>DAC Central</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dashed" style="border-color:#E91E6344;"></span>DAC Opt. / Cons.</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-band" style="background:rgba(233,30,99,0.08);"></span>DAC range</span>
                    </div>
                </div>
                <!-- ERCOT envelope -->
                <div class="chart-panel chart-panel-region panel-hidden" id="chartPanel_ercot">
                    <div class="hero-chart-title">ERCOT (Texas)</div>
                    <canvas id="envScrolly_ERCOT"></canvas>
                    <div class="chart-legend">
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dot-line" style="background:#22C55E;"></span>Stepwise envelope (Medium cost)</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-band" style="background:rgba(34,197,94,0.25);"></span>P10&ndash;P90 sensitivity band</span>
                        <span class="chart-legend-divider"></span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dashed" style="border-color:#E91E6399;"></span>DAC Central</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dashed" style="border-color:#E91E6344;"></span>DAC Opt. / Cons.</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-band" style="background:rgba(233,30,99,0.08);"></span>DAC range</span>
                    </div>
                </div>
                <!-- PJM envelope -->
                <div class="chart-panel chart-panel-region panel-hidden" id="chartPanel_pjm">
                    <div class="hero-chart-title">PJM (Mid-Atlantic)</div>
                    <canvas id="envScrolly_PJM"></canvas>
                    <div class="chart-legend">
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dot-line" style="background:#4a90d9;"></span>Stepwise envelope (Medium cost)</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-band" style="background:rgba(74,144,217,0.25);"></span>P10&ndash;P90 sensitivity band</span>
                        <span class="chart-legend-divider"></span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dashed" style="border-color:#E91E6399;"></span>DAC Central</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dashed" style="border-color:#E91E6344;"></span>DAC Opt. / Cons.</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-band" style="background:rgba(233,30,99,0.08);"></span>DAC range</span>
                    </div>
                </div>
                <!-- CAISO envelope -->
                <div class="chart-panel chart-panel-region panel-hidden" id="chartPanel_caiso">
                    <div class="hero-chart-title">CAISO (California)</div>
                    <canvas id="envScrolly_CAISO"></canvas>
                    <div class="chart-legend">
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dot-line" style="background:#F59E0B;"></span>Stepwise envelope (Medium cost)</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-band" style="background:rgba(245,158,11,0.25);"></span>P10&ndash;P90 sensitivity band</span>
                        <span class="chart-legend-divider"></span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dashed" style="border-color:#E91E6399;"></span>DAC Central</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dashed" style="border-color:#E91E6344;"></span>DAC Opt. / Cons.</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-band" style="background:rgba(233,30,99,0.08);"></span>DAC range</span>
                    </div>
                </div>
                <!-- NYISO envelope -->
                <div class="chart-panel chart-panel-region panel-hidden" id="chartPanel_nyiso">
                    <div class="hero-chart-title">NYISO (New York)</div>
                    <canvas id="envScrolly_NYISO"></canvas>
                    <div class="chart-legend">
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dot-line" style="background:#E91E63;"></span>Stepwise envelope (Medium cost)</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-band" style="background:rgba(233,30,99,0.25);"></span>P10&ndash;P90 sensitivity band</span>
                        <span class="chart-legend-divider"></span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dashed" style="border-color:#E91E6399;"></span>DAC Central</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dashed" style="border-color:#E91E6344;"></span>DAC Opt. / Cons.</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-band" style="background:rgba(233,30,99,0.08);"></span>DAC range</span>
                    </div>
                </div>
                <!-- NEISO envelope -->
                <div class="chart-panel chart-panel-region panel-hidden" id="chartPanel_neiso">
                    <div class="hero-chart-title">NEISO (New England)</div>
                    <canvas id="envScrolly_NEISO"></canvas>
                    <div class="chart-legend">
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dot-line" style="background:#9C27B0;"></span>Stepwise envelope (Medium cost)</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-band" style="background:rgba(156,39,176,0.25);"></span>P10&ndash;P90 sensitivity band</span>
                        <span class="chart-legend-divider"></span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dashed" style="border-color:#E91E6399;"></span>DAC Central</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-dashed" style="border-color:#E91E6344;"></span>DAC Opt. / Cons.</span>
                        <span class="chart-legend-item"><span class="chart-legend-swatch swatch-band" style="background:rgba(233,30,99,0.08);"></span>DAC range</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Scrolly narrative steps -->
        <div class="hero-scrolly-steps">

            <!-- Act 1: The framing -->
            <div class="hero-scrolly-step" data-hero-step="overview">
                <div class="hero-step-card">
                    <h3>Today's investment decisions determine where grid decarb outcompetes DAC</h3>
                    <p>The marginal cost of each additional percent of clean energy — not the average — determines when DAC becomes the cheaper path. Across thousands of sensitivity scenarios per region, the crossover point shifts by 10–25 percentage points depending on which technologies get investment today. Early bets on nuclear, geothermal, or renewables have catalytic effects on how deep grid decarbonization can go before DAC wins.</p>
                    <span class="step-stat step-stat-blue">5,832+ cost scenarios &times; 5 ISOs: crossover shifts 10–25 points on policy choices</span>
                </div>
            </div>

            <!-- Act 2: ERCOT -->
            <div class="hero-scrolly-step" data-hero-step="ercot">
                <div class="hero-step-card">
                    <span class="region-tag" style="background:rgba(34,197,94,0.15);color:#22C55E;">ERCOT</span>
                    <h3>Renewable tax credits make ERCOT a no-regrets bet to 97.5%</h3>
                    <p>At medium costs, ERCOT's grid decarb beats central DAC through 97.5%. With low renewable costs — the trajectory sustained by IRA tax credits — the crossover extends to 99%. Even under all-high cost assumptions, grid investment wins to 97.5%. ERCOT is the strongest case for continued grid investment: deep solar/wind resources mean no plausible future where DAC is cheaper before ~95%.</p>
                    <span class="step-stat step-stat-green">Low renewables: grid wins to 99% &middot; All High: still wins to 97.5%</span>
                </div>
            </div>

            <!-- Act 3: PJM -->
            <div class="hero-scrolly-step" data-hero-step="pjm">
                <div class="hero-step-card">
                    <span class="region-tag" style="background:rgba(74,144,217,0.15);color:#4a90d9;">PJM</span>
                    <h3>PJM hits a cliff at 90%: cheap firm generation buys another 2.5 points</h3>
                    <p>At medium costs, PJM's marginal grid cost beats DAC central through 90%. Low firm generation costs (achieved nuclear/geothermal) extend this to 92.5%. But high renewables + high firm gen drops the crossover to just 87.5%. The policy signal: PJM's path past 90% depends entirely on whether new nuclear generation achieves cost learning — renewables alone aren't enough at these penetration levels.</p>
                    <span class="step-stat step-stat-amber">Low firm gen: grid wins to 92.5% &middot; High firm + high RE: only 87.5%</span>
                </div>
            </div>

            <!-- Act 4: CAISO -->
            <div class="hero-scrolly-step" data-hero-step="caiso">
                <div class="hero-step-card">
                    <span class="region-tag" style="background:rgba(245,158,11,0.15);color:#F59E0B;">CAISO</span>
                    <h3>CAISO: High marginal cost volatility, but grid still wins deep under medium costs</h3>
                    <p>CAISO shows extreme marginal cost swings — $738/metric ton at 75% under medium costs, yet grid still beats DAC central through 99% because later steps are cheap. The variance is driven by how new nuclear resources dispatch. Low firm + low renewable costs extend the crossover to 97.5%. High firm + high renewable costs mean grid never beats even optimistic DAC. The lesson: CAISO's path past 90% is a bet on firm generation, not more solar.</p>
                    <span class="step-stat step-stat-red">High firm + high RE: grid never beats optimistic DAC &middot; Low combo: wins to 97.5%</span>
                </div>
            </div>

            <!-- Act 5: NYISO -->
            <div class="hero-scrolly-step" data-hero-step="nyiso">
                <div class="hero-step-card">
                    <span class="region-tag" style="background:rgba(233,30,99,0.15);color:#E91E63;">NYISO</span>
                    <h3>NYISO: Hydro and nuclear carry the grid to 85%, then costs spike</h3>
                    <p>New York benefits from significant existing hydro and nuclear capacity, keeping marginal abatement costs moderate through 85% clean energy. At medium costs, grid decarb beats DAC central through 85%. Low firm generation costs push the crossover to 90% — but the gain is narrow. Past 90%, NYISO's limited wind resource and constrained transmission corridors drive marginal costs sharply higher. New York's climate law (CLCPA) requires either breakthrough firm generation costs or acceptance that DAC closes the final gap more cheaply.</p>
                    <span class="step-stat step-stat-red">Medium: grid wins to 85% &middot; Low firm gen: 90% &middot; High costs: only 80%</span>
                </div>
            </div>

            <!-- Act 6: NEISO -->
            <div class="hero-scrolly-step" data-hero-step="neiso">
                <div class="hero-step-card">
                    <span class="region-tag" style="background:rgba(156,39,176,0.15);color:#9C27B0;">NEISO</span>
                    <h3>NEISO: The strongest case for nuclear — 15-point gain from cheap firm generation</h3>
                    <p>New England faces the steepest marginal cost curve of any region. At medium costs, grid decarb only beats DAC central through 70% — the lowest crossover of any ISO. But low firm + low renewable costs push this to 85%, a 15-point gain that represents the largest catalytic effect anywhere in the study. NEISO's winter gas pipeline constraints add $13/MWh to CCS costs, making nuclear and enhanced geothermal the decisive technologies. Without firm generation cost reductions, New England hits a hard economic wall at 70%.</p>
                    <span class="step-stat step-stat-red">Medium: only 70% &middot; Low firm + low RE: 85% (15-point catalytic gain)</span>
                </div>
            </div>

            <!-- Act 7: Policy synthesis -->
            <div class="hero-scrolly-step" data-hero-step="drivers">
                <div class="hero-step-card">
                    <h3>Three policy levers, three different effects</h3>
                    <p><strong>Renewable tax credits</strong> (IRA/PTC/ITC) are most catalytic in ERCOT, extending grid competitiveness to 99%. Moderate effect in PJM/CAISO. Minimal impact in the Northeast where the constraint is firm generation, not renewables.<br><br>
                    <strong>Nuclear/geothermal investment</strong> (NRC licensing, DOE LPO loans, HALEU supply) is decisive in NYISO/NEISO/CAISO. Cheap firm generation shifts the DAC crossover 10–15 percentage points higher.<br><br>
                    <strong>Storage costs</strong> contribute &lt;1% of variance in every region — battery/LDES prices are not the bottleneck.</p>
                    <span class="step-stat step-stat-blue">RE credits: +2–5 pts &middot; Firm gen: +10–15 pts &middot; Storage: ~0 pts</span>
                </div>
            </div>

            <!-- Act 8: Bottom line -->
            <div class="hero-scrolly-step" data-hero-step="conclusion">
                <div class="hero-step-card">
                    <h3>The optimal strategy: grid to the crossover, DAC for the rest</h3>
                    <p>Grid decarbonization is the cheaper abatement path to at least 85–90% in every region under any cost scenario. Past that, the right answer depends on today's policy choices. Investment in firm clean generation (nuclear, enhanced geothermal, CCS) has the largest catalytic effect — buying 10–15 additional points of grid decarb that outcompetes DAC. Renewable tax credits are necessary but not sufficient in high-cost regions. The optimal portfolio: push grid decarb to its natural crossover point, then let DAC close the gap.</p>
                    <span class="step-stat step-stat-green">Grid to 85–97.5% (region-dependent) &middot; DAC for the final stretch</span>
                </div>
            </div>

        </div>
    </div>
</section>

<!-- SOURCES -->
<div style="max-width:1320px;margin:0 auto;padding:24px 24px 24px;">
    <details style="background:#fff;border:1px solid #E5E7EB;border-radius:10px;padding:16px 20px;">
        <summary style="font-family:'Franklin Gothic Demi','Barlow Semi Condensed',sans-serif;font-size:0.9rem;font-weight:600;color:#1A2744;cursor:pointer;">Sources &amp; References</summary>
        <ol style="font-size:0.8rem;color:#6B7280;line-height:1.8;padding-left:20px;margin-top:12px;">
            <li>EPA eGRID 2022 — regional emission rates and CO&#8322; intensity by balancing authority.</li>
            <li>EPA Social Cost of Carbon — Technical Support Document (2020), central estimate $51/metric ton.</li>
            <li>Rennert, K. et al. (2022). "Comprehensive evidence implies a higher social cost of CO&#8322;." <em>Nature</em>, 610, 687-692. $185/metric ton.</li>
            <li>EU Emissions Trading System (EU ETS) — carbon price range $60-100/metric ton.</li>
            <li>NREL Annual Technology Baseline (ATB) 2024 — technology costs for wind, solar, storage, nuclear, CCS, DAC.</li>
            <li>Lazard Levelized Cost of Energy Analysis v17.0 (2024) — generation technology cost benchmarks.</li>
            <li>EIA Hourly Electric Grid Monitor — hourly generation data by fuel type and balancing authority.</li>
            <li>IEA Net Zero by 2050 Roadmap (2023 update) — sector emission reduction benchmarks.</li>
            <li>IPCC AR6 Working Group III (2022) — power sector targets and mitigation pathways.</li>
            <li>McKinsey Marginal Abatement Cost Curve methodology — cross-sector decarbonization benchmarks.</li>
        </ol>
    </details>
</div>

<!-- FOOTER -->
<footer class="page-footer">
    <div class="footer-links">
        <a href="index.html">Home</a>
        <a href="dashboard.html">Cost Optimizer</a>
        <a href="abatement_dashboard.html">CO&#8322; Abatement</a>
        <a href="research_paper.html">Methodology &amp; Paper</a>
        <a href="about.html">About</a>
        <a href="../power-gen-decarbonization/site/index.html">Generator Analysis</a>
    </div>
    <div class="footer-note">The 8,760 Problem &mdash; 2025 Snapshot Model</div>
</footer>
<div class="bottom-banner"></div>

<script src="js/shared-data.js"></script>
<script src="js/mac-stats-data.js"></script>
<script>
// ============================================================================
// CHART INSTANCES & STATE
// ============================================================================
let heroChart = null;
const regionCharts = {};
let activePanel = 'overview';
const yMaxHero = 700;

const STEP_TO_PANEL = {
    overview:   'overview',
    ercot:      'ercot',
    pjm:        'pjm',
    caiso:      'caiso',
    nyiso:      'nyiso',
    neiso:      'neiso',
    drivers:    'overview',
    conclusion: 'overview'
};

const PANEL_TO_ISO = {
    ercot: 'ERCOT',
    pjm:   'PJM',
    caiso: 'CAISO',
    nyiso: 'NYISO',
    neiso: 'NEISO'
};

const REGION_NAMES = {
    CAISO: 'CAISO (California)',
    ERCOT: 'ERCOT (Texas)',
    PJM:   'PJM (Mid-Atlantic)',
    NYISO: 'NYISO (New York)',
    NEISO: 'NEISO (New England)'
};

// ============================================================================
// PANEL SWITCHING
// ============================================================================
function switchPanel(panelName) {
    if (panelName === activePanel) return;
    const allPanels = document.querySelectorAll('.chart-panel');
    allPanels.forEach(p => {
        p.classList.add('panel-hidden');
        p.classList.remove('panel-animate');
    });
    const target = document.getElementById('chartPanel_' + panelName);
    if (target) {
        target.classList.remove('panel-hidden');
        // Trigger entrance animation
        void target.offsetWidth;
        target.classList.add('panel-animate');
    }
    // Build regional chart lazily on first show (Chart.js needs visible canvas for sizing)
    if (panelName !== 'overview') {
        const iso = PANEL_TO_ISO[panelName];
        if (iso && !regionCharts[iso]) {
            // First time showing — build chart now that canvas is visible
            requestAnimationFrame(() => buildRegionalChart(iso));
        } else if (iso && regionCharts[iso]) {
            regionCharts[iso].reset();
            regionCharts[iso].update('active');
        }
    } else {
        if (heroChart) { heroChart.reset(); heroChart.update('active'); }
    }
    activePanel = panelName;
}

// ============================================================================
// DAC CURVE THRESHOLDS (shared by all charts)
// ============================================================================
const dacCurveThresholds = [];
for (let t = 50; t <= 100; t += 2.5) dacCurveThresholds.push(t);

function dacDatasets() {
    const dacOpt = dacCurveThresholds.map(t => ({ x: t, y: dacCostAtThreshold(t, 'optimistic') }));
    const dacCen = dacCurveThresholds.map(t => ({ x: t, y: dacCostAtThreshold(t, 'central') }));
    const dacCon = dacCurveThresholds.map(t => ({ x: t, y: dacCostAtThreshold(t, 'conservative') }));
    return [
        { label: 'DAC Optimistic', data: dacOpt, borderColor: '#E91E6366',
          borderWidth: 1.5, borderDash: [4, 3], pointRadius: 0, fill: false, tension: 0.3, order: 2, _type: 'dac' },
        { label: 'DAC Central', data: dacCen, borderColor: '#E91E6399',
          borderWidth: 2, borderDash: [6, 4], pointRadius: 0, fill: '-1', backgroundColor: 'rgba(255,193,7,0.10)', tension: 0.3, order: 2, _type: 'dac' },
        { label: 'DAC Conservative', data: dacCon, borderColor: '#E91E6344',
          borderWidth: 1.5, borderDash: [4, 3], pointRadius: 0, fill: '-1', backgroundColor: 'rgba(233,30,99,0.08)', tension: 0.3, order: 2, _type: 'dac' }
    ];
}

// ============================================================================
// BUILD HERO CHART (all regions, overview/drivers/conclusion)
// ============================================================================
function buildHeroChart() {
    const ctx = document.getElementById('heroScrollyChart')?.getContext('2d');
    if (!ctx) return;

    const regions = ['ERCOT', 'PJM', 'CAISO', 'NYISO', 'NEISO'];
    const colors = { ERCOT: '#22C55E', PJM: '#4a90d9', CAISO: '#F59E0B', NYISO: '#E91E63', NEISO: '#9C27B0' };

    const stepFan = typeof MAC_STEPWISE_FAN !== 'undefined' ? MAC_STEPWISE_FAN : null;
    const stepEnv = typeof MAC_ENVELOPE_DATA !== 'undefined' ? MAC_ENVELOPE_DATA : null;
    const avgFan = typeof MAC_FAN_DATA !== 'undefined' ? MAC_FAN_DATA : null;

    const datasets = [];
    regions.forEach((iso, rIdx) => {
        const fan = stepFan?.[iso];
        const env = stepEnv?.[iso]?.stepwise_envelope;
        const fb = avgFan?.[iso];
        if (!fan && !env) return;
        const c = colors[iso];

        const p90pts = (fan?.p90 || []).map((v, i) => {
            const val = v ?? fb?.p90?.[i] ?? null;
            return { x: THRESHOLDS[i], y: val != null ? Math.min(val, yMaxHero) : null };
        }).filter(d => d.y != null);
        const p10pts = (fan?.p10 || []).map((v, i) => {
            const val = v ?? fb?.p10?.[i] ?? null;
            return { x: THRESHOLDS[i], y: val != null ? Math.min(val, yMaxHero) : null };
        }).filter(d => d.y != null);
        const envPts = (env || fan?.p50 || []).map((v, i) => {
            const val = v ?? fb?.p50?.[i] ?? null;
            return { x: THRESHOLDS[i], y: val != null ? Math.min(val, yMaxHero) : null };
        }).filter(d => d.y != null);

        datasets.push({
            label: iso + ' P90', data: p90pts, borderColor: 'transparent', backgroundColor: c + '15',
            borderWidth: 0, pointRadius: 0, fill: '+1', tension: 0.3, order: 10,
            _region: iso, _type: 'band'
        });
        datasets.push({
            label: iso + ' P10', data: p10pts, borderColor: c + '30', backgroundColor: 'transparent',
            borderWidth: 0.5, borderDash: [2, 2], pointRadius: 0, fill: false, tension: 0.3, order: 10,
            _region: iso, _type: 'band'
        });
        datasets.push({
            label: iso, data: envPts, borderColor: c, backgroundColor: c + '10',
            borderWidth: 2.5, pointRadius: 0, fill: false, tension: 0.3, order: 5,
            _region: iso, _type: 'line'
        });
    });

    datasets.push(...dacDatasets());

    heroChart = new Chart(ctx, {
        type: 'line',
        data: { datasets },
        options: {
            responsive: true, maintainAspectRatio: false,
            animation: {
                duration: 1200,
                easing: 'easeOutQuart',
                delay: ctx => ctx.type === 'data' ? ctx.dataIndex * 30 + ctx.datasetIndex * 100 : 0
            },
            scales: {
                x: {
                    type: 'linear', min: 48, max: 100,
                    afterBuildTicks: axis => { axis.ticks = [50, 60, 70, 80, 90, 95, 100].map(v => ({ value: v })); },
                    ticks: {
                        callback: v => {
                            const yearMap = { 50: "'30", 60: "'32", 70: "'35", 80: "'37", 90: "'40", 95: "'45", 100: "'50" };
                            return [v + '%', yearMap[v] || ''];
                        },
                        font: { size: 9 }, color: 'rgba(255,255,255,0.5)', maxRotation: 0
                    },
                    grid: { color: 'rgba(255,255,255,0.06)' },
                    border: { display: true, color: 'rgba(255,255,255,0.15)' },
                    title: { display: true, text: 'Clean Energy Target', color: 'rgba(255,255,255,0.35)', font: { size: 9 } }
                },
                y: {
                    min: 0, max: yMaxHero,
                    ticks: { callback: v => '$' + v, font: { size: 9 }, color: 'rgba(255,255,255,0.5)', stepSize: 100 },
                    grid: { color: 'rgba(255,255,255,0.06)' },
                    border: { display: true, color: 'rgba(255,255,255,0.15)' },
                    title: { display: true, text: '$/metric ton CO₂', color: 'rgba(255,255,255,0.35)', font: { size: 9 } }
                }
            },
            plugins: {
                legend: { display: false },
                tooltip: { enabled: false },
                datalabels: { display: false },
                annotation: { annotations: {} }
            }
        }
    });
}

// ============================================================================
// BUILD REGIONAL ENVELOPE CHART (per-region, dark background)
// ============================================================================
function buildRegionalChart(iso) {
    const canvasId = 'envScrolly_' + iso;
    const ctx = document.getElementById(canvasId)?.getContext('2d');
    if (!ctx) return;

    const stepFan = typeof MAC_STEPWISE_FAN !== 'undefined' ? MAC_STEPWISE_FAN : null;
    const stepEnv = typeof MAC_ENVELOPE_DATA !== 'undefined' ? MAC_ENVELOPE_DATA : null;
    const avgFan = typeof MAC_FAN_DATA !== 'undefined' ? MAC_FAN_DATA : null;

    const fan = stepFan?.[iso];
    const env = stepEnv?.[iso]?.stepwise_envelope;
    const fb = avgFan?.[iso];
    if (!fan && !env) return;

    const c = REGION_COLORS[iso];
    const yMax = 1200;

    const p90 = (fan?.p90 || []).map((v, i) => {
        const val = v ?? fb?.p90?.[i] ?? null;
        return { x: THRESHOLDS[i], y: val != null ? Math.min(val, yMax) : null };
    }).filter(d => d.y != null);
    const p10 = (fan?.p10 || []).map((v, i) => {
        const val = v ?? fb?.p10?.[i] ?? null;
        return { x: THRESHOLDS[i], y: val };
    }).filter(d => d.y != null);
    const midSrc = env || fan?.p50 || [];
    const p50 = midSrc.map((v, i) => {
        const val = v ?? fb?.p50?.[i] ?? null;
        return { x: THRESHOLDS[i], y: val != null ? Math.min(val, yMax) : null };
    }).filter(d => d.y != null);

    const datasets = [
        { label: 'P90', data: p90, borderColor: 'transparent', backgroundColor: c + '25',
          borderWidth: 0, pointRadius: 0, fill: '+1', tension: 0.3, order: 3 },
        { label: 'P10', data: p10, borderColor: c + '55', backgroundColor: 'transparent',
          borderWidth: 1, borderDash: [3, 3], pointRadius: 0, fill: false, tension: 0.3, order: 3 },
        { label: 'Envelope', data: p50, borderColor: c, backgroundColor: c + '18',
          borderWidth: 3, pointRadius: 3, pointBackgroundColor: c, pointBorderColor: '#000',
          pointBorderWidth: 1, pointHoverRadius: 6, fill: false, tension: 0.3, order: 1 },
        ...dacDatasets()
    ];

    // Compute dynamic Y max from data
    let dataYMax = 0;
    p90.forEach(d => { if (d.y != null && d.y < 2000) dataYMax = Math.max(dataYMax, d.y); });
    dataYMax = Math.min(Math.ceil(dataYMax / 100) * 100 + 100, 1200);

    regionCharts[iso] = new Chart(ctx, {
        type: 'line',
        data: { datasets },
        options: {
            responsive: true, maintainAspectRatio: false,
            animation: {
                duration: 1400,
                easing: 'easeOutQuart',
                delay: ctx => ctx.type === 'data' ? ctx.dataIndex * 40 + ctx.datasetIndex * 150 : 0
            },
            scales: {
                x: {
                    type: 'linear', min: 48, max: 100,
                    afterBuildTicks: axis => { axis.ticks = [50, 60, 70, 80, 90, 95, 100].map(v => ({ value: v })); },
                    ticks: {
                        callback: v => {
                            const yearMap = { 50: "'30", 60: "'32", 70: "'35", 80: "'37", 90: "'40", 95: "'45", 100: "'50" };
                            return [v + '%', yearMap[v] || ''];
                        },
                        font: { size: 9 }, color: 'rgba(255,255,255,0.55)', maxRotation: 0
                    },
                    grid: { color: 'rgba(255,255,255,0.08)' },
                    border: { display: true, color: 'rgba(255,255,255,0.2)' },
                    title: { display: true, text: 'Clean Energy Target', color: 'rgba(255,255,255,0.4)', font: { size: 9 } }
                },
                y: {
                    min: 0, max: dataYMax,
                    ticks: { callback: v => '$' + v, font: { size: 9 }, color: 'rgba(255,255,255,0.55)', stepSize: 100 },
                    grid: { color: 'rgba(255,255,255,0.08)' },
                    border: { display: true, color: 'rgba(255,255,255,0.2)' },
                    title: { display: true, text: '$/metric ton CO₂', color: 'rgba(255,255,255,0.4)', font: { size: 9 } }
                }
            },
            plugins: {
                legend: { display: false },
                tooltip: {
                    enabled: true,
                    backgroundColor: 'rgba(0,0,0,0.85)',
                    titleFont: { size: 11, weight: 600 },
                    bodyFont: { size: 10 },
                    cornerRadius: 8,
                    padding: 10,
                    callbacks: {
                        title: items => items[0] ? items[0].raw.x + '% Clean' : '',
                        label: item => {
                            if (item.dataset.label === 'P90' || item.dataset.label === 'P10') return null;
                            return item.dataset.label + ': $' + Math.round(item.raw.y) + '/metric ton CO₂';
                        }
                    },
                    filter: item => item.dataset.label !== 'P90' && item.dataset.label !== 'P10'
                },
                datalabels: { display: false },
                annotation: { annotations: {} }
            }
        }
    });
}

// ============================================================================
// UPDATE HERO CHART HIGHLIGHTING (overview/drivers/conclusion)
// ============================================================================
function updateHeroChart(step) {
    if (!heroChart) return;
    const regions = ['ERCOT', 'PJM', 'CAISO', 'NYISO', 'NEISO'];
    const titleEl = document.getElementById('heroChartTitle');

    const highlights = {
        overview:   { show: regions, title: 'Marginal Abatement Cost vs. Projected DAC — All Regions' },
        drivers:    { show: regions, title: 'What Drives the Marginal Cost P10–P90 Spread?' },
        conclusion: { show: regions, title: 'Grid Wins the Marginal Dollar to ~90% Everywhere' }
    };

    const cfg = highlights[step] || highlights.overview;
    if (titleEl) titleEl.textContent = cfg.title;

    const showSet = new Set(cfg.show);
    const emphasizeBands = (step === 'drivers');

    heroChart.data.datasets.forEach(ds => {
        if (ds._type === 'dac') {
            ds.borderWidth = (step === 'drivers') ? 1 : (ds.label === 'DAC Central' ? 2 : 1.5);
            return;
        }
        const visible = showSet.has(ds._region);
        const baseC = { ERCOT: '#22C55E', PJM: '#4a90d9', CAISO: '#F59E0B', NYISO: '#E91E63', NEISO: '#9C27B0' }[ds._region] || '#888';
        if (ds._type === 'band') {
            if (visible) {
                ds.backgroundColor = ds.label.includes('P90') ? baseC + (emphasizeBands ? '30' : '15') : 'transparent';
                ds.borderWidth = ds.label.includes('P10') ? (emphasizeBands ? 1.5 : 0.5) : 0;
                if (ds.label.includes('P10')) ds.borderColor = baseC + (emphasizeBands ? '80' : '30');
            } else {
                ds.backgroundColor = 'transparent';
                ds.borderWidth = 0;
                ds.borderColor = 'transparent';
            }
        } else if (ds._type === 'line') {
            ds.borderWidth = visible ? 2.5 : 0.5;
            ds.borderColor = visible ? baseC : baseC + '18';
        }
    });

    // Annotation overlays
    const annotations = {};
    if (step === 'drivers') {
        annotations.note = {
            type: 'label', xValue: 75, yValue: yMaxHero * 0.85,
            content: ['Firm gen cost is the', 'dominant driver in 4/5 ISOs'],
            font: { size: 11, weight: 600 }, color: 'rgba(255,255,255,0.6)',
            backgroundColor: 'rgba(0,0,0,0.4)', padding: 8, borderRadius: 6
        };
    }
    heroChart.options.plugins.annotation.annotations = annotations;
    heroChart.update('default');
}

// ============================================================================
// SCROLL OBSERVER & INITIALIZATION
// ============================================================================
function initScrollytell() {
    const steps = document.querySelectorAll('.hero-scrolly-step');

    // Fade-in observer
    const fadeObs = new IntersectionObserver(entries => {
        entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); });
    }, { threshold: 0.15, rootMargin: '0px 0px -50px 0px' });

    // Step activation observer
    let activeHeroStep = null;
    const stepObs = new IntersectionObserver(entries => {
        let best = null;
        entries.forEach(e => {
            if (e.isIntersecting && (!best || e.intersectionRatio > best.intersectionRatio)) best = e;
        });
        if (best) {
            const stepName = best.target.getAttribute('data-hero-step');
            if (stepName !== activeHeroStep) {
                activeHeroStep = stepName;
                steps.forEach(s => s.classList.remove('active'));
                best.target.classList.add('active');

                // Switch chart panel
                const panelName = STEP_TO_PANEL[stepName] || 'overview';
                switchPanel(panelName);

                // Update hero chart highlighting when on overview panel
                if (panelName === 'overview') {
                    updateHeroChart(stepName);
                }
            }
        }
    }, { threshold: [0.1, 0.3, 0.5, 0.7, 0.9], rootMargin: '-20% 0px -30% 0px' });

    steps.forEach(s => { fadeObs.observe(s); stepObs.observe(s); });

    // First-paint trigger
    const initObs = new IntersectionObserver(entries => {
        if (entries[0].isIntersecting) {
            updateHeroChart('overview');
            initObs.disconnect();
        }
    }, { threshold: 0.05 });
    initObs.observe(document.querySelector('.hero-scrolly'));
}

// ============================================================================
// INIT
// ============================================================================
document.addEventListener('DOMContentLoaded', () => {
    // Build hero chart (overview panel is visible at init)
    buildHeroChart();
    // Regional charts built lazily in switchPanel() when first shown

    // Start scrollytell observers
    initScrollytell();
});
</script>
</body>
</html>
