// ============================================================================
// MAC STATISTICS — Option B: Statistical Post-Processing + Path-Constrained MAC
// ============================================================================
// Auto-generated by compute_mac_stats.py — do not edit manually
// Generated: 2026-02-20 22:00
// Source: 16,200 optimizer scenarios (10 thresholds × 324 cost combos × 5 ISOs)
//
// Methodology:
//   - Fan chart: P10/P25/P50/P75/P90 of average MAC across 324 cost scenarios
//   - Envelope: Running max of Medium MAC (monotonic by construction)
//   - Path-constrained: Enforces non-decreasing resource deployment
//   - ANOVA: Eta-squared decomposition of MAC variance by toggle group
// ============================================================================

// --- MAC Fan Chart (P10/P25/P50/P75/P90 average MAC across 324 scenarios) ---
const MAC_FAN_DATA = {
    "CAISO": {
        "p10": [
            84.1,
            98.0,
            84.2,
            80.5,
            76.9,
            77.7,
            77.8,
            78.9,
            80.2,
            81.6,
            84.9,
            87.7,
            null
        ],
        "p25": [
            91.5,
            106.6,
            94.7,
            92.7,
            90.3,
            91.1,
            88.9,
            89.7,
            91.8,
            95.1,
            99.2,
            102.6,
            null
        ],
        "p50": [
            100.8,
            117.5,
            106.8,
            105.1,
            103.9,
            106.3,
            105.7,
            107.1,
            108.3,
            111.5,
            116.6,
            122.7,
            null
        ],
        "p75": [
            114.8,
            133.7,
            124.9,
            122.0,
            122.6,
            124.3,
            123.2,
            121.6,
            124.9,
            129.3,
            134.0,
            143.5,
            null
        ],
        "p90": [
            124.9,
            145.6,
            138.5,
            136.6,
            139.7,
            143.4,
            142.9,
            144.7,
            147.7,
            150.6,
            152.1,
            161.4,
            null
        ]
    },
    "ERCOT": {
        "p10": [
            40.6,
            27.8,
            28.2,
            28.1,
            27.9,
            29.4,
            30.6,
            30.1,
            31.7,
            34.3,
            37.9,
            41.9,
            96.3
        ],
        "p25": [
            41.9,
            30.0,
            32.2,
            32.8,
            33.0,
            35.2,
            37.5,
            39.3,
            41.0,
            44.4,
            48.4,
            52.0,
            119.1
        ],
        "p50": [
            43.8,
            33.5,
            38.0,
            40.0,
            40.7,
            42.9,
            45.3,
            46.9,
            49.2,
            53.4,
            58.1,
            62.2,
            136.2
        ],
        "p75": [
            45.7,
            36.3,
            42.9,
            45.7,
            47.7,
            51.1,
            54.4,
            57.4,
            60.0,
            65.1,
            71.0,
            76.2,
            162.0
        ],
        "p90": [
            47.5,
            39.4,
            48.6,
            52.7,
            55.6,
            59.5,
            63.6,
            65.7,
            68.9,
            73.3,
            80.5,
            85.6,
            183.7
        ]
    },
    "PJM": {
        "p10": [
            58.4,
            47.5,
            47.1,
            45.9,
            45.0,
            45.9,
            46.5,
            46.4,
            48.6,
            49.2,
            52.5,
            58.2,
            100.3
        ],
        "p25": [
            61.4,
            52.0,
            52.0,
            52.9,
            52.8,
            52.7,
            53.7,
            54.4,
            56.4,
            57.0,
            59.8,
            66.6,
            113.1
        ],
        "p50": [
            65.3,
            57.9,
            61.0,
            61.0,
            61.4,
            62.6,
            64.0,
            64.9,
            67.9,
            68.4,
            73.0,
            79.0,
            134.1
        ],
        "p75": [
            69.4,
            64.1,
            70.0,
            71.6,
            74.2,
            75.3,
            78.4,
            81.0,
            83.1,
            83.5,
            89.9,
            97.8,
            172.8
        ],
        "p90": [
            74.4,
            71.6,
            81.3,
            84.6,
            88.7,
            88.6,
            93.7,
            96.6,
            99.3,
            101.1,
            106.1,
            113.5,
            188.7
        ]
    },
    "NYISO": {
        "p10": [
            201.7,
            151.6,
            122.6,
            113.1,
            100.4,
            92.3,
            89.4,
            88.9,
            87.7,
            87.5,
            92.6,
            103.0,
            154.5
        ],
        "p25": [
            213.2,
            161.7,
            132.4,
            122.3,
            109.8,
            100.9,
            100.9,
            98.6,
            98.0,
            98.8,
            103.6,
            111.6,
            166.7
        ],
        "p50": [
            227.5,
            176.0,
            146.7,
            138.8,
            125.5,
            123.6,
            121.7,
            123.2,
            123.4,
            127.0,
            133.8,
            143.7,
            220.0
        ],
        "p75": [
            259.0,
            211.7,
            178.5,
            168.9,
            162.7,
            158.0,
            152.8,
            154.1,
            152.6,
            155.9,
            162.1,
            169.6,
            253.3
        ],
        "p90": [
            286.8,
            236.4,
            199.1,
            193.6,
            186.7,
            186.0,
            172.8,
            172.3,
            170.1,
            174.4,
            182.4,
            190.2,
            295.2
        ]
    },
    "NEISO": {
        "p10": [
            57.4,
            60.2,
            34.8,
            37.8,
            41.5,
            46.6,
            50.7,
            53.0,
            55.6,
            62.9,
            71.3,
            84.3,
            163.0
        ],
        "p25": [
            72.6,
            76.1,
            50.8,
            52.9,
            55.8,
            60.7,
            61.9,
            65.8,
            68.9,
            76.4,
            84.7,
            95.3,
            179.8
        ],
        "p50": [
            97.3,
            102.0,
            72.5,
            71.8,
            72.6,
            82.8,
            84.8,
            89.5,
            98.9,
            107.8,
            119.2,
            130.0,
            247.4
        ],
        "p75": [
            134.3,
            140.7,
            108.1,
            107.0,
            108.2,
            114.0,
            117.5,
            119.6,
            124.7,
            135.5,
            147.4,
            161.4,
            400.7
        ],
        "p90": [
            188.3,
            197.3,
            157.0,
            153.7,
            158.6,
            178.9,
            184.6,
            195.0,
            201.7,
            212.8,
            232.0,
            241.0,
            419.9
        ]
    }
};

// --- Stepwise Marginal MAC Fan (P10/P50/P90 of step MAC between thresholds) ---
const MAC_STEPWISE_FAN = {
    "CAISO": {
        "p10": [
            null,
            null,
            11.1,
            12.4,
            17.4,
            40.1,
            31.4,
            23.4,
            81.0,
            67.8,
            95.4,
            185.1,
            null
        ],
        "p50": [
            null,
            null,
            60.8,
            83.6,
            166.9,
            228.5,
            338.6,
            105.7,
            133.8,
            240.5,
            195.9,
            317.9,
            null
        ],
        "p90": [
            null,
            null,
            446.9,
            224.0,
            684.8,
            897.0,
            677.2,
            952.9,
            1081.8,
            1683.8,
            467.7,
            883.9,
            null
        ]
    },
    "ERCOT": {
        "p10": [
            null,
            0.4,
            null,
            null,
            43.8,
            16.4,
            103.0,
            69.9,
            78.1,
            86.1,
            49.2,
            71.3,
            622.5
        ],
        "p50": [
            null,
            2.4,
            null,
            null,
            217.9,
            36.0,
            226.3,
            410.1,
            272.7,
            213.9,
            834.6,
            434.5,
            1075.7
        ],
        "p90": [
            null,
            8.9,
            null,
            null,
            429.0,
            36.0,
            424.3,
            615.3,
            754.2,
            598.1,
            1835.1,
            1217.1,
            2278.7
        ]
    },
    "PJM": {
        "p10": [
            null,
            3.4,
            null,
            135.5,
            2.1,
            15.0,
            8.1,
            35.0,
            97.4,
            45.6,
            203.2,
            174.5,
            760.9
        ],
        "p50": [
            null,
            20.2,
            null,
            767.8,
            89.5,
            149.2,
            45.3,
            156.0,
            402.1,
            117.7,
            1059.8,
            753.6,
            2189.1
        ],
        "p90": [
            null,
            66.3,
            null,
            1309.2,
            168.5,
            2882.5,
            1281.4,
            443.1,
            924.8,
            379.2,
            2913.3,
            1287.8,
            3872.6
        ]
    },
    "NYISO": {
        "p10": [
            null,
            2.6,
            3.5,
            2.8,
            6.9,
            47.1,
            21.5,
            5.9,
            36.0,
            53.3,
            323.7,
            233.7,
            1103.8
        ],
        "p50": [
            null,
            2.6,
            24.4,
            26.4,
            40.1,
            171.7,
            70.5,
            43.9,
            154.9,
            162.6,
            380.3,
            931.7,
            4573.5
        ],
        "p90": [
            null,
            2.6,
            57.3,
            112.9,
            81.6,
            276.0,
            168.0,
            229.8,
            290.4,
            969.4,
            552.7,
            1336.8,
            5859.3
        ]
    },
    "NEISO": {
        "p10": [
            null,
            null,
            28.5,
            36.6,
            46.9,
            53.1,
            66.6,
            122.7,
            89.4,
            234.1,
            283.4,
            457.7,
            2097.8
        ],
        "p50": [
            null,
            null,
            201.5,
            93.5,
            102.3,
            189.7,
            202.4,
            337.5,
            241.2,
            426.1,
            598.2,
            867.2,
            4796.7
        ],
        "p90": [
            null,
            null,
            480.3,
            237.0,
            320.1,
            409.2,
            593.2,
            744.2,
            595.6,
            1190.8,
            1188.6,
            2969.6,
            6769.0
        ]
    }
};

// --- Monotonic Envelope MAC (running max of Medium, smooths rebalancing) ---
const MAC_ENVELOPE_DATA = {
    "CAISO": {
        "raw": [
            115.4,
            134.5,
            125.7,
            124.7,
            128.3,
            133.6,
            136.2,
            141.9,
            145.6,
            128.6,
            126.3,
            131.4,
            null
        ],
        "envelope": [
            115.4,
            134.5,
            134.5,
            134.5,
            134.5,
            134.5,
            136.2,
            141.9,
            145.6,
            145.6,
            145.6,
            145.6,
            null
        ],
        "stepwise_envelope": [
            null,
            0,
            0,
            87.6,
            527.7,
            853.0,
            853.0,
            853.0,
            853.0,
            853.0,
            853.0,
            853.0,
            null
        ]
    },
    "ERCOT": {
        "raw": [
            44.6,
            34.5,
            40.0,
            42.4,
            44.0,
            46.8,
            50.1,
            52.0,
            55.8,
            61.0,
            65.9,
            73.8,
            136.6
        ],
        "envelope": [
            44.6,
            44.6,
            44.6,
            44.6,
            44.6,
            46.8,
            50.1,
            52.0,
            55.8,
            61.0,
            65.9,
            73.8,
            136.6
        ],
        "stepwise_envelope": [
            null,
            0,
            0,
            0,
            220.1,
            220.1,
            236.8,
            236.8,
            451.0,
            451.0,
            1409.5,
            2571.0,
            2571.0
        ]
    },
    "PJM": {
        "raw": [
            68.9,
            63.3,
            72.1,
            71.5,
            70.5,
            69.8,
            68.7,
            69.0,
            71.3,
            73.9,
            76.5,
            83.7,
            134.8
        ],
        "envelope": [
            68.9,
            68.9,
            72.1,
            72.1,
            72.1,
            72.1,
            72.1,
            72.1,
            72.1,
            73.9,
            76.5,
            83.7,
            134.8
        ],
        "stepwise_envelope": [
            null,
            0.8,
            0.8,
            0.8,
            0.8,
            0.8,
            0.8,
            160.6,
            368.6,
            462.4,
            522.2,
            522.2,
            2041.9
        ]
    },
    "NYISO": {
        "raw": [
            267.5,
            215.0,
            175.3,
            163.0,
            154.5,
            140.7,
            140.7,
            138.5,
            138.1,
            139.8,
            146.8,
            153.3,
            227.2
        ],
        "envelope": [
            267.5,
            267.5,
            267.5,
            267.5,
            267.5,
            267.5,
            267.5,
            267.5,
            267.5,
            267.5,
            267.5,
            267.5,
            267.5
        ],
        "stepwise_envelope": [
            null,
            0,
            0,
            0,
            0,
            2.9,
            2.9,
            55.0,
            94.0,
            234.6,
            498.4,
            979.3,
            5071.7
        ]
    },
    "NEISO": {
        "raw": [
            143.7,
            150.5,
            89.0,
            93.7,
            99.3,
            102.3,
            106.7,
            108.9,
            113.3,
            125.4,
            131.7,
            142.4,
            252.0
        ],
        "envelope": [
            143.7,
            150.5,
            150.5,
            150.5,
            150.5,
            150.5,
            150.5,
            150.5,
            150.5,
            150.5,
            150.5,
            150.5,
            252.0
        ],
        "stepwise_envelope": [
            null,
            0,
            0,
            246.1,
            327.0,
            327.0,
            721.7,
            721.7,
            721.7,
            933.1,
            933.1,
            9499.9,
            9499.9
        ]
    }
};

// --- Path-Constrained Reference MAC (monotonic resource deployment) ---
const MAC_PATH_CONSTRAINED = {
    "CAISO": {
        "mac": [
            115.4,
            134.5,
            137.8,
            134.2,
            133.0,
            133.6,
            136.2,
            141.9,
            145.6,
            128.6,
            126.3,
            131.4,
            null
        ],
        "costs": [
            32.94,
            32.94,
            32.94,
            32.94,
            32.94,
            33.33,
            34.53,
            35.86,
            37.33,
            40.31,
            43.49,
            47.39,
            null
        ]
    },
    "ERCOT": {
        "mac": [
            44.6,
            37.4,
            44.6,
            46.6,
            46.2,
            47.3,
            50.1,
            52.0,
            55.8,
            61.0,
            65.9,
            73.8,
            136.6
        ],
        "costs": [
            23.52,
            23.52,
            23.52,
            23.52,
            23.52,
            23.52,
            25.33,
            26.17,
            28.37,
            30.34,
            32.89,
            36.98,
            76.93
        ]
    },
    "PJM": {
        "mac": [
            68.9,
            63.3,
            72.1,
            72.0,
            71.4,
            70.7,
            70.4,
            70.1,
            71.3,
            73.9,
            76.5,
            83.7,
            134.8
        ],
        "costs": [
            35.94,
            35.98,
            38.18,
            38.18,
            38.18,
            38.18,
            38.18,
            38.18,
            39.13,
            40.8,
            42.53,
            46.25,
            76.49
        ]
    },
    "NYISO": {
        "mac": [
            267.5,
            225.9,
            186.0,
            175.7,
            168.5,
            153.2,
            153.2,
            149.2,
            147.9,
            145.3,
            146.8,
            153.3,
            227.2
        ],
        "costs": [
            57.71,
            57.71,
            57.71,
            57.71,
            57.71,
            57.71,
            57.71,
            57.71,
            57.71,
            57.71,
            59.49,
            62.62,
            94.19
        ]
    },
    "NEISO": {
        "mac": [
            143.7,
            150.5,
            130.4,
            126.5,
            123.5,
            110.9,
            110.1,
            108.9,
            113.3,
            125.4,
            131.7,
            142.4,
            252.0
        ],
        "costs": [
            36.85,
            36.85,
            36.85,
            36.85,
            36.85,
            36.85,
            36.85,
            38.74,
            41.02,
            46.08,
            50.26,
            54.4,
            99.67
        ]
    }
};

// --- ANOVA: Fraction of MAC variance explained by each toggle group ---
// Values are eta-squared (0-1): the proportion of total MAC variance
// attributable to each sensitivity toggle. Higher = more influential.
const MAC_ANOVA = {
    "CAISO": {
        "Renewable Gen": 0.166,
        "Nuclear": 0.077,
        "Battery Cost": 0.006,
        "LDES Cost": 0.0,
        "Fossil Fuel": 0.156,
        "Transmission": 0.028
    },
    "ERCOT": {
        "Renewable Gen": 0.391,
        "Nuclear": 0.016,
        "Battery Cost": 0.0,
        "LDES Cost": 0.001,
        "Fossil Fuel": 0.332,
        "Transmission": 0.065
    },
    "PJM": {
        "Renewable Gen": 0.132,
        "Nuclear": 0.161,
        "Battery Cost": 0.0,
        "LDES Cost": 0.0,
        "Fossil Fuel": 0.168,
        "Transmission": 0.059
    },
    "NYISO": {
        "Renewable Gen": 0.082,
        "Nuclear": 0.411,
        "Battery Cost": 0.0,
        "LDES Cost": 0.0,
        "Fossil Fuel": 0.053,
        "Transmission": 0.057
    },
    "NEISO": {
        "Renewable Gen": 0.144,
        "Nuclear": 0.495,
        "Battery Cost": 0.0,
        "LDES Cost": 0.0,
        "Fossil Fuel": 0.033,
        "Transmission": 0.047
    }
};

// --- Crossover Analysis: threshold where MAC exceeds benchmarks ---
const MAC_CROSSOVERS = {
    "CAISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 50,
            "median": 50
        },
        "eu_ets_88": {
            "envelope": 50,
            "median": 50
        }
    },
    "ERCOT": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 50,
            "median": 50
        },
        "eu_ets_88": {
            "envelope": 100,
            "median": 100
        }
    },
    "PJM": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 50,
            "median": 50
        },
        "eu_ets_88": {
            "envelope": 100,
            "median": 100
        }
    },
    "NYISO": {
        "scc_epa_190": {
            "envelope": 50,
            "median": 50
        },
        "scc_rennert_185": {
            "envelope": 50,
            "median": 50
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 50,
            "median": 50
        },
        "eu_ets_88": {
            "envelope": 50,
            "median": 50
        }
    },
    "NEISO": {
        "scc_epa_190": {
            "envelope": 100,
            "median": 100
        },
        "scc_rennert_185": {
            "envelope": 100,
            "median": 100
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 50,
            "median": 50
        },
        "eu_ets_88": {
            "envelope": 50,
            "median": 50
        }
    }
};

