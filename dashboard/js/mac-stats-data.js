// ============================================================================
// MAC STATISTICS — Option B: Statistical Post-Processing + Path-Constrained MAC
// ============================================================================
// Auto-generated by compute_mac_stats.py — do not edit manually
// Generated: 2026-02-16 02:10
// Source: 16,200 optimizer scenarios (10 thresholds × 324 cost combos × 5 ISOs)
//
// Methodology:
//   - Fan chart: P10/P25/P50/P75/P90 of average MAC across 324 cost scenarios
//   - Envelope: Running max of Medium MAC (monotonic by construction)
//   - Path-constrained: Enforces non-decreasing resource deployment
//   - ANOVA: Eta-squared decomposition of MAC variance by toggle group
// ============================================================================

// --- MAC Fan Chart (P10/P25/P50/P75/P90 average MAC across 324 scenarios) ---
const MAC_FAN_DATA = {
    "CAISO": {
        "p10": [
            46.3,
            47.5,
            49.7,
            52.4,
            53.4,
            56.2,
            58.7,
            65.2,
            66.0,
            null
        ],
        "p25": [
            59.2,
            63.3,
            65.6,
            67.7,
            66.0,
            69.3,
            73.5,
            77.2,
            79.3,
            null
        ],
        "p50": [
            70.4,
            75.0,
            78.7,
            87.7,
            80.5,
            84.5,
            90.9,
            99.5,
            105.2,
            null
        ],
        "p75": [
            93.5,
            101.3,
            103.5,
            111.7,
            107.1,
            107.1,
            113.5,
            120.7,
            125.7,
            null
        ],
        "p90": [
            110.2,
            119.6,
            121.8,
            127.2,
            126.0,
            132.1,
            139.1,
            146.7,
            153.0,
            null
        ]
    },
    "ERCOT": {
        "p10": [
            4.8,
            6.2,
            10.2,
            13.2,
            14.5,
            17.0,
            19.7,
            22.6,
            25.4,
            null
        ],
        "p25": [
            12.2,
            13.8,
            18.0,
            20.4,
            22.4,
            25.3,
            28.7,
            31.6,
            34.8,
            null
        ],
        "p50": [
            20.2,
            22.0,
            26.9,
            29.9,
            31.4,
            35.1,
            39.1,
            42.5,
            46.3,
            null
        ],
        "p75": [
            30.4,
            32.7,
            36.7,
            40.2,
            42.1,
            45.4,
            49.4,
            53.8,
            57.8,
            null
        ],
        "p90": [
            39.0,
            41.3,
            46.1,
            49.0,
            51.6,
            54.5,
            59.0,
            63.4,
            68.5,
            null
        ]
    },
    "PJM": {
        "p10": [
            12.0,
            12.6,
            14.3,
            16.1,
            17.0,
            17.5,
            19.8,
            24.0,
            26.6,
            null
        ],
        "p25": [
            24.0,
            25.8,
            27.1,
            29.3,
            30.9,
            31.6,
            34.1,
            39.1,
            40.7,
            null
        ],
        "p50": [
            33.6,
            35.7,
            37.0,
            38.6,
            41.0,
            42.9,
            44.8,
            50.3,
            54.1,
            null
        ],
        "p75": [
            52.3,
            53.6,
            56.2,
            59.5,
            60.7,
            62.0,
            64.7,
            70.6,
            74.0,
            null
        ],
        "p90": [
            64.9,
            67.6,
            72.3,
            74.2,
            74.8,
            78.5,
            79.1,
            86.8,
            92.2,
            null
        ]
    },
    "NYISO": {
        "p10": [
            49.7,
            49.1,
            50.4,
            50.6,
            51.2,
            54.8,
            57.1,
            70.2,
            74.9,
            null
        ],
        "p25": [
            58.1,
            59.5,
            59.9,
            60.0,
            60.7,
            64.7,
            67.0,
            80.6,
            86.3,
            null
        ],
        "p50": [
            79.2,
            82.5,
            86.2,
            86.5,
            88.8,
            95.1,
            96.6,
            108.9,
            111.0,
            null
        ],
        "p75": [
            104.5,
            105.6,
            105.3,
            105.5,
            106.7,
            112.9,
            115.9,
            130.2,
            132.9,
            null
        ],
        "p90": [
            139.1,
            145.6,
            148.4,
            149.5,
            153.3,
            159.9,
            165.5,
            174.7,
            181.6,
            null
        ]
    },
    "NEISO": {
        "p10": [
            52.4,
            58.1,
            60.9,
            61.4,
            63.0,
            66.9,
            71.8,
            76.5,
            83.7,
            null
        ],
        "p25": [
            68.5,
            72.3,
            74.9,
            77.1,
            74.5,
            80.6,
            84.2,
            88.3,
            96.0,
            null
        ],
        "p50": [
            89.0,
            92.2,
            93.9,
            97.6,
            91.5,
            97.1,
            102.1,
            108.4,
            116.8,
            null
        ],
        "p75": [
            117.1,
            122.7,
            122.2,
            124.7,
            125.2,
            129.2,
            135.5,
            141.4,
            148.2,
            null
        ],
        "p90": [
            145.3,
            144.8,
            147.4,
            147.1,
            149.5,
            153.4,
            164.6,
            174.6,
            183.1,
            null
        ]
    }
};

// --- Stepwise Marginal MAC Fan (P10/P50/P90 of step MAC between thresholds) ---
const MAC_STEPWISE_FAN = {
    "CAISO": {
        "p10": [
            null,
            97.4,
            68.4,
            19.7,
            67.3,
            81.8,
            147.7,
            121.9,
            230.7,
            null
        ],
        "p50": [
            null,
            214.2,
            115.5,
            474.6,
            137.6,
            289.9,
            304.8,
            346.7,
            339.5,
            null
        ],
        "p90": [
            null,
            2126.5,
            197.0,
            5731.4,
            239.0,
            573.3,
            498.9,
            1092.5,
            462.7,
            null
        ]
    },
    "ERCOT": {
        "p10": [
            null,
            42.9,
            70.2,
            73.4,
            65.8,
            96.0,
            114.3,
            130.0,
            192.1,
            null
        ],
        "p50": [
            null,
            78.4,
            111.6,
            118.2,
            110.1,
            154.1,
            191.6,
            207.6,
            266.1,
            null
        ],
        "p90": [
            null,
            134.2,
            180.9,
            218.1,
            215.9,
            203.1,
            262.9,
            287.0,
            368.5,
            null
        ]
    },
    "PJM": {
        "p10": [
            null,
            16.6,
            25.7,
            35.3,
            45.1,
            79.0,
            211.7,
            145.6,
            140.7,
            null
        ],
        "p50": [
            null,
            61.8,
            63.1,
            81.5,
            104.8,
            149.8,
            338.6,
            214.5,
            513.5,
            null
        ],
        "p90": [
            null,
            177.2,
            188.3,
            185.9,
            209.9,
            499.5,
            469.4,
            318.2,
            3447.7,
            null
        ]
    },
    "NYISO": {
        "p10": [
            null,
            22.4,
            37.9,
            56.5,
            98.4,
            188.9,
            85.6,
            275.9,
            43.1,
            null
        ],
        "p50": [
            null,
            117.1,
            74.3,
            97.8,
            155.3,
            259.5,
            310.4,
            449.3,
            398.5,
            null
        ],
        "p90": [
            null,
            239.1,
            316.2,
            200.9,
            983.2,
            719.2,
            362.4,
            798.6,
            602.1,
            null
        ]
    },
    "NEISO": {
        "p10": [
            null,
            36.0,
            82.5,
            24.8,
            18.8,
            262.3,
            85.0,
            170.2,
            238.7,
            null
        ],
        "p50": [
            null,
            140.8,
            166.3,
            108.2,
            169.9,
            328.7,
            536.1,
            490.7,
            676.9,
            null
        ],
        "p90": [
            null,
            285.5,
            290.6,
            408.4,
            365.5,
            552.8,
            945.6,
            832.1,
            6130.8,
            null
        ]
    }
};

// --- Monotonic Envelope MAC (running max of Medium, smooths rebalancing) ---
const MAC_ENVELOPE_DATA = {
    "CAISO": {
        "raw": [
            92.8,
            95.5,
            103.6,
            103.9,
            106.8,
            106.4,
            109.0,
            115.7,
            117.9,
            null
        ],
        "envelope": [
            92.8,
            95.5,
            103.6,
            103.9,
            106.8,
            106.8,
            109.0,
            115.7,
            117.9,
            null
        ],
        "stepwise_envelope": [
            null,
            244.9,
            244.9,
            244.9,
            244.9,
            244.9,
            244.9,
            2775.7,
            2775.7,
            null
        ]
    },
    "ERCOT": {
        "raw": [
            23.5,
            25.7,
            30.8,
            35.3,
            36.5,
            39.6,
            42.9,
            46.1,
            50.3,
            null
        ],
        "envelope": [
            23.5,
            25.7,
            30.8,
            35.3,
            36.5,
            39.6,
            42.9,
            46.1,
            50.3,
            null
        ],
        "stepwise_envelope": [
            null,
            117.6,
            117.6,
            202.0,
            202.0,
            202.0,
            202.0,
            206.8,
            289.6,
            null
        ]
    },
    "PJM": {
        "raw": [
            49.1,
            49.2,
            48.8,
            50.5,
            51.7,
            52.7,
            55.9,
            62.6,
            62.6,
            null
        ],
        "envelope": [
            49.1,
            49.2,
            49.2,
            50.5,
            51.7,
            52.7,
            55.9,
            62.6,
            62.6,
            null
        ],
        "stepwise_envelope": [
            null,
            52.1,
            52.1,
            86.3,
            128.8,
            161.5,
            413.9,
            413.9,
            413.9,
            null
        ]
    },
    "NYISO": {
        "raw": [
            104.5,
            107.5,
            98.2,
            98.3,
            99.0,
            105.3,
            106.4,
            119.5,
            120.5,
            null
        ],
        "envelope": [
            104.5,
            107.5,
            107.5,
            107.5,
            107.5,
            107.5,
            107.5,
            119.5,
            120.5,
            null
        ],
        "stepwise_envelope": [
            null,
            195.9,
            195.9,
            195.9,
            195.9,
            195.9,
            195.9,
            195.9,
            195.9,
            null
        ]
    },
    "NEISO": {
        "raw": [
            114.7,
            112.6,
            121.8,
            122.7,
            125.2,
            128.8,
            136.9,
            146.1,
            145.9,
            null
        ],
        "envelope": [
            114.7,
            114.7,
            121.8,
            122.7,
            125.2,
            128.8,
            136.9,
            146.1,
            146.1,
            null
        ],
        "stepwise_envelope": [
            null,
            82.7,
            301.0,
            301.0,
            301.0,
            319.6,
            893.6,
            893.6,
            893.6,
            null
        ]
    }
};

// --- Path-Constrained Reference MAC (monotonic resource deployment) ---
const MAC_PATH_CONSTRAINED = {
    "CAISO": {
        "mac": [
            92.8,
            95.5,
            103.6,
            103.9,
            106.8,
            106.4,
            109.0,
            115.7,
            117.9,
            null
        ],
        "costs": [
            26.0,
            27.22,
            31.33,
            33.02,
            35.12,
            35.33,
            37.92,
            40.37,
            41.67,
            null
        ]
    },
    "ERCOT": {
        "mac": [
            23.5,
            25.7,
            30.8,
            35.3,
            36.5,
            39.6,
            42.9,
            46.1,
            50.3,
            null
        ],
        "costs": [
            9.9,
            11.13,
            14.12,
            16.63,
            17.43,
            19.62,
            21.8,
            23.91,
            26.52,
            null
        ]
    },
    "PJM": {
        "mac": [
            49.1,
            49.2,
            48.8,
            50.5,
            51.7,
            52.7,
            55.9,
            62.6,
            62.6,
            null
        ],
        "costs": [
            21.63,
            23.0,
            24.21,
            26.23,
            27.29,
            28.09,
            30.04,
            34.59,
            34.59,
            null
        ]
    },
    "NYISO": {
        "mac": [
            104.5,
            107.5,
            98.2,
            98.3,
            99.0,
            105.3,
            106.4,
            119.5,
            120.5,
            null
        ],
        "costs": [
            33.39,
            35.53,
            36.97,
            37.44,
            38.29,
            40.73,
            42.62,
            47.87,
            49.21,
            null
        ]
    },
    "NEISO": {
        "mac": [
            114.7,
            112.6,
            121.8,
            122.7,
            125.2,
            128.8,
            136.9,
            146.1,
            145.9,
            null
        ],
        "costs": [
            32.73,
            34.38,
            39.06,
            40.97,
            42.42,
            44.47,
            47.78,
            52.25,
            55.02,
            null
        ]
    }
};

// --- ANOVA: Fraction of MAC variance explained by each toggle group ---
// Values are eta-squared (0-1): the proportion of total MAC variance
// attributable to each sensitivity toggle. Higher = more influential.
const MAC_ANOVA = {
    "CAISO": {
        "Renewable Gen": 0.215,
        "Firm Gen": 0.478,
        "Storage": 0.012,
        "Fossil Fuel": 0.114,
        "Transmission": 0.028
    },
    "ERCOT": {
        "Renewable Gen": 0.482,
        "Firm Gen": 0.016,
        "Storage": 0.007,
        "Fossil Fuel": 0.389,
        "Transmission": 0.069
    },
    "PJM": {
        "Renewable Gen": 0.112,
        "Firm Gen": 0.438,
        "Storage": 0.002,
        "Fossil Fuel": 0.279,
        "Transmission": 0.04
    },
    "NYISO": {
        "Renewable Gen": 0.14,
        "Firm Gen": 0.584,
        "Storage": 0.002,
        "Fossil Fuel": 0.039,
        "Transmission": 0.059
    },
    "NEISO": {
        "Renewable Gen": 0.344,
        "Firm Gen": 0.277,
        "Storage": 0.005,
        "Fossil Fuel": 0.099,
        "Transmission": 0.09
    }
};

// --- Crossover Analysis: threshold where MAC exceeds benchmarks ---
const MAC_CROSSOVERS = {
    "CAISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 95
        }
    },
    "ERCOT": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": ">99",
            "median": ">99"
        }
    },
    "PJM": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": ">99",
            "median": ">99"
        }
    },
    "NYISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 90
        }
    },
    "NEISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 75
        }
    }
};

