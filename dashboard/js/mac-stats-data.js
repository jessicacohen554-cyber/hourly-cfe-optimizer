// ============================================================================
// MAC STATISTICS — Option B: Statistical Post-Processing + Path-Constrained MAC
// ============================================================================
// Auto-generated by compute_mac_stats.py — do not edit manually
// Generated: 2026-02-19 08:42
// Source: 16,200 optimizer scenarios (10 thresholds × 324 cost combos × 5 ISOs)
//
// Methodology:
//   - Fan chart: P10/P25/P50/P75/P90 of average MAC across 324 cost scenarios
//   - Envelope: Running max of Medium MAC (monotonic by construction)
//   - Path-constrained: Enforces non-decreasing resource deployment
//   - ANOVA: Eta-squared decomposition of MAC variance by toggle group
// ============================================================================

// --- MAC Fan Chart (P10/P25/P50/P75/P90 average MAC across 324 scenarios) ---
const MAC_FAN_DATA = {
    "CAISO": {
        "p10": [
            114.1,
            44.3,
            44.1,
            53.5,
            54.6,
            66.4,
            66.4,
            64.5,
            65.5,
            76.6,
            80.0,
            81.4,
            155.1
        ],
        "p25": [
            125.4,
            53.1,
            56.6,
            63.8,
            64.0,
            82.8,
            82.8,
            79.7,
            80.9,
            86.8,
            94.1,
            94.6,
            169.1
        ],
        "p50": [
            147.4,
            68.9,
            73.5,
            80.4,
            81.6,
            98.8,
            102.9,
            97.3,
            98.0,
            109.5,
            123.6,
            127.1,
            233.8
        ],
        "p75": [
            179.1,
            85.0,
            89.4,
            94.6,
            96.9,
            116.1,
            120.8,
            119.1,
            124.8,
            128.3,
            137.2,
            150.1,
            298.4
        ],
        "p90": [
            186.9,
            96.2,
            105.6,
            112.7,
            118.1,
            128.5,
            139.0,
            131.3,
            150.0,
            147.9,
            156.5,
            168.7,
            314.2
        ]
    },
    "ERCOT": {
        "p10": [
            -2.9,
            -2.1,
            0.0,
            0.9,
            11.8,
            9.7,
            13.3,
            14.6,
            20.4,
            26.9,
            30.2,
            32.7,
            80.2
        ],
        "p25": [
            4.7,
            8.9,
            8.1,
            8.8,
            21.9,
            17.9,
            21.3,
            22.9,
            27.5,
            37.2,
            38.6,
            40.7,
            101.6
        ],
        "p50": [
            8.8,
            16.5,
            16.5,
            17.1,
            31.2,
            26.3,
            30.5,
            33.1,
            39.4,
            46.8,
            50.2,
            53.3,
            134.4
        ],
        "p75": [
            13.8,
            26.0,
            26.2,
            26.7,
            41.1,
            37.1,
            40.2,
            43.8,
            49.6,
            59.3,
            60.5,
            64.0,
            158.9
        ],
        "p90": [
            18.5,
            33.9,
            36.1,
            36.3,
            50.6,
            46.5,
            48.9,
            53.7,
            61.4,
            69.9,
            74.1,
            76.3,
            188.6
        ]
    },
    "PJM": {
        "p10": [
            18.8,
            14.4,
            16.1,
            21.2,
            20.8,
            22.3,
            24.0,
            23.8,
            27.7,
            29.5,
            32.7,
            39.4,
            79.7
        ],
        "p25": [
            32.0,
            23.5,
            22.8,
            31.6,
            33.3,
            35.2,
            36.4,
            37.0,
            41.3,
            43.2,
            47.0,
            54.5,
            102.2
        ],
        "p50": [
            46.9,
            35.1,
            36.9,
            43.3,
            44.0,
            46.1,
            48.8,
            47.5,
            53.8,
            57.0,
            61.7,
            69.2,
            129.8
        ],
        "p75": [
            64.5,
            48.9,
            49.1,
            55.5,
            57.4,
            59.2,
            63.1,
            61.8,
            70.8,
            73.7,
            79.8,
            88.3,
            154.1
        ],
        "p90": [
            85.8,
            61.5,
            65.7,
            68.3,
            71.0,
            73.4,
            77.8,
            76.5,
            86.1,
            90.2,
            98.4,
            104.0,
            187.9
        ]
    },
    "NYISO": {
        "p10": [
            48.0,
            44.5,
            48.7,
            51.3,
            54.2,
            57.2,
            62.2,
            65.1,
            67.2,
            73.1,
            79.5,
            91.0,
            152.5
        ],
        "p25": [
            68.1,
            65.4,
            67.1,
            69.3,
            68.2,
            70.4,
            72.1,
            73.8,
            75.2,
            82.5,
            89.0,
            100.8,
            166.8
        ],
        "p50": [
            96.3,
            85.0,
            85.0,
            85.0,
            85.9,
            90.1,
            93.2,
            93.9,
            99.4,
            107.2,
            116.5,
            126.8,
            219.4
        ],
        "p75": [
            129.7,
            108.4,
            112.1,
            113.7,
            115.4,
            116.9,
            117.1,
            118.6,
            119.7,
            128.1,
            137.8,
            148.5,
            279.8
        ],
        "p90": [
            156.0,
            133.9,
            129.8,
            133.4,
            135.4,
            148.4,
            147.7,
            150.0,
            155.6,
            164.8,
            175.0,
            183.8,
            295.9
        ]
    },
    "NEISO": {
        "p10": [
            190.2,
            81.2,
            34.7,
            41.5,
            44.2,
            53.6,
            55.1,
            58.0,
            60.3,
            67.5,
            72.9,
            84.3,
            161.3
        ],
        "p25": [
            229.4,
            105.9,
            50.1,
            56.2,
            59.4,
            68.6,
            70.0,
            72.4,
            75.0,
            80.8,
            88.5,
            99.6,
            179.2
        ],
        "p50": [
            309.2,
            145.6,
            70.7,
            74.1,
            76.8,
            95.3,
            95.0,
            103.0,
            106.8,
            116.9,
            129.8,
            138.3,
            242.5
        ],
        "p75": [
            417.0,
            189.6,
            96.9,
            104.7,
            108.1,
            149.1,
            122.4,
            128.1,
            141.5,
            144.8,
            184.6,
            215.5,
            390.8
        ],
        "p90": [
            452.8,
            218.9,
            122.7,
            136.6,
            134.6,
            174.4,
            186.0,
            186.3,
            193.5,
            209.0,
            234.9,
            241.8,
            413.9
        ]
    }
};

// --- Stepwise Marginal MAC Fan (P10/P50/P90 of step MAC between thresholds) ---
const MAC_STEPWISE_FAN = {
    "CAISO": {
        "p10": [
            null,
            null,
            31.3,
            76.7,
            38.6,
            39.7,
            66.4,
            85.2,
            72.0,
            84.8,
            93.6,
            42.9,
            421.3
        ],
        "p50": [
            null,
            null,
            132.9,
            181.0,
            93.0,
            396.0,
            182.7,
            157.4,
            514.8,
            154.5,
            272.1,
            313.5,
            1867.3
        ],
        "p90": [
            null,
            null,
            290.2,
            446.0,
            218.2,
            845.0,
            754.4,
            288.9,
            655.6,
            683.0,
            814.2,
            1193.8,
            6456.5
        ]
    },
    "ERCOT": {
        "p10": [
            null,
            9.1,
            4.1,
            20.2,
            66.8,
            26.0,
            58.0,
            40.3,
            150.8,
            43.5,
            36.4,
            20.3,
            639.0
        ],
        "p50": [
            null,
            78.9,
            20.3,
            30.3,
            154.9,
            49.1,
            162.1,
            116.1,
            354.2,
            150.7,
            113.3,
            71.0,
            1116.8
        ],
        "p90": [
            null,
            140.2,
            51.4,
            42.5,
            387.3,
            119.0,
            316.3,
            194.6,
            543.9,
            472.1,
            338.3,
            138.3,
            1808.3
        ]
    },
    "PJM": {
        "p10": [
            null,
            0.0,
            19.4,
            34.2,
            32.0,
            33.7,
            10.8,
            77.8,
            92.3,
            57.4,
            216.8,
            95.7,
            1525.0
        ],
        "p50": [
            null,
            3.0,
            51.5,
            107.0,
            70.0,
            73.7,
            98.2,
            118.3,
            165.0,
            223.1,
            290.3,
            525.1,
            2240.4
        ],
        "p90": [
            null,
            3.0,
            91.9,
            244.0,
            139.5,
            120.5,
            376.0,
            179.6,
            385.6,
            501.7,
            1351.0,
            1570.3,
            3022.4
        ]
    },
    "NYISO": {
        "p10": [
            null,
            9.9,
            40.0,
            50.7,
            67.6,
            33.9,
            43.9,
            58.8,
            66.8,
            257.4,
            222.8,
            270.8,
            1176.8
        ],
        "p50": [
            null,
            51.9,
            94.8,
            135.9,
            120.8,
            265.1,
            116.2,
            145.0,
            242.7,
            431.2,
            655.1,
            1096.4,
            4618.0
        ],
        "p90": [
            null,
            92.2,
            175.5,
            265.4,
            197.1,
            413.6,
            199.2,
            202.0,
            349.0,
            736.8,
            1008.7,
            1664.7,
            6827.7
        ]
    },
    "NEISO": {
        "p10": [
            null,
            null,
            null,
            42.3,
            54.9,
            73.5,
            88.3,
            75.2,
            130.8,
            242.5,
            327.8,
            343.7,
            3215.3
        ],
        "p50": [
            null,
            null,
            null,
            410.2,
            106.9,
            158.1,
            157.8,
            227.6,
            290.8,
            369.9,
            585.5,
            940.3,
            4227.5
        ],
        "p90": [
            null,
            null,
            null,
            3057.3,
            192.1,
            1033.1,
            494.8,
            556.1,
            714.4,
            682.5,
            1255.2,
            1478.2,
            6437.8
        ]
    }
};

// --- Monotonic Envelope MAC (running max of Medium, smooths rebalancing) ---
const MAC_ENVELOPE_DATA = {
    "CAISO": {
        "raw": [
            150.2,
            71.9,
            78.2,
            88.2,
            89.7,
            109.6,
            114.5,
            125.4,
            128.4,
            130.9,
            133.0,
            123.7,
            238.3
        ],
        "envelope": [
            150.2,
            150.2,
            150.2,
            150.2,
            150.2,
            150.2,
            150.2,
            150.2,
            150.2,
            150.2,
            150.2,
            150.2,
            238.3
        ],
        "stepwise_envelope": [
            null,
            0,
            157.4,
            439.4,
            439.4,
            439.4,
            439.4,
            439.4,
            648.9,
            648.9,
            648.9,
            648.9,
            1971.4
        ]
    },
    "ERCOT": {
        "raw": [
            10.2,
            19.1,
            19.3,
            19.8,
            35.5,
            32.3,
            34.0,
            37.6,
            43.8,
            56.8,
            58.9,
            58.9,
            136.0
        ],
        "envelope": [
            10.2,
            19.1,
            19.3,
            19.8,
            35.5,
            35.5,
            35.5,
            37.6,
            43.8,
            56.8,
            58.9,
            58.9,
            136.0
        ],
        "stepwise_envelope": [
            null,
            79.6,
            79.6,
            79.6,
            175.8,
            175.8,
            175.8,
            175.8,
            371.1,
            371.1,
            371.1,
            371.1,
            928.5
        ]
    },
    "PJM": {
        "raw": [
            51.6,
            41.9,
            44.2,
            48.7,
            52.2,
            55.0,
            55.9,
            57.6,
            61.8,
            64.1,
            68.7,
            75.7,
            132.5
        ],
        "envelope": [
            51.6,
            51.6,
            51.6,
            51.6,
            52.2,
            55.0,
            55.9,
            57.6,
            61.8,
            64.1,
            68.7,
            75.7,
            132.5
        ],
        "stepwise_envelope": [
            null,
            0,
            60.2,
            108.1,
            108.1,
            108.1,
            108.1,
            131.5,
            162.7,
            247.1,
            340.2,
            1742.5,
            1896.2
        ]
    },
    "NYISO": {
        "raw": [
            105.8,
            100.7,
            106.3,
            110.3,
            112.4,
            124.8,
            119.9,
            118.6,
            115.5,
            124.6,
            129.7,
            136.0,
            222.5
        ],
        "envelope": [
            105.8,
            105.8,
            106.3,
            110.3,
            112.4,
            124.8,
            124.8,
            124.8,
            124.8,
            124.8,
            129.7,
            136.0,
            222.5
        ],
        "stepwise_envelope": [
            null,
            69.7,
            148.7,
            216.4,
            216.4,
            372.0,
            372.0,
            372.0,
            372.0,
            488.1,
            488.1,
            839.2,
            5898.6
        ]
    },
    "NEISO": {
        "raw": [
            323.5,
            157.3,
            90.4,
            96.0,
            101.1,
            103.7,
            110.1,
            113.0,
            115.9,
            125.2,
            133.7,
            145.0,
            250.4
        ],
        "envelope": [
            323.5,
            323.5,
            323.5,
            323.5,
            323.5,
            323.5,
            323.5,
            323.5,
            323.5,
            323.5,
            323.5,
            323.5,
            323.5
        ],
        "stepwise_envelope": [
            null,
            0,
            0,
            174.5,
            174.5,
            174.5,
            206.7,
            271.9,
            344.6,
            423.7,
            695.3,
            1549.5,
            4022.3
        ]
    }
};

// --- Path-Constrained Reference MAC (monotonic resource deployment) ---
const MAC_PATH_CONSTRAINED = {
    "CAISO": {
        "mac": [
            150.2,
            121.8,
            112.8,
            109.7,
            98.3,
            109.6,
            114.5,
            160.3,
            159.4,
            144.2,
            133.0,
            123.7,
            238.3
        ],
        "costs": [
            29.64,
            29.64,
            29.64,
            29.64,
            29.64,
            35.15,
            41.19,
            41.19,
            41.19,
            41.19,
            43.76,
            45.62,
            93.71
        ]
    },
    "ERCOT": {
        "mac": [
            10.2,
            19.1,
            19.3,
            19.8,
            35.5,
            34.4,
            34.0,
            37.6,
            43.8,
            56.8,
            58.9,
            58.9,
            136.0
        ],
        "costs": [
            3.03,
            6.49,
            7.39,
            7.97,
            15.84,
            15.84,
            16.15,
            18.38,
            21.81,
            25.78,
            29.57,
            30.04,
            76.11
        ]
    },
    "PJM": {
        "mac": [
            51.6,
            43.3,
            44.2,
            48.7,
            52.2,
            55.0,
            55.9,
            57.6,
            61.8,
            64.1,
            68.7,
            75.7,
            132.5
        ],
        "costs": [
            15.24,
            15.24,
            17.77,
            21.13,
            24.13,
            27.0,
            28.01,
            29.54,
            32.99,
            34.61,
            37.77,
            41.8,
            75.51
        ]
    },
    "NYISO": {
        "mac": [
            105.8,
            100.7,
            106.3,
            110.3,
            112.4,
            124.8,
            119.9,
            118.6,
            115.5,
            124.6,
            129.7,
            136.0,
            222.5
        ],
        "costs": [
            22.75,
            25.19,
            30.07,
            32.39,
            34.55,
            40.28,
            41.09,
            42.88,
            44.39,
            49.06,
            52.52,
            55.55,
            92.28
        ]
    },
    "NEISO": {
        "mac": [
            323.5,
            262.9,
            222.0,
            207.1,
            193.3,
            184.9,
            173.5,
            170.3,
            168.2,
            163.1,
            160.7,
            159.4,
            250.4
        ],
        "costs": [
            61.71,
            61.71,
            61.71,
            61.71,
            61.71,
            61.71,
            61.71,
            61.71,
            61.71,
            61.71,
            61.71,
            61.71,
            99.67
        ]
    }
};

// --- ANOVA: Fraction of MAC variance explained by each toggle group ---
// Values are eta-squared (0-1): the proportion of total MAC variance
// attributable to each sensitivity toggle. Higher = more influential.
const MAC_ANOVA = {
    "CAISO": {
        "Renewable Gen": 0.321,
        "Firm Gen": 0.391,
        "Storage": 0.003,
        "Fossil Fuel": 0.13,
        "Transmission": 0.037
    },
    "ERCOT": {
        "Renewable Gen": 0.38,
        "Firm Gen": 0.12,
        "Storage": 0.013,
        "Fossil Fuel": 0.392,
        "Transmission": 0.054
    },
    "PJM": {
        "Renewable Gen": 0.184,
        "Firm Gen": 0.327,
        "Storage": 0.0,
        "Fossil Fuel": 0.378,
        "Transmission": 0.05
    },
    "NYISO": {
        "Renewable Gen": 0.317,
        "Firm Gen": 0.382,
        "Storage": 0.001,
        "Fossil Fuel": 0.047,
        "Transmission": 0.101
    },
    "NEISO": {
        "Renewable Gen": 0.269,
        "Firm Gen": 0.544,
        "Storage": 0.0,
        "Fossil Fuel": 0.058,
        "Transmission": 0.045
    }
};

// --- Crossover Analysis: threshold where MAC exceeds benchmarks ---
const MAC_CROSSOVERS = {
    "CAISO": {
        "scc_epa_190": {
            "envelope": 100,
            "median": 100
        },
        "scc_rennert_185": {
            "envelope": 100,
            "median": 100
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 50,
            "median": 50
        },
        "eu_ets_88": {
            "envelope": 50,
            "median": 50
        }
    },
    "ERCOT": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 60,
            "median": 60
        },
        "eu_ets_88": {
            "envelope": 100,
            "median": 100
        }
    },
    "PJM": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 50,
            "median": 50
        },
        "eu_ets_88": {
            "envelope": 100,
            "median": 100
        }
    },
    "NYISO": {
        "scc_epa_190": {
            "envelope": 100,
            "median": 100
        },
        "scc_rennert_185": {
            "envelope": 100,
            "median": 100
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 50,
            "median": 50
        },
        "eu_ets_88": {
            "envelope": 50,
            "median": 50
        }
    },
    "NEISO": {
        "scc_epa_190": {
            "envelope": 50,
            "median": 50
        },
        "scc_rennert_185": {
            "envelope": 50,
            "median": 50
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 50,
            "median": 50
        },
        "eu_ets_88": {
            "envelope": 50,
            "median": 50
        }
    }
};

