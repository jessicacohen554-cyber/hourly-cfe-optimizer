// ============================================================================
// MAC STATISTICS — Option B: Statistical Post-Processing + Path-Constrained MAC
// ============================================================================
// Auto-generated by compute_mac_stats.py — do not edit manually
// Generated: 2026-02-19 05:59
// Source: 16,200 optimizer scenarios (10 thresholds × 324 cost combos × 5 ISOs)
//
// Methodology:
//   - Fan chart: P10/P25/P50/P75/P90 of average MAC across 324 cost scenarios
//   - Envelope: Running max of Medium MAC (monotonic by construction)
//   - Path-constrained: Enforces non-decreasing resource deployment
//   - ANOVA: Eta-squared decomposition of MAC variance by toggle group
// ============================================================================

// --- MAC Fan Chart (P10/P25/P50/P75/P90 average MAC across 324 scenarios) ---
const MAC_FAN_DATA = {
    "CAISO": {
        "p10": [
            49.7,
            50.9,
            53.4,
            53.0,
            54.6,
            57.8,
            64.9,
            71.1,
            67.4,
            null
        ],
        "p25": [
            60.9,
            62.8,
            66.0,
            68.0,
            68.8,
            73.6,
            77.7,
            84.3,
            80.9,
            null
        ],
        "p50": [
            73.3,
            73.9,
            78.6,
            87.8,
            80.9,
            85.8,
            93.0,
            100.1,
            105.5,
            null
        ],
        "p75": [
            93.8,
            101.5,
            104.9,
            111.7,
            109.5,
            114.2,
            117.8,
            123.7,
            127.3,
            null
        ],
        "p90": [
            111.8,
            119.9,
            124.3,
            127.2,
            126.6,
            129.6,
            132.0,
            140.8,
            150.8,
            null
        ]
    },
    "ERCOT": {
        "p10": [
            9.0,
            10.1,
            13.9,
            14.0,
            17.5,
            20.7,
            23.6,
            26.8,
            29.9,
            null
        ],
        "p25": [
            15.1,
            17.0,
            19.3,
            20.8,
            23.5,
            26.3,
            30.4,
            33.3,
            36.2,
            null
        ],
        "p50": [
            20.7,
            22.7,
            26.5,
            30.0,
            31.9,
            34.3,
            39.0,
            42.3,
            46.0,
            null
        ],
        "p75": [
            30.5,
            32.7,
            37.2,
            40.8,
            42.8,
            46.4,
            50.8,
            54.2,
            58.8,
            null
        ],
        "p90": [
            37.4,
            40.0,
            43.9,
            48.2,
            49.8,
            52.7,
            57.7,
            62.3,
            66.9,
            null
        ]
    },
    "PJM": {
        "p10": [
            23.5,
            25.0,
            29.2,
            31.6,
            31.3,
            36.9,
            35.2,
            37.5,
            44.2,
            null
        ],
        "p25": [
            33.1,
            34.1,
            36.4,
            38.9,
            41.0,
            42.1,
            44.4,
            48.8,
            51.5,
            null
        ],
        "p50": [
            41.1,
            42.8,
            43.9,
            48.9,
            51.0,
            51.2,
            55.5,
            59.5,
            62.5,
            null
        ],
        "p75": [
            53.1,
            57.1,
            58.6,
            65.1,
            65.7,
            67.1,
            69.5,
            75.5,
            78.0,
            null
        ],
        "p90": [
            65.2,
            68.3,
            70.9,
            79.6,
            79.8,
            79.4,
            86.1,
            93.2,
            92.3,
            null
        ]
    },
    "NYISO": {
        "p10": [
            60.3,
            61.2,
            63.3,
            68.9,
            68.4,
            72.2,
            77.6,
            86.3,
            93.8,
            null
        ],
        "p25": [
            73.7,
            73.2,
            74.9,
            76.9,
            77.8,
            83.1,
            86.5,
            95.3,
            101.5,
            null
        ],
        "p50": [
            88.3,
            93.8,
            94.9,
            97.1,
            97.7,
            103.5,
            106.5,
            119.8,
            123.1,
            null
        ],
        "p75": [
            119.1,
            120.9,
            117.4,
            118.8,
            118.7,
            125.7,
            130.8,
            140.7,
            148.3,
            null
        ],
        "p90": [
            145.8,
            145.2,
            149.9,
            149.7,
            151.4,
            157.7,
            162.8,
            172.3,
            181.1,
            null
        ]
    },
    "NEISO": {
        "p10": [
            43.6,
            52.5,
            55.7,
            60.0,
            57.0,
            65.1,
            69.8,
            76.8,
            85.3,
            null
        ],
        "p25": [
            62.6,
            70.8,
            74.8,
            80.4,
            73.3,
            82.0,
            90.1,
            94.1,
            100.6,
            null
        ],
        "p50": [
            88.3,
            93.9,
            98.9,
            104.6,
            94.9,
            103.3,
            118.8,
            119.5,
            122.8,
            null
        ],
        "p75": [
            116.0,
            122.4,
            124.0,
            129.4,
            121.8,
            131.1,
            145.8,
            152.0,
            154.4,
            null
        ],
        "p90": [
            144.5,
            150.3,
            153.4,
            159.2,
            149.3,
            160.2,
            178.3,
            177.2,
            183.6,
            null
        ]
    }
};

// --- Stepwise Marginal MAC Fan (P10/P50/P90 of step MAC between thresholds) ---
const MAC_STEPWISE_FAN = {
    "CAISO": {
        "p10": [
            null,
            63.9,
            52.3,
            29.2,
            92.7,
            213.1,
            99.0,
            213.9,
            87.8,
            null
        ],
        "p50": [
            null,
            113.4,
            136.7,
            149.7,
            142.0,
            313.7,
            346.2,
            311.3,
            300.4,
            null
        ],
        "p90": [
            null,
            813.6,
            431.1,
            1411.4,
            290.9,
            1431.4,
            474.4,
            519.3,
            716.8,
            null
        ]
    },
    "ERCOT": {
        "p10": [
            null,
            39.0,
            71.2,
            89.7,
            57.7,
            80.0,
            122.2,
            128.3,
            194.9,
            null
        ],
        "p50": [
            null,
            101.8,
            101.9,
            139.7,
            111.4,
            153.9,
            197.5,
            196.5,
            268.9,
            null
        ],
        "p90": [
            null,
            156.0,
            138.9,
            429.1,
            886.8,
            205.0,
            270.7,
            274.3,
            384.9,
            null
        ]
    },
    "PJM": {
        "p10": [
            null,
            43.3,
            44.9,
            81.3,
            21.6,
            89.2,
            154.7,
            119.1,
            63.2,
            null
        ],
        "p50": [
            null,
            103.0,
            89.1,
            197.1,
            89.9,
            170.7,
            464.8,
            314.4,
            339.5,
            null
        ],
        "p90": [
            null,
            316.4,
            302.2,
            324.4,
            298.9,
            327.2,
            1676.1,
            607.5,
            787.7,
            null
        ]
    },
    "NYISO": {
        "p10": [
            null,
            28.7,
            139.8,
            51.1,
            75.6,
            111.0,
            174.1,
            183.2,
            111.0,
            null
        ],
        "p50": [
            null,
            198.7,
            218.8,
            177.3,
            231.4,
            271.8,
            287.1,
            359.4,
            622.7,
            null
        ],
        "p90": [
            null,
            320.4,
            350.4,
            401.0,
            872.3,
            479.6,
            413.4,
            1066.2,
            826.1,
            null
        ]
    },
    "NEISO": {
        "p10": [
            null,
            82.7,
            54.4,
            48.7,
            26.8,
            251.1,
            348.7,
            375.5,
            79.1,
            null
        ],
        "p50": [
            null,
            203.0,
            201.2,
            318.2,
            142.4,
            352.5,
            613.5,
            561.1,
            579.5,
            null
        ],
        "p90": [
            null,
            346.9,
            368.2,
            851.1,
            268.2,
            582.3,
            996.2,
            1440.8,
            15001.9,
            null
        ]
    }
};

// --- Monotonic Envelope MAC (running max of Medium, smooths rebalancing) ---
const MAC_ENVELOPE_DATA = {
    "CAISO": {
        "raw": [
            93.8,
            94.6,
            103.2,
            105.7,
            106.2,
            110.2,
            111.7,
            115.1,
            117.9,
            null
        ],
        "envelope": [
            93.8,
            94.6,
            103.2,
            105.7,
            106.2,
            110.2,
            111.7,
            115.1,
            117.9,
            null
        ],
        "stepwise_envelope": [
            null,
            131.7,
            241.0,
            241.0,
            241.0,
            517.3,
            517.3,
            517.3,
            517.3,
            null
        ]
    },
    "ERCOT": {
        "raw": [
            23.5,
            25.7,
            30.4,
            34.9,
            36.1,
            39.3,
            42.9,
            45.9,
            50.3,
            null
        ],
        "envelope": [
            23.5,
            25.7,
            30.4,
            34.9,
            36.1,
            39.3,
            42.9,
            45.9,
            50.3,
            null
        ],
        "stepwise_envelope": [
            null,
            117.6,
            117.6,
            202.8,
            202.8,
            202.8,
            202.8,
            202.8,
            302.8,
            null
        ]
    },
    "PJM": {
        "raw": [
            50.4,
            53.3,
            57.3,
            61.4,
            61.9,
            65.5,
            70.2,
            71.4,
            75.7,
            null
        ],
        "envelope": [
            50.4,
            53.3,
            57.3,
            61.4,
            61.9,
            65.5,
            70.2,
            71.4,
            75.7,
            null
        ],
        "stepwise_envelope": [
            null,
            120.7,
            128.1,
            206.5,
            206.5,
            206.5,
            206.5,
            206.5,
            250.8,
            null
        ]
    },
    "NYISO": {
        "raw": [
            112.9,
            113.1,
            116.5,
            114.7,
            115.1,
            121.7,
            124.3,
            134.1,
            140.9,
            null
        ],
        "envelope": [
            112.9,
            113.1,
            116.5,
            116.5,
            116.5,
            121.7,
            124.3,
            134.1,
            140.9,
            null
        ],
        "stepwise_envelope": [
            null,
            116.1,
            183.7,
            183.7,
            183.7,
            391.3,
            391.3,
            767.9,
            767.9,
            null
        ]
    },
    "NEISO": {
        "raw": [
            105.5,
            111.2,
            114.2,
            121.2,
            118.1,
            121.4,
            127.5,
            157.3,
            168.8,
            null
        ],
        "envelope": [
            105.5,
            111.2,
            114.2,
            121.2,
            121.2,
            121.4,
            127.5,
            157.3,
            168.8,
            null
        ],
        "stepwise_envelope": [
            null,
            191.9,
            191.9,
            425.3,
            425.3,
            425.3,
            693.8,
            1365.4,
            19625.2,
            null
        ]
    }
};

// --- Path-Constrained Reference MAC (monotonic resource deployment) ---
const MAC_PATH_CONSTRAINED = {
    "CAISO": {
        "mac": [
            93.8,
            94.6,
            103.2,
            105.7,
            106.2,
            110.2,
            111.7,
            115.1,
            117.9,
            null
        ],
        "costs": [
            26.12,
            26.98,
            31.24,
            33.76,
            34.91,
            36.61,
            38.4,
            40.17,
            41.66,
            null
        ]
    },
    "ERCOT": {
        "mac": [
            23.5,
            25.7,
            30.4,
            34.9,
            36.1,
            39.3,
            42.9,
            45.9,
            50.3,
            null
        ],
        "costs": [
            9.9,
            11.13,
            13.92,
            16.44,
            17.23,
            19.5,
            21.8,
            23.78,
            26.5,
            null
        ]
    },
    "PJM": {
        "mac": [
            50.4,
            53.3,
            57.3,
            61.4,
            61.9,
            65.5,
            70.2,
            71.4,
            75.7,
            null
        ],
        "costs": [
            21.36,
            23.61,
            26.77,
            29.49,
            30.41,
            33.1,
            34.66,
            37.25,
            40.49,
            null
        ]
    },
    "NYISO": {
        "mac": [
            112.9,
            113.1,
            116.5,
            114.7,
            115.1,
            121.7,
            124.3,
            134.1,
            140.9,
            null
        ],
        "costs": [
            33.79,
            36.22,
            39.15,
            39.87,
            40.89,
            44.28,
            46.24,
            50.68,
            54.0,
            null
        ]
    },
    "NEISO": {
        "mac": [
            105.5,
            111.2,
            114.2,
            121.2,
            118.1,
            121.4,
            127.5,
            157.3,
            168.8,
            null
        ],
        "costs": [
            30.1,
            33.93,
            36.64,
            39.77,
            40.05,
            41.92,
            44.49,
            56.27,
            60.43,
            null
        ]
    }
};

// --- ANOVA: Fraction of MAC variance explained by each toggle group ---
// Values are eta-squared (0-1): the proportion of total MAC variance
// attributable to each sensitivity toggle. Higher = more influential.
const MAC_ANOVA = {
    "CAISO": {
        "Renewable Gen": 0.24,
        "Firm Gen": 0.491,
        "Storage": 0.013,
        "Fossil Fuel": 0.064,
        "Transmission": 0.031
    },
    "ERCOT": {
        "Renewable Gen": 0.692,
        "Firm Gen": 0.032,
        "Storage": 0.009,
        "Fossil Fuel": 0.053,
        "Transmission": 0.099
    },
    "PJM": {
        "Renewable Gen": 0.28,
        "Firm Gen": 0.236,
        "Storage": 0.004,
        "Fossil Fuel": 0.227,
        "Transmission": 0.073
    },
    "NYISO": {
        "Renewable Gen": 0.282,
        "Firm Gen": 0.409,
        "Storage": 0.003,
        "Fossil Fuel": 0.02,
        "Transmission": 0.096
    },
    "NEISO": {
        "Renewable Gen": 0.506,
        "Firm Gen": 0.116,
        "Storage": 0.005,
        "Fossil Fuel": 0.093,
        "Transmission": 0.115
    }
};

// --- Crossover Analysis: threshold where MAC exceeds benchmarks ---
const MAC_CROSSOVERS = {
    "CAISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 95
        }
    },
    "ERCOT": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": ">99",
            "median": ">99"
        }
    },
    "PJM": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": ">99",
            "median": ">99"
        }
    },
    "NYISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 75
        }
    },
    "NEISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 75
        }
    }
};

