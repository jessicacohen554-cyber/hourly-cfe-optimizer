// ============================================================================
// MAC STATISTICS — Option B: Statistical Post-Processing + Path-Constrained MAC
// ============================================================================
// Auto-generated by compute_mac_stats.py — do not edit manually
// Generated: 2026-02-16 01:47
// Source: 16,200 optimizer scenarios (10 thresholds × 324 cost combos × 5 ISOs)
//
// Methodology:
//   - Fan chart: P10/P25/P50/P75/P90 of average MAC across 324 cost scenarios
//   - Envelope: Running max of Medium MAC (monotonic by construction)
//   - Path-constrained: Enforces non-decreasing resource deployment
//   - ANOVA: Eta-squared decomposition of MAC variance by toggle group
// ============================================================================

// --- MAC Fan Chart (P10/P25/P50/P75/P90 average MAC across 324 scenarios) ---
const MAC_FAN_DATA = {
    "CAISO": {
        "p10": [
            46.3,
            47.5,
            49.9,
            52.4,
            53.4,
            56.2,
            58.7,
            65.2,
            66.3,
            null
        ],
        "p25": [
            59.2,
            63.3,
            65.6,
            67.7,
            66.0,
            69.8,
            73.5,
            77.4,
            80.4,
            null
        ],
        "p50": [
            70.4,
            75.6,
            79.1,
            87.9,
            80.5,
            84.6,
            91.5,
            99.5,
            105.8,
            null
        ],
        "p75": [
            93.5,
            102.4,
            103.5,
            111.7,
            107.1,
            107.4,
            116.3,
            120.7,
            127.1,
            null
        ],
        "p90": [
            110.2,
            119.6,
            121.8,
            127.2,
            126.0,
            132.1,
            139.1,
            146.7,
            153.2,
            null
        ]
    },
    "ERCOT": {
        "p10": [
            4.8,
            6.2,
            10.2,
            13.2,
            14.5,
            17.0,
            19.7,
            22.6,
            25.4,
            null
        ],
        "p25": [
            12.2,
            13.8,
            18.0,
            20.4,
            22.4,
            25.3,
            28.7,
            31.6,
            34.8,
            null
        ],
        "p50": [
            20.2,
            22.0,
            26.9,
            29.9,
            31.4,
            35.1,
            39.1,
            42.5,
            46.3,
            null
        ],
        "p75": [
            30.4,
            32.7,
            36.7,
            40.2,
            42.1,
            45.4,
            49.4,
            53.8,
            57.8,
            null
        ],
        "p90": [
            39.0,
            41.3,
            46.1,
            49.0,
            51.6,
            54.5,
            59.0,
            63.4,
            68.5,
            null
        ]
    },
    "PJM": {
        "p10": [
            12.0,
            12.6,
            14.3,
            16.1,
            17.0,
            17.5,
            19.8,
            24.0,
            26.6,
            null
        ],
        "p25": [
            24.0,
            25.8,
            27.1,
            29.3,
            30.9,
            31.6,
            34.1,
            39.3,
            40.7,
            null
        ],
        "p50": [
            33.6,
            35.7,
            37.0,
            38.6,
            41.0,
            42.9,
            44.8,
            50.3,
            54.1,
            null
        ],
        "p75": [
            52.3,
            53.6,
            56.2,
            59.5,
            60.7,
            62.0,
            65.0,
            70.8,
            74.1,
            null
        ],
        "p90": [
            64.9,
            67.6,
            72.3,
            74.2,
            74.8,
            78.5,
            79.6,
            86.8,
            92.2,
            null
        ]
    },
    "NYISO": {
        "p10": [
            49.7,
            49.1,
            50.4,
            50.6,
            51.2,
            54.8,
            57.1,
            70.3,
            74.9,
            null
        ],
        "p25": [
            58.1,
            59.5,
            59.9,
            60.0,
            60.7,
            64.7,
            67.0,
            80.7,
            86.3,
            null
        ],
        "p50": [
            79.2,
            82.5,
            86.2,
            86.5,
            88.8,
            95.6,
            96.6,
            108.9,
            111.0,
            null
        ],
        "p75": [
            104.5,
            105.6,
            105.3,
            105.5,
            106.7,
            113.3,
            117.0,
            131.1,
            132.9,
            null
        ],
        "p90": [
            139.1,
            145.6,
            148.4,
            149.5,
            153.3,
            159.9,
            165.5,
            174.7,
            181.6,
            null
        ]
    },
    "NEISO": {
        "p10": [
            52.4,
            58.1,
            60.9,
            61.4,
            63.0,
            67.8,
            71.8,
            76.5,
            83.9,
            null
        ],
        "p25": [
            68.5,
            72.3,
            74.9,
            77.1,
            74.5,
            81.7,
            84.2,
            88.3,
            96.1,
            null
        ],
        "p50": [
            89.0,
            92.2,
            93.9,
            97.9,
            92.5,
            99.1,
            102.1,
            108.4,
            116.9,
            null
        ],
        "p75": [
            117.1,
            122.7,
            122.2,
            124.7,
            125.2,
            131.6,
            136.8,
            141.4,
            148.7,
            null
        ],
        "p90": [
            145.3,
            144.8,
            147.4,
            147.6,
            149.5,
            155.2,
            167.1,
            174.6,
            183.1,
            null
        ]
    }
};

// --- Stepwise Marginal MAC Fan (P10/P50/P90 of step MAC between thresholds) ---
const MAC_STEPWISE_FAN = {
    "CAISO": {
        "p10": [
            null,
            97.4,
            64.9,
            19.7,
            67.3,
            81.8,
            127.5,
            78.0,
            223.0,
            null
        ],
        "p50": [
            null,
            214.2,
            107.0,
            474.6,
            137.6,
            289.9,
            266.5,
            315.2,
            302.6,
            null
        ],
        "p90": [
            null,
            2126.5,
            188.5,
            5513.4,
            239.0,
            573.3,
            486.8,
            2584.0,
            453.5,
            null
        ]
    },
    "ERCOT": {
        "p10": [
            null,
            42.9,
            70.2,
            73.4,
            65.8,
            96.0,
            114.3,
            130.0,
            192.1,
            null
        ],
        "p50": [
            null,
            78.4,
            111.6,
            118.2,
            110.1,
            154.1,
            191.6,
            207.6,
            266.1,
            null
        ],
        "p90": [
            null,
            134.2,
            180.9,
            218.1,
            215.9,
            203.1,
            262.9,
            287.0,
            368.5,
            null
        ]
    },
    "PJM": {
        "p10": [
            null,
            16.6,
            25.7,
            35.3,
            45.1,
            79.0,
            211.7,
            145.6,
            139.8,
            null
        ],
        "p50": [
            null,
            61.8,
            63.1,
            81.5,
            104.8,
            149.8,
            338.6,
            212.0,
            513.5,
            null
        ],
        "p90": [
            null,
            177.2,
            188.3,
            185.9,
            209.9,
            499.5,
            469.4,
            315.4,
            3447.7,
            null
        ]
    },
    "NYISO": {
        "p10": [
            null,
            22.4,
            37.9,
            56.5,
            98.4,
            188.9,
            70.2,
            229.4,
            37.0,
            null
        ],
        "p50": [
            null,
            117.1,
            74.3,
            97.8,
            155.3,
            261.2,
            299.3,
            449.3,
            335.3,
            null
        ],
        "p90": [
            null,
            239.1,
            316.2,
            200.9,
            983.2,
            718.4,
            362.4,
            726.2,
            602.1,
            null
        ]
    },
    "NEISO": {
        "p10": [
            null,
            36.0,
            81.1,
            24.8,
            18.3,
            259.7,
            61.3,
            153.3,
            238.7,
            null
        ],
        "p50": [
            null,
            140.8,
            166.3,
            108.2,
            169.9,
            327.2,
            527.5,
            482.6,
            676.9,
            null
        ],
        "p90": [
            null,
            285.5,
            290.6,
            408.4,
            365.5,
            548.5,
            891.4,
            832.1,
            6130.8,
            null
        ]
    }
};

// --- Monotonic Envelope MAC (running max of Medium, smooths rebalancing) ---
const MAC_ENVELOPE_DATA = {
    "CAISO": {
        "raw": [
            92.8,
            95.5,
            103.6,
            103.9,
            106.8,
            106.4,
            109.0,
            115.7,
            117.9,
            null
        ],
        "envelope": [
            92.8,
            95.5,
            103.6,
            103.9,
            106.8,
            106.8,
            109.0,
            115.7,
            117.9,
            null
        ],
        "stepwise_envelope": [
            null,
            244.9,
            244.9,
            244.9,
            244.9,
            244.9,
            244.9,
            2775.7,
            2775.7,
            null
        ]
    },
    "ERCOT": {
        "raw": [
            23.5,
            25.7,
            30.8,
            35.3,
            36.5,
            39.6,
            42.9,
            46.1,
            50.3,
            null
        ],
        "envelope": [
            23.5,
            25.7,
            30.8,
            35.3,
            36.5,
            39.6,
            42.9,
            46.1,
            50.3,
            null
        ],
        "stepwise_envelope": [
            null,
            117.6,
            117.6,
            202.0,
            202.0,
            202.0,
            202.0,
            206.8,
            289.6,
            null
        ]
    },
    "PJM": {
        "raw": [
            49.1,
            49.2,
            48.8,
            50.5,
            51.7,
            52.7,
            55.9,
            62.6,
            62.6,
            null
        ],
        "envelope": [
            49.1,
            49.2,
            49.2,
            50.5,
            51.7,
            52.7,
            55.9,
            62.6,
            62.6,
            null
        ],
        "stepwise_envelope": [
            null,
            52.1,
            52.1,
            86.3,
            128.8,
            161.5,
            413.9,
            413.9,
            413.9,
            null
        ]
    },
    "NYISO": {
        "raw": [
            104.5,
            107.5,
            98.2,
            98.3,
            99.0,
            106.4,
            106.4,
            120.2,
            120.5,
            null
        ],
        "envelope": [
            104.5,
            107.5,
            107.5,
            107.5,
            107.5,
            107.5,
            107.5,
            120.2,
            120.5,
            null
        ],
        "stepwise_envelope": [
            null,
            195.9,
            195.9,
            195.9,
            195.9,
            195.9,
            195.9,
            195.9,
            195.9,
            null
        ]
    },
    "NEISO": {
        "raw": [
            114.7,
            112.6,
            121.8,
            122.7,
            125.2,
            128.8,
            136.9,
            146.1,
            145.9,
            null
        ],
        "envelope": [
            114.7,
            114.7,
            121.8,
            122.7,
            125.2,
            128.8,
            136.9,
            146.1,
            146.1,
            null
        ],
        "stepwise_envelope": [
            null,
            82.7,
            301.0,
            301.0,
            301.0,
            319.6,
            893.6,
            893.6,
            893.6,
            null
        ]
    }
};

// --- Path-Constrained Reference MAC (monotonic resource deployment) ---
const MAC_PATH_CONSTRAINED = {
    "CAISO": {
        "mac": [
            92.8,
            95.5,
            103.6,
            103.9,
            106.8,
            106.4,
            109.0,
            115.7,
            117.9,
            null
        ],
        "costs": [
            26.0,
            27.22,
            31.33,
            33.02,
            35.12,
            35.33,
            37.92,
            40.37,
            41.67,
            null
        ]
    },
    "ERCOT": {
        "mac": [
            23.5,
            25.7,
            30.8,
            35.3,
            36.5,
            39.6,
            42.9,
            46.1,
            50.3,
            null
        ],
        "costs": [
            9.9,
            11.13,
            14.12,
            16.63,
            17.43,
            19.62,
            21.8,
            23.91,
            26.52,
            null
        ]
    },
    "PJM": {
        "mac": [
            49.1,
            49.2,
            48.8,
            50.5,
            51.7,
            52.7,
            55.9,
            62.6,
            62.6,
            null
        ],
        "costs": [
            21.63,
            23.0,
            24.21,
            26.23,
            27.29,
            28.09,
            30.04,
            34.59,
            34.59,
            null
        ]
    },
    "NYISO": {
        "mac": [
            104.5,
            107.5,
            98.2,
            98.3,
            99.0,
            106.4,
            106.4,
            120.2,
            120.5,
            null
        ],
        "costs": [
            33.39,
            35.53,
            36.97,
            37.44,
            38.29,
            40.73,
            42.62,
            47.87,
            49.21,
            null
        ]
    },
    "NEISO": {
        "mac": [
            114.7,
            112.6,
            121.8,
            122.7,
            125.2,
            128.8,
            136.9,
            146.1,
            145.9,
            null
        ],
        "costs": [
            32.73,
            34.38,
            39.06,
            40.97,
            42.42,
            44.47,
            47.78,
            52.25,
            55.02,
            null
        ]
    }
};

// --- ANOVA: Fraction of MAC variance explained by each toggle group ---
// Values are eta-squared (0-1): the proportion of total MAC variance
// attributable to each sensitivity toggle. Higher = more influential.
const MAC_ANOVA = {
    "CAISO": {
        "Renewable Gen": 0.216,
        "Firm Gen": 0.477,
        "Storage": 0.012,
        "Fossil Fuel": 0.115,
        "Transmission": 0.028
    },
    "ERCOT": {
        "Renewable Gen": 0.482,
        "Firm Gen": 0.016,
        "Storage": 0.007,
        "Fossil Fuel": 0.389,
        "Transmission": 0.069
    },
    "PJM": {
        "Renewable Gen": 0.112,
        "Firm Gen": 0.438,
        "Storage": 0.002,
        "Fossil Fuel": 0.279,
        "Transmission": 0.041
    },
    "NYISO": {
        "Renewable Gen": 0.139,
        "Firm Gen": 0.584,
        "Storage": 0.002,
        "Fossil Fuel": 0.039,
        "Transmission": 0.059
    },
    "NEISO": {
        "Renewable Gen": 0.347,
        "Firm Gen": 0.275,
        "Storage": 0.005,
        "Fossil Fuel": 0.099,
        "Transmission": 0.09
    }
};

// --- Crossover Analysis: threshold where MAC exceeds benchmarks ---
const MAC_CROSSOVERS = {
    "CAISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 95
        }
    },
    "ERCOT": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": ">99",
            "median": ">99"
        }
    },
    "PJM": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": ">99",
            "median": ">99"
        }
    },
    "NYISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 90
        }
    },
    "NEISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 75
        }
    }
};

