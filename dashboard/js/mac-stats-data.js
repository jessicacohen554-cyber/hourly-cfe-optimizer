// ============================================================================
// MAC STATISTICS — Option B: Statistical Post-Processing + Path-Constrained MAC
// ============================================================================
// Auto-generated by compute_mac_stats.py — do not edit manually
// Generated: 2026-02-16 06:27
// Source: 16,200 optimizer scenarios (10 thresholds × 324 cost combos × 5 ISOs)
//
// Methodology:
//   - Fan chart: P10/P25/P50/P75/P90 of average MAC across 324 cost scenarios
//   - Envelope: Running max of Medium MAC (monotonic by construction)
//   - Path-constrained: Enforces non-decreasing resource deployment
//   - ANOVA: Eta-squared decomposition of MAC variance by toggle group
// ============================================================================

// --- MAC Fan Chart (P10/P25/P50/P75/P90 average MAC across 324 scenarios) ---
const MAC_FAN_DATA = {
    "CAISO": {
        "p10": [
            49.9,
            51.4,
            53.1,
            52.5,
            54.1,
            56.6,
            60.6,
            68.5,
            65.7,
            null
        ],
        "p25": [
            63.6,
            63.7,
            67.1,
            68.0,
            68.3,
            71.9,
            74.4,
            80.9,
            79.8,
            null
        ],
        "p50": [
            81.3,
            76.6,
            79.8,
            87.8,
            80.6,
            84.9,
            89.7,
            99.5,
            104.3,
            null
        ],
        "p75": [
            103.1,
            102.8,
            104.2,
            111.5,
            106.8,
            112.5,
            117.0,
            121.9,
            126.6,
            null
        ],
        "p90": [
            114.1,
            121.1,
            125.8,
            127.2,
            131.7,
            135.1,
            136.0,
            141.1,
            149.0,
            null
        ]
    },
    "ERCOT": {
        "p10": [
            11.5,
            12.2,
            14.8,
            13.8,
            17.9,
            20.9,
            23.6,
            27.7,
            29.9,
            null
        ],
        "p25": [
            17.7,
            18.9,
            19.9,
            21.4,
            23.4,
            26.5,
            30.4,
            33.2,
            36.1,
            null
        ],
        "p50": [
            24.3,
            25.7,
            27.9,
            30.2,
            31.6,
            34.1,
            38.7,
            42.1,
            45.7,
            null
        ],
        "p75": [
            34.0,
            35.6,
            39.4,
            41.4,
            42.5,
            46.3,
            51.3,
            54.2,
            58.8,
            null
        ],
        "p90": [
            40.4,
            42.6,
            45.8,
            48.6,
            49.7,
            52.8,
            57.7,
            62.1,
            66.5,
            null
        ]
    },
    "PJM": {
        "p10": [
            54.7,
            47.7,
            39.8,
            38.9,
            42.6,
            45.5,
            43.6,
            46.5,
            51.8,
            null
        ],
        "p25": [
            68.5,
            59.5,
            58.7,
            56.4,
            55.8,
            56.1,
            53.9,
            53.7,
            59.1,
            null
        ],
        "p50": [
            94.3,
            79.9,
            74.5,
            67.6,
            66.0,
            66.0,
            70.6,
            64.6,
            69.9,
            null
        ],
        "p75": [
            110.7,
            94.9,
            90.4,
            82.9,
            80.2,
            81.7,
            88.4,
            80.6,
            85.6,
            null
        ],
        "p90": [
            131.8,
            117.6,
            111.2,
            100.8,
            95.5,
            95.9,
            105.6,
            94.5,
            98.8,
            null
        ]
    },
    "NYISO": {
        "p10": [
            73.1,
            72.8,
            78.8,
            82.5,
            83.4,
            79.4,
            78.1,
            94.1,
            88.1,
            null
        ],
        "p25": [
            112.8,
            103.4,
            96.4,
            95.5,
            90.2,
            86.1,
            84.5,
            108.4,
            95.5,
            null
        ],
        "p50": [
            137.1,
            116.3,
            112.9,
            108.4,
            104.4,
            112.6,
            109.1,
            128.6,
            120.7,
            null
        ],
        "p75": [
            167.9,
            141.5,
            143.1,
            141.6,
            139.1,
            139.1,
            128.0,
            157.7,
            140.9,
            null
        ],
        "p90": [
            189.9,
            166.9,
            158.7,
            154.7,
            152.6,
            159.3,
            162.8,
            175.0,
            181.4,
            null
        ]
    },
    "NEISO": {
        "p10": [
            44.0,
            52.3,
            55.8,
            58.9,
            61.2,
            64.9,
            70.6,
            80.0,
            87.5,
            null
        ],
        "p25": [
            62.6,
            72.4,
            76.5,
            76.9,
            81.2,
            84.2,
            88.9,
            97.8,
            106.0,
            null
        ],
        "p50": [
            94.5,
            100.2,
            103.5,
            101.4,
            103.2,
            108.0,
            112.3,
            120.0,
            127.8,
            null
        ],
        "p75": [
            123.7,
            126.8,
            127.1,
            128.2,
            130.8,
            133.4,
            139.8,
            151.9,
            159.7,
            null
        ],
        "p90": [
            154.2,
            154.7,
            157.3,
            159.0,
            159.9,
            166.0,
            170.0,
            180.3,
            188.6,
            null
        ]
    }
};

// --- Stepwise Marginal MAC Fan (P10/P50/P90 of step MAC between thresholds) ---
const MAC_STEPWISE_FAN = {
    "CAISO": {
        "p10": [
            null,
            63.9,
            59.2,
            18.5,
            100.3,
            75.4,
            123.1,
            157.9,
            213.9,
            null
        ],
        "p50": [
            null,
            160.9,
            117.0,
            285.1,
            151.9,
            244.4,
            264.7,
            301.6,
            313.9,
            null
        ],
        "p90": [
            null,
            1628.3,
            279.8,
            5823.3,
            284.3,
            1226.3,
            388.8,
            1297.9,
            471.5,
            null
        ]
    },
    "ERCOT": {
        "p10": [
            null,
            33.9,
            50.1,
            59.8,
            23.2,
            99.6,
            120.9,
            111.9,
            169.4,
            null
        ],
        "p50": [
            null,
            65.2,
            82.9,
            108.9,
            84.6,
            151.3,
            209.1,
            191.3,
            274.1,
            null
        ],
        "p90": [
            null,
            132.9,
            120.1,
            369.5,
            257.5,
            203.3,
            270.9,
            263.6,
            384.9,
            null
        ]
    },
    "PJM": {
        "p10": [
            null,
            105.9,
            41.6,
            8.3,
            43.4,
            124.4,
            481.2,
            70.7,
            298.8,
            null
        ],
        "p50": [
            null,
            144.4,
            90.2,
            37.7,
            132.2,
            229.4,
            1226.8,
            269.5,
            601.4,
            null
        ],
        "p90": [
            null,
            274.3,
            311.7,
            107.3,
            389.0,
            660.1,
            1924.2,
            540.9,
            8423.7,
            null
        ]
    },
    "NYISO": {
        "p10": [
            null,
            22.0,
            104.5,
            42.8,
            106.0,
            217.7,
            142.6,
            210.5,
            307.4,
            null
        ],
        "p50": [
            null,
            107.8,
            186.2,
            155.2,
            406.6,
            353.2,
            279.7,
            449.3,
            538.9,
            null
        ],
        "p90": [
            null,
            168.0,
            366.8,
            481.5,
            907.3,
            991.0,
            487.8,
            654.2,
            1474.9,
            null
        ]
    },
    "NEISO": {
        "p10": [
            null,
            71.7,
            37.8,
            35.1,
            60.7,
            269.3,
            85.4,
            339.4,
            389.5,
            null
        ],
        "p50": [
            null,
            199.2,
            117.9,
            115.3,
            181.9,
            349.7,
            434.2,
            534.2,
            705.8,
            null
        ],
        "p90": [
            null,
            322.7,
            389.2,
            421.3,
            372.0,
            557.0,
            752.2,
            1174.4,
            6267.3,
            null
        ]
    }
};

// --- Monotonic Envelope MAC (running max of Medium, smooths rebalancing) ---
const MAC_ENVELOPE_DATA = {
    "CAISO": {
        "raw": [
            104.3,
            95.5,
            103.5,
            103.9,
            106.0,
            110.2,
            112.7,
            114.7,
            117.2,
            null
        ],
        "envelope": [
            104.3,
            104.3,
            104.3,
            104.3,
            106.0,
            110.2,
            112.7,
            114.7,
            117.2,
            null
        ],
        "stepwise_envelope": [
            null,
            0,
            236.9,
            236.9,
            236.9,
            538.6,
            538.6,
            872.4,
            872.4,
            null
        ]
    },
    "ERCOT": {
        "raw": [
            27.1,
            29.2,
            32.0,
            35.5,
            35.4,
            39.6,
            42.9,
            45.7,
            50.3,
            null
        ],
        "envelope": [
            27.1,
            29.2,
            32.0,
            35.5,
            35.5,
            39.6,
            42.9,
            45.7,
            50.3,
            null
        ],
        "stepwise_envelope": [
            null,
            111.9,
            111.9,
            164.2,
            164.2,
            164.2,
            173.6,
            183.3,
            316.2,
            null
        ]
    },
    "PJM": {
        "raw": [
            108.8,
            109.1,
            111.8,
            97.5,
            93.1,
            90.7,
            98.1,
            85.1,
            85.1,
            null
        ],
        "envelope": [
            108.8,
            109.1,
            111.8,
            111.8,
            111.8,
            111.8,
            111.8,
            111.8,
            111.8,
            null
        ],
        "stepwise_envelope": [
            null,
            113.3,
            155.2,
            155.2,
            155.2,
            155.2,
            929.7,
            929.7,
            929.7,
            null
        ]
    },
    "NYISO": {
        "raw": [
            170.6,
            122.4,
            152.4,
            146.6,
            139.1,
            139.1,
            123.9,
            155.4,
            129.3,
            null
        ],
        "envelope": [
            170.6,
            170.6,
            170.6,
            170.6,
            170.6,
            170.6,
            170.6,
            170.6,
            170.6,
            null
        ],
        "stepwise_envelope": [
            null,
            0,
            366.8,
            366.8,
            366.8,
            366.8,
            366.8,
            366.8,
            366.8,
            null
        ]
    },
    "NEISO": {
        "raw": [
            106.2,
            113.5,
            116.8,
            115.1,
            117.6,
            122.0,
            123.0,
            158.9,
            168.6,
            null
        ],
        "envelope": [
            106.2,
            113.5,
            116.8,
            116.8,
            117.6,
            122.0,
            123.0,
            158.9,
            168.6,
            null
        ],
        "stepwise_envelope": [
            null,
            218.0,
            218.0,
            218.0,
            283.8,
            355.4,
            355.4,
            1610.0,
            1610.0,
            null
        ]
    }
};

// --- Path-Constrained Reference MAC (monotonic resource deployment) ---
const MAC_PATH_CONSTRAINED = {
    "CAISO": {
        "mac": [
            104.3,
            102.4,
            103.5,
            103.9,
            106.0,
            110.2,
            112.7,
            114.7,
            117.2,
            null
        ],
        "costs": [
            29.21,
            29.21,
            31.31,
            33.02,
            34.84,
            36.61,
            39.23,
            40.0,
            41.42,
            null
        ]
    },
    "ERCOT": {
        "mac": [
            27.1,
            29.2,
            32.0,
            35.5,
            35.4,
            39.6,
            42.9,
            45.7,
            50.3,
            null
        ],
        "costs": [
            11.46,
            12.63,
            14.67,
            16.71,
            16.92,
            19.62,
            21.8,
            23.67,
            26.52,
            null
        ]
    },
    "PJM": {
        "mac": [
            108.8,
            109.1,
            111.8,
            106.7,
            105.1,
            104.1,
            103.2,
            100.4,
            100.4,
            null
        ],
        "costs": [
            47.98,
            50.96,
            55.43,
            55.43,
            55.43,
            55.43,
            55.43,
            55.43,
            55.43,
            null
        ]
    },
    "NYISO": {
        "mac": [
            170.6,
            165.0,
            152.4,
            150.6,
            148.4,
            150.0,
            143.3,
            155.4,
            151.7,
            null
        ],
        "costs": [
            54.52,
            54.52,
            57.4,
            57.4,
            57.4,
            57.4,
            57.4,
            61.91,
            61.91,
            null
        ]
    },
    "NEISO": {
        "mac": [
            106.2,
            113.5,
            116.8,
            115.1,
            117.6,
            122.0,
            123.0,
            158.9,
            168.6,
            null
        ],
        "costs": [
            30.29,
            34.64,
            37.47,
            38.45,
            39.87,
            42.15,
            42.94,
            56.83,
            63.59,
            null
        ]
    }
};

// --- ANOVA: Fraction of MAC variance explained by each toggle group ---
// Values are eta-squared (0-1): the proportion of total MAC variance
// attributable to each sensitivity toggle. Higher = more influential.
const MAC_ANOVA = {
    "CAISO": {
        "Renewable Gen": 0.223,
        "Firm Gen": 0.509,
        "Storage": 0.012,
        "Fossil Fuel": 0.058,
        "Transmission": 0.03
    },
    "ERCOT": {
        "Renewable Gen": 0.676,
        "Firm Gen": 0.04,
        "Storage": 0.009,
        "Fossil Fuel": 0.046,
        "Transmission": 0.101
    },
    "PJM": {
        "Renewable Gen": 0.405,
        "Firm Gen": 0.112,
        "Storage": 0.004,
        "Fossil Fuel": 0.152,
        "Transmission": 0.071
    },
    "NYISO": {
        "Renewable Gen": 0.396,
        "Firm Gen": 0.259,
        "Storage": 0.003,
        "Fossil Fuel": 0.003,
        "Transmission": 0.105
    },
    "NEISO": {
        "Renewable Gen": 0.557,
        "Firm Gen": 0.074,
        "Storage": 0.006,
        "Fossil Fuel": 0.087,
        "Transmission": 0.125
    }
};

// --- Crossover Analysis: threshold where MAC exceeds benchmarks ---
const MAC_CROSSOVERS = {
    "CAISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 95
        }
    },
    "ERCOT": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": ">99",
            "median": ">99"
        }
    },
    "PJM": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 75
        }
    },
    "NYISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 75
        }
    },
    "NEISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 75
        }
    }
};

