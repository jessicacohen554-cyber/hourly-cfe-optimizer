// ============================================================================
// MAC STATISTICS — Option B: Statistical Post-Processing + Path-Constrained MAC
// ============================================================================
// Auto-generated by compute_mac_stats.py — do not edit manually
// Generated: 2026-02-16 07:06
// Source: 16,200 optimizer scenarios (10 thresholds × 324 cost combos × 5 ISOs)
//
// Methodology:
//   - Fan chart: P10/P25/P50/P75/P90 of average MAC across 324 cost scenarios
//   - Envelope: Running max of Medium MAC (monotonic by construction)
//   - Path-constrained: Enforces non-decreasing resource deployment
//   - ANOVA: Eta-squared decomposition of MAC variance by toggle group
// ============================================================================

// --- MAC Fan Chart (P10/P25/P50/P75/P90 average MAC across 324 scenarios) ---
const MAC_FAN_DATA = {
    "CAISO": {
        "p10": [
            46.1,
            46.9,
            49.6,
            52.2,
            52.7,
            56.4,
            60.5,
            68.0,
            66.3,
            null
        ],
        "p25": [
            59.4,
            62.6,
            65.1,
            67.7,
            65.5,
            70.9,
            73.8,
            80.2,
            80.1,
            null
        ],
        "p50": [
            70.9,
            75.1,
            78.8,
            87.8,
            79.7,
            86.0,
            92.7,
            100.8,
            105.5,
            null
        ],
        "p75": [
            96.1,
            102.1,
            104.8,
            111.6,
            109.2,
            113.2,
            118.2,
            123.9,
            126.4,
            null
        ],
        "p90": [
            113.9,
            120.4,
            122.7,
            127.2,
            127.6,
            135.2,
            138.4,
            146.3,
            152.9,
            null
        ]
    },
    "ERCOT": {
        "p10": [
            4.7,
            6.2,
            10.2,
            13.2,
            14.5,
            17.0,
            19.7,
            22.4,
            25.4,
            null
        ],
        "p25": [
            12.2,
            13.8,
            18.0,
            20.3,
            22.4,
            25.4,
            28.7,
            31.4,
            34.8,
            null
        ],
        "p50": [
            20.2,
            22.0,
            26.9,
            29.9,
            31.3,
            35.3,
            39.1,
            42.3,
            46.4,
            null
        ],
        "p75": [
            30.5,
            32.7,
            36.6,
            40.4,
            42.1,
            45.3,
            49.4,
            53.7,
            57.8,
            null
        ],
        "p90": [
            39.0,
            41.3,
            46.1,
            49.1,
            51.5,
            54.6,
            59.0,
            63.2,
            68.6,
            null
        ]
    },
    "PJM": {
        "p10": [
            24.4,
            29.6,
            31.7,
            36.4,
            38.2,
            41.3,
            41.6,
            49.1,
            52.6,
            null
        ],
        "p25": [
            39.0,
            41.4,
            42.2,
            46.7,
            49.9,
            51.6,
            54.1,
            60.4,
            61.9,
            null
        ],
        "p50": [
            54.8,
            57.8,
            61.2,
            64.5,
            66.2,
            68.9,
            70.5,
            77.9,
            79.1,
            null
        ],
        "p75": [
            69.5,
            71.3,
            74.8,
            78.6,
            80.8,
            83.3,
            88.6,
            94.4,
            96.3,
            null
        ],
        "p90": [
            86.5,
            89.1,
            93.1,
            96.3,
            97.7,
            102.2,
            106.7,
            112.3,
            113.1,
            null
        ]
    },
    "NYISO": {
        "p10": [
            59.6,
            66.7,
            74.5,
            75.4,
            78.0,
            83.3,
            86.2,
            93.5,
            100.7,
            null
        ],
        "p25": [
            78.8,
            84.5,
            85.6,
            87.1,
            89.4,
            94.5,
            97.2,
            108.5,
            112.5,
            null
        ],
        "p50": [
            95.6,
            98.3,
            101.3,
            103.3,
            104.9,
            112.0,
            113.1,
            128.0,
            131.3,
            null
        ],
        "p75": [
            127.4,
            129.3,
            133.0,
            135.7,
            137.0,
            137.7,
            146.6,
            157.9,
            160.4,
            null
        ],
        "p90": [
            149.4,
            146.4,
            151.2,
            151.4,
            152.3,
            159.2,
            164.9,
            177.1,
            181.9,
            null
        ]
    },
    "NEISO": {
        "p10": [
            43.5,
            52.3,
            55.2,
            59.1,
            61.2,
            65.0,
            70.3,
            80.2,
            87.9,
            null
        ],
        "p25": [
            62.0,
            71.8,
            76.5,
            78.2,
            81.2,
            84.2,
            89.4,
            97.9,
            106.1,
            null
        ],
        "p50": [
            93.5,
            99.3,
            103.1,
            101.3,
            103.2,
            108.1,
            112.8,
            120.3,
            128.3,
            null
        ],
        "p75": [
            122.7,
            125.0,
            126.5,
            128.4,
            130.8,
            133.4,
            140.4,
            152.3,
            160.1,
            null
        ],
        "p90": [
            153.2,
            151.3,
            157.1,
            158.0,
            159.9,
            166.3,
            169.2,
            180.7,
            188.6,
            null
        ]
    }
};

// --- Stepwise Marginal MAC Fan (P10/P50/P90 of step MAC between thresholds) ---
const MAC_STEPWISE_FAN = {
    "CAISO": {
        "p10": [
            null,
            78.6,
            66.6,
            21.9,
            91.5,
            81.0,
            134.7,
            160.3,
            236.4,
            null
        ],
        "p50": [
            null,
            182.8,
            110.7,
            496.9,
            133.9,
            295.4,
            268.7,
            343.1,
            329.7,
            null
        ],
        "p90": [
            null,
            1595.6,
            204.8,
            5283.8,
            235.7,
            1133.8,
            495.8,
            1057.1,
            492.8,
            null
        ]
    },
    "ERCOT": {
        "p10": [
            null,
            43.4,
            66.1,
            75.8,
            65.8,
            93.6,
            113.9,
            115.0,
            198.3,
            null
        ],
        "p50": [
            null,
            78.4,
            111.6,
            125.6,
            107.9,
            158.3,
            194.0,
            194.1,
            276.3,
            null
        ],
        "p90": [
            null,
            134.2,
            179.1,
            222.5,
            203.3,
            209.7,
            265.3,
            272.3,
            388.0,
            null
        ]
    },
    "PJM": {
        "p10": [
            null,
            51.6,
            49.2,
            86.3,
            83.1,
            144.8,
            149.3,
            149.3,
            233.4,
            null
        ],
        "p50": [
            null,
            110.3,
            94.9,
            144.9,
            171.3,
            216.0,
            451.3,
            277.7,
            454.6,
            null
        ],
        "p90": [
            null,
            193.4,
            235.0,
            247.4,
            339.4,
            537.9,
            897.8,
            416.5,
            864.6,
            null
        ]
    },
    "NYISO": {
        "p10": [
            null,
            43.7,
            71.2,
            98.7,
            142.7,
            250.1,
            178.4,
            204.1,
            148.8,
            null
        ],
        "p50": [
            null,
            132.3,
            152.6,
            146.0,
            202.0,
            304.5,
            408.8,
            450.1,
            431.1,
            null
        ],
        "p90": [
            null,
            268.7,
            265.3,
            267.3,
            866.5,
            771.9,
            461.9,
            659.1,
            833.7,
            null
        ]
    },
    "NEISO": {
        "p10": [
            null,
            78.5,
            51.5,
            42.4,
            65.9,
            269.9,
            98.8,
            310.8,
            389.5,
            null
        ],
        "p50": [
            null,
            199.4,
            122.0,
            128.9,
            183.7,
            345.3,
            476.6,
            550.7,
            705.8,
            null
        ],
        "p90": [
            null,
            305.9,
            424.0,
            488.9,
            372.0,
            557.0,
            737.9,
            1076.7,
            6395.3,
            null
        ]
    }
};

// --- Monotonic Envelope MAC (running max of Medium, smooths rebalancing) ---
const MAC_ENVELOPE_DATA = {
    "CAISO": {
        "raw": [
            92.6,
            94.6,
            103.4,
            103.9,
            106.2,
            110.2,
            112.8,
            115.2,
            117.9,
            null
        ],
        "envelope": [
            92.6,
            94.6,
            103.4,
            103.9,
            106.2,
            110.2,
            112.8,
            115.2,
            117.9,
            null
        ],
        "stepwise_envelope": [
            null,
            210.8,
            247.9,
            247.9,
            247.9,
            517.3,
            517.3,
            1053.6,
            1053.6,
            null
        ]
    },
    "ERCOT": {
        "raw": [
            23.5,
            25.7,
            30.8,
            35.4,
            36.5,
            39.6,
            42.9,
            45.9,
            50.3,
            null
        ],
        "envelope": [
            23.5,
            25.7,
            30.8,
            35.4,
            36.5,
            39.6,
            42.9,
            45.9,
            50.3,
            null
        ],
        "stepwise_envelope": [
            null,
            116.7,
            116.7,
            207.6,
            207.6,
            207.6,
            207.6,
            207.6,
            301.8,
            null
        ]
    },
    "PJM": {
        "raw": [
            67.2,
            76.9,
            88.8,
            91.3,
            93.1,
            94.6,
            98.3,
            99.8,
            99.8,
            null
        ],
        "envelope": [
            67.2,
            76.9,
            88.8,
            91.3,
            93.1,
            94.6,
            98.3,
            99.8,
            99.8,
            null
        ],
        "stepwise_envelope": [
            null,
            240.2,
            280.6,
            280.6,
            280.6,
            280.6,
            511.5,
            511.5,
            511.5,
            null
        ]
    },
    "NYISO": {
        "raw": [
            122.7,
            121.6,
            138.2,
            138.3,
            139.1,
            139.2,
            148.0,
            155.9,
            155.9,
            null
        ],
        "envelope": [
            122.7,
            122.7,
            138.2,
            138.3,
            139.1,
            139.2,
            148.0,
            155.9,
            155.9,
            null
        ],
        "stepwise_envelope": [
            null,
            88.8,
            257.2,
            257.2,
            257.2,
            257.2,
            336.5,
            336.5,
            336.5,
            null
        ]
    },
    "NEISO": {
        "raw": [
            105.5,
            111.2,
            115.9,
            115.1,
            117.6,
            122.3,
            128.3,
            157.3,
            169.2,
            null
        ],
        "envelope": [
            105.5,
            111.2,
            115.9,
            115.9,
            117.6,
            122.3,
            128.3,
            157.3,
            169.2,
            null
        ],
        "stepwise_envelope": [
            null,
            191.9,
            209.1,
            209.1,
            283.8,
            369.4,
            683.0,
            1333.0,
            1333.0,
            null
        ]
    }
};

// --- Path-Constrained Reference MAC (monotonic resource deployment) ---
const MAC_PATH_CONSTRAINED = {
    "CAISO": {
        "mac": [
            92.6,
            94.6,
            103.4,
            103.9,
            106.2,
            110.2,
            112.8,
            115.2,
            117.9,
            null
        ],
        "costs": [
            25.93,
            26.98,
            31.26,
            33.02,
            34.91,
            36.61,
            39.25,
            40.18,
            41.66,
            null
        ]
    },
    "ERCOT": {
        "mac": [
            23.5,
            25.7,
            30.8,
            35.4,
            36.5,
            39.6,
            42.9,
            45.9,
            50.3,
            null
        ],
        "costs": [
            9.91,
            11.13,
            14.1,
            16.68,
            17.4,
            19.62,
            21.8,
            23.8,
            26.52,
            null
        ]
    },
    "PJM": {
        "mac": [
            67.2,
            76.9,
            88.8,
            91.3,
            93.1,
            94.6,
            98.3,
            99.8,
            99.8,
            null
        ],
        "costs": [
            29.62,
            35.94,
            44.02,
            47.42,
            49.13,
            50.39,
            52.8,
            55.13,
            55.13,
            null
        ]
    },
    "NYISO": {
        "mac": [
            122.7,
            121.6,
            138.2,
            138.3,
            139.1,
            140.6,
            148.0,
            155.9,
            155.9,
            null
        ],
        "costs": [
            39.22,
            40.19,
            52.07,
            52.7,
            53.81,
            53.81,
            59.3,
            62.09,
            63.66,
            null
        ]
    },
    "NEISO": {
        "mac": [
            105.5,
            111.2,
            115.9,
            115.1,
            117.6,
            122.3,
            128.3,
            157.3,
            169.2,
            null
        ],
        "costs": [
            30.1,
            33.93,
            37.18,
            38.45,
            39.87,
            42.24,
            44.77,
            56.27,
            63.8,
            null
        ]
    }
};

// --- ANOVA: Fraction of MAC variance explained by each toggle group ---
// Values are eta-squared (0-1): the proportion of total MAC variance
// attributable to each sensitivity toggle. Higher = more influential.
const MAC_ANOVA = {
    "CAISO": {
        "Renewable Gen": 0.235,
        "Firm Gen": 0.463,
        "Storage": 0.011,
        "Fossil Fuel": 0.112,
        "Transmission": 0.031
    },
    "ERCOT": {
        "Renewable Gen": 0.482,
        "Firm Gen": 0.016,
        "Storage": 0.007,
        "Fossil Fuel": 0.389,
        "Transmission": 0.069
    },
    "PJM": {
        "Renewable Gen": 0.349,
        "Firm Gen": 0.043,
        "Storage": 0.004,
        "Fossil Fuel": 0.36,
        "Transmission": 0.061
    },
    "NYISO": {
        "Renewable Gen": 0.406,
        "Firm Gen": 0.214,
        "Storage": 0.003,
        "Fossil Fuel": 0.052,
        "Transmission": 0.107
    },
    "NEISO": {
        "Renewable Gen": 0.557,
        "Firm Gen": 0.073,
        "Storage": 0.006,
        "Fossil Fuel": 0.088,
        "Transmission": 0.126
    }
};

// --- Crossover Analysis: threshold where MAC exceeds benchmarks ---
const MAC_CROSSOVERS = {
    "CAISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 95
        }
    },
    "ERCOT": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": ">99",
            "median": ">99"
        }
    },
    "PJM": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 85,
            "median": ">99"
        }
    },
    "NYISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 75
        }
    },
    "NEISO": {
        "scc_epa_190": {
            "envelope": ">99",
            "median": ">99"
        },
        "scc_rennert_185": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_low_400": {
            "envelope": ">99",
            "median": ">99"
        },
        "dac_mid_600": {
            "envelope": ">99",
            "median": ">99"
        },
        "carbon_credits_15": {
            "envelope": 75,
            "median": 75
        },
        "eu_ets_88": {
            "envelope": 75,
            "median": 75
        }
    }
};

