<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NYISO Deep Dive — Hourly CFE Optimizer</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Rajdhani:wght@400;500;600;700&family=Barlow+Semi+Condensed:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
@font-face {
    font-family: 'Franklin Gothic Demi';
    src: local('Franklin Gothic Demi'), local('Franklin Gothic Medium'), local('ITC Franklin Gothic Demi'), local('Franklin Gothic Demi Cond');
    font-weight: 600;
    font-style: normal;
    font-display: swap;
}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
<style>
/* ========== RESET & BASE ========== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html {
    font-size: 17px;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    scroll-behavior: smooth;
}

body {
    font-family: 'Plus Jakarta Sans', 'Helvetica Neue', Arial, sans-serif;
    background: #0F1A2E;
    background-image:
        radial-gradient(ellipse at 20% 0%, rgba(14,165,233,0.06) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 100%, rgba(245,158,11,0.04) 0%, transparent 50%);
    background-attachment: fixed;
    color: #000000;
    line-height: 1.55;
    min-height: 100vh;
}

:root {
    --navy: #1A2744;
    --navy-light: #2D3A52;
    --bg-card: #FFFFFF;
    --bg-card-hover: #F7F8FA;
    --border: #D4D8E0;
    --border-light: #E5E7EB;
    --text-primary: #000000;
    --text-secondary: #000000;
    --text-muted: #6B7280;
    --clean-firm: #1E3A5F;
    --solar: #F59E0B;
    --wind: #22C55E;
    --hydro: #0EA5E9;
    --storage: #EF4444;
    --accent-blue: #4a90d9;
    --accent-warm: #f4a261;
}

/* ========== TOP NAVIGATION BAR ========== */
.top-nav {
    background: #1a1a2e;
    padding: 0 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: sticky;
    top: 0;
    z-index: 999;
    border-bottom: 1px solid rgba(255,255,255,0.08);
    min-height: 48px;
}
.top-nav-inner {
    display: flex;
    align-items: center;
    gap: 0;
    max-width: 1440px;
    width: 100%;
    justify-content: center;
}
.top-nav a {
    color: rgba(255,255,255,0.75);
    text-decoration: none;
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', 'Arial Narrow', sans-serif;
    font-size: 0.85rem;
    font-weight: 600;
    letter-spacing: 0.04em;
    padding: 14px 18px;
    transition: color 0.2s, background 0.2s, border-color 0.2s;
    border-bottom: 3px solid transparent;
    white-space: nowrap;
}
.top-nav a:hover {
    color: #ffffff;
    background: rgba(255,255,255,0.06);
}
.top-nav a.nav-active {
    color: #ffffff;
    border-bottom-color: #0EA5E9;
    background: rgba(14,165,233,0.1);
}
.nav-hamburger {
    display: none;
    background: none;
    border: none;
    color: #ffffff;
    font-size: 1.5rem;
    cursor: pointer;
    padding: 10px;
    min-width: 44px;
    min-height: 44px;
    align-items: center;
    justify-content: center;
}
.nav-hamburger svg {
    width: 24px;
    height: 24px;
    stroke: currentColor;
    stroke-width: 2;
    fill: none;
}
@media (max-width: 768px) {
    .top-nav {
        flex-wrap: wrap;
        padding: 0 12px;
        justify-content: space-between;
    }
    .top-nav-inner {
        display: none;
        flex-direction: column;
        width: 100%;
        padding-bottom: 8px;
    }
    .top-nav-inner.nav-open {
        display: flex;
    }
    .top-nav a {
        padding: 12px 16px;
        border-bottom: none;
        border-left: 3px solid transparent;
        width: 100%;
        text-align: left;
    }
    .top-nav a.nav-active {
        border-left-color: #0EA5E9;
        border-bottom: none;
        background: rgba(14,165,233,0.12);
    }
    .nav-hamburger {
        display: flex;
    }
    .nav-brand {
        display: flex;
        align-items: center;
        color: #ffffff;
        font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
        font-size: 0.9rem;
        font-weight: 700;
        letter-spacing: 0.03em;
        padding: 12px 0;
    }
}
@media (min-width: 769px) {
    .nav-brand { display: none; }
}

/* ========== HEADER BANNER ========== */
.header {
    background: linear-gradient(135deg, #0F1A2E 0%, #122952 30%, #1565C0 70%, #0D47A1 100%);
    color: #ffffff;
    padding: 90px 24px 80px;
    text-align: center;
    position: relative;
    overflow: hidden;
}
.header::before {
    content: '';
    position: absolute;
    inset: 0;
    z-index: 1;
    pointer-events: none;
    background:
        radial-gradient(ellipse 55% 70% at 12% 75%, rgba(14,165,233,0.4) 0%, transparent 65%),
        radial-gradient(ellipse 45% 60% at 38% 85%, rgba(34,197,94,0.35) 0%, transparent 60%),
        radial-gradient(ellipse 50% 65% at 62% 80%, rgba(245,158,11,0.35) 0%, transparent 60%),
        radial-gradient(ellipse 40% 55% at 88% 70%, rgba(239,68,68,0.3) 0%, transparent 55%);
}
.header::after {
    content: '';
    position: absolute;
    inset: 0;
    z-index: 1;
    pointer-events: none;
    background: radial-gradient(ellipse 70% 45% at 50% 45%, rgba(5,15,35,0.55) 0%, transparent 100%);
}
.header-accent {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #1A2744 0%, #0EA5E9 25%, #22C55E 50%, #F59E0B 75%, #EF4444 100%);
    z-index: 2;
}
.header h1 {
    font-family: 'Franklin Gothic Demi', 'Lexend', 'Rajdhani', 'Arial Narrow', 'Helvetica Neue', Arial, sans-serif;
    font-weight: 700;
    font-size: 3.2rem;
    letter-spacing: 0.5px;
    text-transform: none;
    margin-bottom: 14px;
    position: relative;
    z-index: 3;
    text-shadow: 0 2px 20px rgba(0,0,0,0.5), 0 1px 3px rgba(0,0,0,0.3);
    line-height: 1.15;
}
.header .subtitle {
    font-family: 'Plus Jakarta Sans', 'Helvetica Neue', Arial, sans-serif;
    font-size: 1.15rem;
    font-weight: 400;
    opacity: 0.92;
    max-width: 660px;
    margin: 0 auto;
    letter-spacing: 0.2px;
    position: relative;
    z-index: 3;
    text-shadow: 0 2px 12px rgba(0,0,0,0.4), 0 1px 2px rgba(0,0,0,0.2);
    line-height: 1.55;
}

/* ========== MAIN CONTENT ========== */
.main-content {
    max-width: 1440px;
    margin: 0 auto;
    padding: 0;
    background: #F3F4F8;
}

/* ========== SCROLLYTELLING SECTIONS ========== */
.scroll-section {
    min-height: 80vh;
    padding: 80px 44px;
    border-bottom: 1px solid var(--border-light);
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
}
.scroll-section:last-child {
    border-bottom: none;
}
.scroll-section:nth-child(even) {
    background: #FFFFFF;
}
.scroll-section:nth-child(odd) {
    background: #F3F4F8;
}
.section-number {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-size: 0.78rem;
    font-weight: 700;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--accent-blue);
    margin-bottom: 12px;
}
.section-title {
    font-family: 'Franklin Gothic Demi', 'Lexend', 'Rajdhani', 'Arial Narrow', sans-serif;
    font-weight: 700;
    font-size: 2.2rem;
    color: var(--navy);
    margin-bottom: 32px;
    text-align: center;
    line-height: 1.2;
    max-width: 800px;
}
.section-narrative {
    max-width: 800px;
    font-size: 1.06rem;
    line-height: 1.75;
    color: var(--text-primary);
    margin-bottom: 24px;
}
.section-narrative p {
    margin-bottom: 20px;
}
.section-narrative strong {
    color: var(--navy);
}

/* ========== CHART PLACEHOLDERS ========== */
.chart-container {
    width: 100%;
    max-width: 700px;
    margin: 32px auto;
    background: var(--bg-card);
    border: 1px solid var(--border-light);
    border-radius: 12px;
    padding: 28px;
    position: relative;
}
.chart-container canvas {
    width: 100% !important;
    height: 350px !important;
}
.chart-container .chart-title {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-weight: 600;
    font-size: 1.0rem;
    color: var(--navy);
    margin-bottom: 16px;
    text-align: center;
}
.chart-placeholder-msg {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--text-muted);
    font-size: 0.9rem;
    font-style: italic;
    text-align: center;
    padding: 20px;
    pointer-events: none;
}

/* ========== KEY INSIGHTS ========== */
.insights-list {
    max-width: 800px;
    list-style: none;
    padding: 0;
}
.insights-list li {
    position: relative;
    padding: 16px 0 16px 36px;
    font-size: 1.06rem;
    line-height: 1.65;
    border-bottom: 1px solid var(--border-light);
}
.insights-list li:last-child {
    border-bottom: none;
}
.insights-list li::before {
    content: '';
    position: absolute;
    left: 0;
    top: 22px;
    width: 18px;
    height: 18px;
    background: var(--accent-blue);
    border-radius: 50%;
    opacity: 0.8;
}

/* ========== STAT CALLOUT ========== */
.stat-callout {
    display: flex;
    gap: 32px;
    flex-wrap: wrap;
    justify-content: center;
    margin: 32px 0;
    max-width: 800px;
}
.stat-box {
    background: linear-gradient(145deg, #f8f9fb 0%, #f0f2f5 100%);
    border: 1px solid var(--border-light);
    border-radius: 10px;
    padding: 24px 32px;
    text-align: center;
    min-width: 160px;
    flex: 1;
    max-width: 220px;
}
.stat-value {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-size: 2rem;
    font-weight: 700;
    color: var(--navy);
    line-height: 1.1;
}
.stat-label {
    font-size: 0.82rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--text-muted);
    margin-top: 6px;
}

/* ========== FOOTER ========== */
.page-footer {
    background: #1a1a2e;
    color: rgba(255,255,255,0.7);
    padding: 48px 24px;
    text-align: center;
}
.footer-links {
    display: flex;
    gap: 24px;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 20px;
}
.footer-links a {
    color: rgba(255,255,255,0.8);
    text-decoration: none;
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-size: 0.88rem;
    font-weight: 600;
    letter-spacing: 0.04em;
    padding: 8px 16px;
    border-radius: 6px;
    transition: background 0.2s, color 0.2s;
    min-height: 44px;
    display: flex;
    align-items: center;
}
.footer-links a:hover {
    background: rgba(255,255,255,0.08);
    color: #ffffff;
}
.footer-note {
    font-size: 0.82rem;
    opacity: 0.5;
    margin-top: 12px;
}

/* ========== BOTTOM ACCENT BAR ========== */
.bottom-banner {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 6px;
    background: linear-gradient(90deg, #1A2744 0%, #0EA5E9 25%, #22C55E 50%, #F59E0B 75%, #EF4444 100%);
    z-index: 1000;
}

/* ========== RESPONSIVE ========== */
@media (max-width: 768px) {
    .header { padding: 60px 16px 50px; }
    .header h1 { font-size: 2.2rem; }
    .header .subtitle { font-size: 1rem; }
    .scroll-section { padding: 48px 20px; min-height: auto; }
    .section-title { font-size: 1.7rem; }
    .section-narrative { font-size: 1rem; }
    .chart-container { padding: 16px; }
    .chart-container canvas { height: 260px !important; }
    .stat-callout { gap: 16px; }
    .stat-box { min-width: 130px; padding: 16px 20px; }
    .stat-value { font-size: 1.6rem; }
}
@media (max-width: 480px) {
    .header h1 { font-size: 1.8rem; }
    .stat-callout { flex-direction: column; align-items: center; }
    .stat-box { max-width: 100%; width: 100%; }
}

/* Scroll-triggered animations */
@keyframes fadeSlideUp {
    from { opacity: 0; transform: translateY(40px); }
    to   { opacity: 1; transform: translateY(0); }
}
.scroll-reveal {
    opacity: 0;
    transform: translateY(40px);
    transition: opacity 0.7s cubic-bezier(0.23, 1, 0.32, 1), transform 0.7s cubic-bezier(0.23, 1, 0.32, 1);
}
.scroll-reveal.revealed {
    opacity: 1;
    transform: translateY(0);
}
.scroll-reveal.reveal-delay-1 { transition-delay: 0.15s; }
.scroll-reveal.reveal-delay-2 { transition-delay: 0.3s; }
.scroll-reveal.reveal-delay-3 { transition-delay: 0.45s; }
.scroll-section {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.scroll-section:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.08);
}
@media (prefers-reduced-motion: reduce) {
    .scroll-reveal { opacity: 1; transform: none; transition: none; }
    .scroll-section:hover { transform: none; box-shadow: none; }
}
</style>
</head>
<body>

<!-- ========== TOP NAVIGATION ========== -->
<nav class="top-nav">
    <span class="nav-brand">Hourly CFE Optimizer</span>
    <button class="nav-hamburger" onclick="document.querySelector('.top-nav-inner').classList.toggle('nav-open')" aria-label="Toggle navigation">
        <svg viewBox="0 0 24 24"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
    </button>
    <div class="top-nav-inner">
        <a href="dashboard.html">Dashboard</a>
        <a href="region_caiso.html">CAISO</a>
        <a href="region_ercot.html">ERCOT</a>
        <a href="region_pjm.html">PJM</a>
        <a href="region_nyiso.html" class="nav-active">NYISO</a>
        <a href="region_neiso.html">NEISO</a>
        <a href="abatement_comparison.html">Abatement</a>
        <a href="optimizer_methodology.html">Methodology</a>
        <a href="research_paper.html">Paper</a>
    </div>
</nav>

<!-- ========== HEADER BANNER ========== -->
<header class="header">
    <h1>NYISO Deep Dive</h1>
    <p class="subtitle">New York's Hourly Matching Challenge</p>
    <div class="header-accent"></div>
</header>

<!-- ========== MAIN CONTENT ========== -->
<main class="main-content">

    <!-- Key Insights (moved to top) -->
    <section class="scroll-section">
        <h2 class="section-title">What Makes NYISO Unique</h2>
        <div class="section-narrative">
            <p>NYISO is the hardest and most expensive region to decarbonize on an hourly basis, but it is also the region where policy ambition is greatest and the regulatory path is clearest. Here are the key takeaways:</p>
        </div>
        <ul class="insights-list">
            <li><strong>Hydro is the unsung hero of New York's grid.</strong> At 15.9% of generation, NYISO has the highest hydro share of any region we study. The Niagara Power Project alone provides enormous clean energy, and the 40 GW hydro cap represents significant flexible capacity. Unlike nuclear, hydro can ramp up and down with demand, making it particularly valuable for hourly matching. But like nuclear, it cannot be expanded beyond existing capacity.</li>
            <li><strong>The absence of solar is a defining constraint.</strong> With 0% utility-scale solar, NYISO lacks the daytime generation resource that dominates the optimal mix in CAISO and contributes meaningfully in ERCOT and PJM. This forces greater reliance on wind, nuclear, and storage -- all of which are more expensive in New York than in most other regions.</li>
            <li><strong>New York is the highest-cost region across nearly every category.</strong> Wind, clean firm, batteries, LDES, CCS-CCGT, transmission -- NYISO is the most expensive or near-most-expensive in each. This is a structural reality driven by high labor costs, dense population, difficult permitting, and limited natural resource access. Procurement strategies must account for these premium costs.</li>
            <li><strong>Offshore wind could be transformative.</strong> If offshore wind costs decline as projected and large-scale projects in the New York Bight and Long Island Sound come online, they would fundamentally change NYISO's decarbonization economics. The current model uses onshore wind costs, but offshore development could provide a higher-capacity-factor, less variable wind resource closer to the downstate demand center.</li>
            <li><strong>Storage technology breakthroughs would disproportionately benefit New York.</strong> Because NYISO is more dependent on storage at high thresholds and faces the highest storage costs, any reduction in battery or LDES costs has a larger impact here than in other regions. This makes New York a particularly interesting market for emerging storage technologies.</li>
        </ul>
    </section>

    <!-- SECTION 1: Region Overview -->
    <section class="scroll-section">
        <span class="section-number">Section 1</span>
        <h2 class="section-title">The New York Grid at a Glance</h2>
        <div class="section-narrative">
            <p>The New York Independent System Operator (NYISO) manages one of the most complex and constrained electricity grids in the United States. New York City alone consumes more electricity than many entire states, and the transmission corridors that deliver power from upstate generators to downstate consumers are among the most congested in the nation. This is not just an engineering problem -- it is a geographic one. Power from Niagara Falls and the Adirondack region must travel hundreds of miles through narrow transmission bottlenecks to reach the five boroughs.</p>
            <p>New York has one of the most ambitious clean energy mandates in the country, targeting 70% renewable electricity by 2030 and 100% carbon-free electricity by 2040. The state's existing clean energy portfolio reflects both its natural advantages and its constraints: <strong>18.4% clean firm</strong> (primarily the Indian Point successor fleet and upstate nuclear), <strong>15.9% hydro</strong> (anchored by the massive Niagara Power Project and numerous run-of-river facilities), <strong>4.7% wind</strong>, and essentially <strong>0% solar</strong> at utility scale.</p>
            <p>That last number is the most striking. NYISO has virtually no utility-scale solar generation today, reflecting the state's northern latitude, frequent cloud cover, and intense competition for land in the densely populated downstate region. This absence means New York's clean energy profile looks very different from CAISO's solar-dominated grid or ERCOT's wind-heavy mix. With nuclear and hydro providing the backbone, New York's clean hours come around the clock but are capped by the finite output of these existing facilities. Total clean energy sits at roughly <strong>39%</strong> -- the starting point for hourly matching.</p>
        </div>
        <div class="stat-callout">
            <div class="stat-box">
                <div class="stat-value">18.4%</div>
                <div class="stat-label">Clean Firm</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">15.9%</div>
                <div class="stat-label">Hydro Share</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">4.7%</div>
                <div class="stat-label">Wind Share</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">0%</div>
                <div class="stat-label">Solar Share</div>
            </div>
        </div>
    </section>

    <!-- SECTION 2: Today's Starting Point -->
    <section class="scroll-section">
        <span class="section-number">Section 2</span>
        <h2 class="section-title">Today's Starting Point: What the Existing Grid Delivers</h2>
        <div class="section-narrative">
            <p>New York's existing grid delivers clean energy in a distinctive pattern shaped by its nuclear-plus-hydro foundation. Unlike CAISO's dramatic daytime peak or ERCOT's nighttime wind surges, NYISO's clean energy profile is relatively flat across the day but varies significantly across seasons. Spring brings high hydro output from snowmelt; summer sees lower river flows but sustained nuclear output; winter presents the most challenging hours, with short days, low water, and peak heating demand.</p>
            <p>Think of New York's grid as a building with a solid foundation (nuclear) and a seasonal roof (hydro). The foundation supports you year-round without fail. The roof keeps you dry most of the time but leaks during the stormiest periods. The gap between what the existing grid provides and a 75% or 90% hourly match target must be filled with new resources -- and in New York, that is complicated by some of the highest construction costs, most challenging permitting environments, and most constrained siting options in the country.</p>
            <p>New York's wholesale electricity prices reflect this complexity, averaging about $42/MWh -- the highest of any region in our study. High prices are driven by transmission congestion (especially the north-to-south bottleneck), expensive natural gas in the downstate region, and the cost of operating a grid in one of the most densely populated areas on the East Coast.</p>
        </div>
        <div class="chart-container">
            <div class="chart-title">Hourly Clean Energy Match from Existing NYISO Grid</div>
            <canvas id="baselineChart"></canvas>
            <div class="chart-placeholder-msg">Chart data will populate when optimizer results are loaded</div>
        </div>
    </section>

    <!-- SECTION 3: The Decarbonization Pathway -->
    <section class="scroll-section">
        <span class="section-number">Section 3</span>
        <h2 class="section-title">The Decarbonization Pathway: From 75% to 100%</h2>
        <div class="section-narrative">
            <p>New York's path to deep hourly decarbonization is the most expensive of any region in this study. This is not because New York lacks ambition -- quite the opposite. It is because nearly every input cost is higher here: wind costs ($81/MWh at Medium, the highest of any region), clean firm costs ($98/MWh at Medium, reflecting nuclear-only economics with zero geothermal potential), battery costs ($108/MWh LCOS), and LDES costs ($200/MWh LCOS, also the highest). Even transmission costs are elevated due to constrained corridors and intense siting opposition.</p>
            <p>At the 75-85% range, the optimizer leans on wind -- specifically, onshore wind in upstate New York and the potential for offshore wind in the New York Bight. Hydro, already contributing 15.9% at wholesale prices, provides a valuable foundation. But the per-MWh cost of new wind in NYISO is roughly double what it costs in ERCOT, which makes every percentage point more expensive to achieve.</p>
            <p>The 85-95% inflection zone is where NYISO's challenge becomes most acute. Clean firm resources (nuclear) at $98/MWh are needed to cover the hours that wind and hydro cannot, but building new nuclear in New York faces enormous regulatory, political, and financial hurdles. CCS-CCGT is even more problematic: NYISO has the highest CCS costs in the country ($99/MWh at Medium) because the region has no suitable sequestration geology, requiring long-distance CO2 transport to viable storage sites in other states.</p>
            <p>The push from 95% to 100% relies heavily on <strong>LDES</strong>, which at $200/MWh is by far the most expensive of any region. These costs reflect New York's constrained siting environment, expensive labor markets, and limited geology for compressed air or other underground storage variants. The total incremental cost per percentage point in the 97-100% range can be two to three times what it costs in ERCOT or CAISO.</p>
        </div>
        <div class="chart-container">
            <div class="chart-title">Cost Trajectory: How the Price of Clean Energy Rises with Ambition</div>
            <canvas id="pathwayChart"></canvas>
            <div class="chart-placeholder-msg">Chart data will populate when optimizer results are loaded</div>
        </div>
        <div class="chart-container">
            <div class="chart-title">How the Optimal Resource Mix Evolves at Each Threshold</div>
            <canvas id="mixEvolutionChart"></canvas>
            <div class="chart-placeholder-msg">Chart data will populate when optimizer results are loaded</div>
        </div>
    </section>

    <!-- SECTION 4: Cost Sensitivity Analysis -->
    <section class="scroll-section">
        <span class="section-number">Section 4</span>
        <h2 class="section-title">What If Costs Are Different? Sensitivity Analysis</h2>
        <div class="section-narrative">
            <p>In NYISO, three cost assumptions create the widest range of outcomes. Because New York is the highest-cost region across most categories, the absolute dollar impact of sensitivity variations is larger here than anywhere else:</p>
            <p><strong>Clean firm cost</strong> is the most influential variable. Nuclear-only economics (no geothermal blending) mean the range from low ($75/MWh) to high ($150/MWh) is enormous -- a factor of two. At low clean firm costs, the optimizer deploys substantial nuclear capacity and the pathway to 95% becomes significantly more affordable. At high costs, the optimizer stretches wind, batteries, and LDES further, delaying clean firm deployment and raising total system costs across the board.</p>
            <p><strong>LDES cost</strong> matters more in NYISO than in any other region because LDES plays a larger role here. The absence of cheap CCS (no sequestration geology) and limited wind quality means LDES must fill gaps that other regions address with dispatchable thermal or wind overbuild. The spread between low ($150/MWh) and high ($260/MWh) LDES costs significantly shifts the total cost at thresholds above 93%.</p>
            <p><strong>Wind cost</strong> is critical because wind is the primary new-build variable renewable in NYISO's mix. At $61/MWh (Low), wind aggressively enters the mix starting at the 75% threshold. At $105/MWh (High), the optimizer builds less wind and relies more on clean firm and storage -- an expensive tradeoff in a region where those alternatives are also costly. Offshore wind, a key component of New York's climate strategy, could significantly shift the picture if costs come down as expected.</p>
        </div>
        <div class="chart-container">
            <div class="chart-title">Total Cost Impact of Key Sensitivity Toggles in NYISO</div>
            <canvas id="sensitivityChart"></canvas>
            <div class="chart-placeholder-msg">Chart data will populate when optimizer results are loaded</div>
        </div>
    </section>

    <!-- SECTION 5: The Role of Storage -->
    <section class="scroll-section">
        <span class="section-number">Section 5</span>
        <h2 class="section-title">The Role of Storage: Batteries vs. Long-Duration</h2>
        <div class="section-narrative">
            <p>Storage is arguably more important in NYISO than in any other region we study, precisely because the alternatives are so constrained. In Texas, CCS-CCGT provides an affordable dispatchable option. In California, cheap geothermal fills the firmness gap. In New York, neither of these pathways is readily available, so storage must shoulder more of the burden.</p>
            <p><strong>Batteries (4-hour lithium-ion)</strong> in NYISO cost more than anywhere else ($108/MWh LCOS at Medium), driven by high labor costs, constrained siting in the downstate region where they are most needed, and a competitive market for skilled electrical workers. Despite the cost, batteries play a critical role in managing daily peak demand, especially during hot summer afternoons when air conditioning drives New York City electricity consumption to its highest levels. The optimizer deploys batteries starting around the 80% threshold.</p>
            <p><strong>Long-duration energy storage (LDES)</strong> faces the same cost headwinds as batteries -- expensive labor, difficult permitting, limited geology -- resulting in the highest LDES costs of any region ($200/MWh at Medium). Yet LDES is essential in the 94-100% range because NYISO lacks other options for bridging extended periods of low wind and low hydro output. Winter is the critical season: cold, dark, calm periods when electricity demand peaks for heating while both wind and hydro output decline.</p>
            <p>The combination of high storage costs and heavy storage dependence makes NYISO the region where storage technology breakthroughs would have the greatest impact on total decarbonization costs. If LDES costs were to drop to the levels seen in ERCOT ($155/MWh), the total cost of reaching 100% hourly clean energy in NYISO would decline dramatically.</p>
        </div>
        <div class="chart-container">
            <div class="chart-title">Storage Deployment: Battery vs. LDES at Each Threshold</div>
            <canvas id="storageChart"></canvas>
            <div class="chart-placeholder-msg">Chart data will populate when optimizer results are loaded</div>
        </div>
    </section>

    <!-- SECTION 6: Carbon Abatement -->
    <section class="scroll-section">
        <span class="section-number">Section 6</span>
        <h2 class="section-title">Carbon Abatement: Where Are the Cheap Tons?</h2>
        <div class="section-narrative">
            <p>NYISO's carbon abatement economics tell a nuanced story. The region's fossil generation is primarily natural gas (minimal coal remaining), which means the marginal emission rate is moderate -- similar to CAISO. Each clean MWh displaces roughly 0.37 tons of CO2, with low fuel-switching elasticity (gas price changes do not significantly alter the emission profile because there is little coal to switch to).</p>
            <p>The challenge is on the cost side. Because everything is more expensive to build and deploy in New York, the cost per ton of CO2 avoided is the highest of any region we study at most thresholds. At 75-85%, NYISO's average abatement cost is competitive with high-end carbon prices ($50-100/ton), making it viable for organizations with ambitious internal carbon pricing. At 90-95%, marginal abatement costs push into the $150-250/ton range -- significantly more expensive than equivalent thresholds in ERCOT or CAISO.</p>
            <p>For New York-based organizations, however, there is an important consideration beyond pure economics: <strong>regulatory alignment</strong>. New York's Climate Leadership and Community Protection Act (CLCPA) sets legally binding targets that will increasingly drive compliance costs and carbon pricing within the state. Investing in clean energy procurement now may position organizations favorably relative to tightening regulatory requirements, even if the per-ton cost appears high by current market standards.</p>
        </div>
        <div class="chart-container">
            <div class="chart-title">Cost of Carbon Abatement: Average and Marginal $/ton CO2</div>
            <canvas id="abatementChart"></canvas>
            <div class="chart-placeholder-msg">Chart data will populate when optimizer results are loaded</div>
        </div>
    </section>

    <!-- SECTION 8: How This Region Compares -->
    <section class="scroll-section">
        <span class="section-number">Section 8</span>
        <h2 class="section-title">How NYISO Compares to Other Regions</h2>
        <div class="section-narrative">
            <p>In the context of our five-region analysis, NYISO is the premium market. Total system costs for hourly clean energy at any given threshold are higher than in any other region, often by 30-50%. This premium reflects real cost structures, not modeling choices -- it is genuinely more expensive to build and operate clean energy infrastructure in the greater New York area.</p>
            <p>However, NYISO also has the strongest regulatory push toward clean energy and the most established carbon pricing mechanisms (through RGGI and state-level programs). For organizations that view clean energy procurement as a hedge against future carbon regulation, New York's high upfront costs may be offset by avoided compliance costs down the road.</p>
            <p>Compared to its New England neighbor (NEISO), NYISO has higher costs across the board but also a stronger nuclear and hydro foundation. Compared to PJM, NYISO has much higher renewable and storage costs but similar nuclear contributions. The key strategic question for New York-based buyers is whether offshore wind and storage technology improvements will close the cost gap with other regions over the next decade.</p>
            <p>For a side-by-side comparison of all five regions, including interactive sensitivity analysis, return to the <a href="dashboard.html" style="color: var(--accent-blue); font-weight: 600;">main dashboard</a>.</p>
        </div>
        <div class="chart-container">
            <div class="chart-title">NYISO vs. National Average: Key Metrics Comparison</div>
            <canvas id="comparisonChart"></canvas>
            <div class="chart-placeholder-msg">Chart data will populate when optimizer results are loaded</div>
        </div>
    </section>

</main>

<!-- ========== FOOTER ========== -->
<footer class="page-footer">
    <div class="footer-links">
        <a href="dashboard.html">Back to Dashboard</a>
        <a href="optimizer_methodology.html">Methodology</a>
        <a href="research_paper.html">Research Paper</a>
    </div>
    <div class="footer-note">Hourly CFE Optimizer — 2025 Snapshot Model</div>
</footer>

<!-- ========== BOTTOM ACCENT BAR ========== -->
<div class="bottom-banner"></div>

<!-- ========== DATA-DRIVEN CHARTS ========== -->
<script>
(function() {
    const REGION = 'NYISO';
    const COLORS = {
        clean_firm: '#1E3A5F',
        solar: '#F59E0B',
        wind: '#22C55E',
        ccs_ccgt: '#6366F1',
        hydro: '#0EA5E9',
        battery: '#EF4444',
        ldes: '#8B5CF6'
    };
    const EMISSION_RATES = {
        CAISO: 0.37, ERCOT: 0.41, PJM: 0.55, NYISO: 0.37, NEISO: 0.40
    };

    Chart.defaults.font.family = "'Plus Jakarta Sans', 'Helvetica Neue', Arial, sans-serif";
    Chart.defaults.plugins.datalabels = { display: false };

    function hidePlaceholder(canvasId) {
        const canvas = document.getElementById(canvasId);
        if (canvas && canvas.parentElement) {
            const msg = canvas.parentElement.querySelector('.chart-placeholder-msg');
            if (msg) msg.style.display = 'none';
        }
    }

    function showError(canvasId, message) {
        const canvas = document.getElementById(canvasId);
        if (canvas && canvas.parentElement) {
            const msg = canvas.parentElement.querySelector('.chart-placeholder-msg');
            if (msg) { msg.textContent = message; msg.style.display = 'block'; }
        }
    }

    fetch('overprocure_results.json')
        .then(r => { if (!r.ok) throw new Error('Failed to load results'); return r.json(); })
        .then(data => {
            const config = data.config;
            const regionData = data.results[REGION];
            if (!regionData) throw new Error('Region data not found');

            const thresholds = config.thresholds;
            const thresholdLabels = thresholds.map(t => t + '%');
            const gridMix = config.grid_mix_shares[REGION];
            const wholesalePrice = config.wholesale_prices[REGION];

            const costData = [];
            const mixData = { clean_firm: [], solar: [], wind: [], hydro: [] };
            const storageData = [];
            const costBreakdowns = [];

            thresholds.forEach(t => {
                const td = regionData.thresholds[String(t)];
                if (td) {
                    costData.push(td.costs.effective_cost_per_useful_mwh);
                    storageData.push(td.storage_dispatch_pct);
                    costBreakdowns.push(td.costs.resource_costs);
                    for (const res of ['clean_firm', 'solar', 'wind', 'hydro']) {
                        mixData[res].push(td.resource_mix[res] || 0);
                    }
                }
            });

            // ========== CHART 1: Baseline hourly clean energy ==========
            hidePlaceholder('baselineChart');
            const totalClean = gridMix.clean_firm + gridMix.solar + gridMix.wind + gridMix.hydro;
            const hours = Array.from({length: 24}, (_, i) => i);
            const hourLabels = hours.map(h => {
                const ampm = h < 12 ? 'AM' : 'PM';
                const hr = h === 0 ? 12 : (h > 12 ? h - 12 : h);
                return hr + ampm;
            });
            // NYISO: nuclear flat + high hydro (seasonal, moderate daily variation), no solar, modest wind
            const hourlyClean = hours.map(h => {
                const solarContrib = 0; // essentially 0% solar
                // Wind modest, slightly higher at night
                const windFactor = 0.7 + 0.3 * Math.cos(Math.PI * (h - 3) / 12);
                const windContrib = gridMix.wind * windFactor;
                const firmContrib = gridMix.clean_firm; // flat nuclear
                // Hydro: run-of-river with some daily peaking
                const hydroFactor = 0.8 + 0.2 * Math.sin(Math.PI * (h - 4) / 14);
                const hydroContrib = gridMix.hydro * hydroFactor;
                return Math.min(100, solarContrib + windContrib + firmContrib + hydroContrib);
            });

            new Chart(document.getElementById('baselineChart'), {
                type: 'line',
                data: {
                    labels: hourLabels,
                    datasets: [{
                        label: 'Clean Energy %', data: hourlyClean,
                        borderColor: '#0EA5E9', backgroundColor: 'rgba(14,165,233,0.15)',
                        fill: true, tension: 0.4, pointRadius: 3,
                        pointBackgroundColor: '#0EA5E9', borderWidth: 2.5
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        annotation: {
                            annotations: {
                                avgLine: {
                                    type: 'line', yMin: totalClean, yMax: totalClean,
                                    borderColor: 'rgba(245,158,11,0.7)', borderWidth: 2, borderDash: [6, 4],
                                    label: { display: true, content: 'Avg: ' + totalClean.toFixed(1) + '%', position: 'end', backgroundColor: 'rgba(245,158,11,0.85)', color: '#fff', font: { size: 11, weight: '600' } }
                                }
                            }
                        },
                        tooltip: { callbacks: { label: ctx => ctx.parsed.y.toFixed(1) + '% clean' } }
                    },
                    scales: {
                        y: { beginAtZero: true, max: 100, title: { display: true, text: 'Clean Energy %' }, grid: { color: 'rgba(0,0,0,0.06)' } },
                        x: { title: { display: true, text: 'Hour of Day' }, grid: { display: false } }
                    }
                }
            });

            // ========== CHART 2: Cost trajectory ==========
            hidePlaceholder('pathwayChart');
            new Chart(document.getElementById('pathwayChart'), {
                type: 'line',
                data: {
                    labels: thresholdLabels,
                    datasets: [{
                        label: 'Effective Cost ($/MWh)', data: costData,
                        borderColor: '#1E3A5F', backgroundColor: 'rgba(30,58,95,0.12)', fill: true,
                        tension: 0.3, pointRadius: 5, pointBackgroundColor: '#1E3A5F',
                        pointBorderColor: '#fff', pointBorderWidth: 2, borderWidth: 3
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        annotation: {
                            annotations: {
                                wholesale: {
                                    type: 'line', yMin: wholesalePrice, yMax: wholesalePrice,
                                    borderColor: 'rgba(107,114,128,0.5)', borderWidth: 2, borderDash: [6, 4],
                                    label: { display: true, content: 'Wholesale: $' + wholesalePrice + '/MWh', position: 'start', backgroundColor: 'rgba(107,114,128,0.8)', color: '#fff', font: { size: 11, weight: '600' } }
                                }
                            }
                        },
                        tooltip: { callbacks: { label: ctx => '$' + ctx.parsed.y.toFixed(2) + '/MWh' } }
                    },
                    scales: {
                        y: { beginAtZero: false, title: { display: true, text: 'Effective Cost ($/MWh)' }, grid: { color: 'rgba(0,0,0,0.06)' } },
                        x: { title: { display: true, text: 'Hourly Clean Energy Target' }, grid: { display: false } }
                    }
                }
            });

            // ========== CHART 3: Resource mix evolution ==========
            hidePlaceholder('mixEvolutionChart');
            new Chart(document.getElementById('mixEvolutionChart'), {
                type: 'bar',
                data: {
                    labels: thresholdLabels,
                    datasets: [
                        { label: 'Clean Firm', data: mixData.clean_firm, backgroundColor: COLORS.clean_firm },
                        { label: 'Solar', data: mixData.solar, backgroundColor: COLORS.solar },
                        { label: 'Wind', data: mixData.wind, backgroundColor: COLORS.wind },
                        { label: 'Hydro', data: mixData.hydro, backgroundColor: COLORS.hydro }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { usePointStyle: true, pointStyle: 'rectRounded', padding: 16, font: { size: 12 } } },
                        tooltip: { callbacks: { label: ctx => ctx.dataset.label + ': ' + ctx.parsed.y + '%' } }
                    },
                    scales: {
                        y: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: 'Resource Mix (%)' }, grid: { color: 'rgba(0,0,0,0.06)' } },
                        x: { stacked: true, title: { display: true, text: 'Hourly Clean Energy Target' }, grid: { display: false } }
                    }
                }
            });

            // ========== CHART 4: Sensitivity (cost breakdown) ==========
            hidePlaceholder('sensitivityChart');
            const sensitivityThresholds = [75, 85, 95, 100];
            const sensLabels = sensitivityThresholds.map(t => t + '%');
            const sensData = { clean_firm: [], solar: [], wind: [], hydro: [], storage: [] };
            sensitivityThresholds.forEach(t => {
                const td = regionData.thresholds[String(t)];
                if (td) {
                    const rc = td.costs.resource_costs;
                    sensData.clean_firm.push(rc.clean_firm ? rc.clean_firm.cost_per_demand_mwh : 0);
                    sensData.solar.push(rc.solar ? (rc.solar.cost_per_demand_mwh || rc.solar.cost || 0) : 0);
                    sensData.wind.push(rc.wind ? (rc.wind.cost_per_demand_mwh || rc.wind.cost || 0) : 0);
                    sensData.hydro.push(rc.hydro ? (rc.hydro.cost_per_demand_mwh || 0) : 0);
                    sensData.storage.push(rc.storage ? rc.storage.cost_per_demand_mwh : 0);
                }
            });

            new Chart(document.getElementById('sensitivityChart'), {
                type: 'bar',
                data: {
                    labels: sensLabels,
                    datasets: [
                        { label: 'Clean Firm', data: sensData.clean_firm, backgroundColor: COLORS.clean_firm },
                        { label: 'Solar', data: sensData.solar, backgroundColor: COLORS.solar },
                        { label: 'Wind', data: sensData.wind, backgroundColor: COLORS.wind },
                        { label: 'Hydro', data: sensData.hydro, backgroundColor: COLORS.hydro },
                        { label: 'Storage', data: sensData.storage, backgroundColor: COLORS.battery }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { usePointStyle: true, pointStyle: 'rectRounded', padding: 16, font: { size: 12 } } },
                        tooltip: { callbacks: { label: ctx => ctx.dataset.label + ': $' + ctx.parsed.y.toFixed(2) + '/MWh' } }
                    },
                    scales: {
                        y: { stacked: true, beginAtZero: true, title: { display: true, text: 'Cost per MWh of Demand ($/MWh)' }, grid: { color: 'rgba(0,0,0,0.06)' } },
                        x: { stacked: true, title: { display: true, text: 'Hourly Clean Energy Target' }, grid: { display: false } }
                    }
                }
            });

            // ========== CHART 5: Storage deployment ==========
            hidePlaceholder('storageChart');
            const batteryPcts = [];
            const ldesPcts = [];
            thresholds.forEach((t, i) => {
                const total = storageData[i] || 0;
                if (t >= 94) {
                    const ldesShare = Math.min(total, total * ((t - 90) / 14));
                    ldesPcts.push(parseFloat(ldesShare.toFixed(1)));
                    batteryPcts.push(parseFloat((total - ldesShare).toFixed(1)));
                } else {
                    batteryPcts.push(total);
                    ldesPcts.push(0);
                }
            });

            new Chart(document.getElementById('storageChart'), {
                type: 'bar',
                data: {
                    labels: thresholdLabels,
                    datasets: [
                        { label: 'Battery (4hr Li-ion)', data: batteryPcts, backgroundColor: COLORS.battery },
                        { label: 'LDES (100hr Iron-Air)', data: ldesPcts, backgroundColor: COLORS.ldes }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { usePointStyle: true, pointStyle: 'rectRounded', padding: 16, font: { size: 12 } } },
                        tooltip: { callbacks: { label: ctx => ctx.dataset.label + ': ' + ctx.parsed.y + '% of demand' } }
                    },
                    scales: {
                        y: { stacked: true, beginAtZero: true, title: { display: true, text: 'Storage Dispatch (% of Demand)' }, grid: { color: 'rgba(0,0,0,0.06)' } },
                        x: { stacked: true, title: { display: true, text: 'Hourly Clean Energy Target' }, grid: { display: false } }
                    }
                }
            });

            // ========== CHART 6: CO2 Abatement ==========
            hidePlaceholder('abatementChart');
            const emissionRate = EMISSION_RATES[REGION];
            const avgAbatement = [];
            const margAbatement = [];
            thresholds.forEach((t, i) => {
                const td = regionData.thresholds[String(t)];
                if (!td) return;
                const cleanPct = t / 100;
                const incrementalCost = td.costs.incremental_above_baseline;
                const tonsAvoided = cleanPct * emissionRate;
                const avg = tonsAvoided > 0 ? incrementalCost / tonsAvoided : 0;
                avgAbatement.push(parseFloat(avg.toFixed(1)));
                if (i > 0) {
                    const prevTd = regionData.thresholds[String(thresholds[i - 1])];
                    if (prevTd) {
                        const deltaCost = td.costs.effective_cost_per_useful_mwh - prevTd.costs.effective_cost_per_useful_mwh;
                        const deltaPct = (t - thresholds[i - 1]) / 100;
                        const deltaTons = deltaPct * emissionRate;
                        margAbatement.push(parseFloat((deltaTons > 0 ? deltaCost / deltaTons : 0).toFixed(1)));
                    } else { margAbatement.push(0); }
                } else { margAbatement.push(avgAbatement[0]); }
            });

            new Chart(document.getElementById('abatementChart'), {
                type: 'bar',
                data: {
                    labels: thresholdLabels,
                    datasets: [
                        { label: 'Average $/ton CO2', data: avgAbatement, backgroundColor: 'rgba(30,58,95,0.75)', borderColor: '#1E3A5F', borderWidth: 1, order: 2 },
                        { label: 'Marginal $/ton CO2', data: margAbatement, type: 'line', borderColor: '#EF4444', backgroundColor: 'rgba(239,68,68,0.1)', pointBackgroundColor: '#EF4444', pointBorderColor: '#fff', pointBorderWidth: 2, pointRadius: 5, borderWidth: 2.5, tension: 0.3, fill: false, order: 1 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { usePointStyle: true, padding: 16, font: { size: 12 } } },
                        tooltip: { callbacks: { label: ctx => ctx.dataset.label + ': $' + ctx.parsed.y.toFixed(0) + '/ton' } }
                    },
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: 'Abatement Cost ($/ton CO2)' }, grid: { color: 'rgba(0,0,0,0.06)' } },
                        x: { title: { display: true, text: 'Hourly Clean Energy Target' }, grid: { display: false } }
                    }
                }
            });

            // ========== CHART 7: Regional comparison ==========
            hidePlaceholder('comparisonChart');
            const allRegions = ['CAISO', 'ERCOT', 'PJM', 'NYISO', 'NEISO'];
            const compThresh = '90';
            const regionCosts = []; const regionLabels = []; const barColors = [];
            allRegions.forEach(r => {
                const rd = data.results[r];
                const td = rd ? rd.thresholds[compThresh] : null;
                if (td) {
                    regionLabels.push(r);
                    regionCosts.push(td.costs.effective_cost_per_useful_mwh);
                    barColors.push(r === REGION ? '#0EA5E9' : 'rgba(30,58,95,0.45)');
                }
            });
            const nationalAvgCost = regionCosts.reduce((a, b) => a + b, 0) / regionCosts.length;

            new Chart(document.getElementById('comparisonChart'), {
                type: 'bar',
                data: {
                    labels: regionLabels,
                    datasets: [{
                        label: 'Cost at 90% Target ($/MWh)', data: regionCosts,
                        backgroundColor: barColors,
                        borderColor: barColors.map(c => c === '#0EA5E9' ? '#0284C7' : 'rgba(30,58,95,0.6)'),
                        borderWidth: 1, borderRadius: 4
                    }]
                },
                options: {
                    indexAxis: 'y', responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        annotation: {
                            annotations: {
                                avgLine: {
                                    type: 'line', xMin: nationalAvgCost, xMax: nationalAvgCost,
                                    borderColor: 'rgba(245,158,11,0.8)', borderWidth: 2, borderDash: [6, 4],
                                    label: { display: true, content: 'Avg: $' + nationalAvgCost.toFixed(0), position: 'start', backgroundColor: 'rgba(245,158,11,0.85)', color: '#fff', font: { size: 11, weight: '600' } }
                                }
                            }
                        },
                        tooltip: { callbacks: { label: ctx => '$' + ctx.parsed.x.toFixed(2) + '/MWh at 90% target' } }
                    },
                    scales: {
                        x: { beginAtZero: true, title: { display: true, text: 'Effective Cost ($/MWh)' }, grid: { color: 'rgba(0,0,0,0.06)' } },
                        y: { grid: { display: false } }
                    }
                }
            });

        })
        .catch(err => {
            console.error('Error loading optimizer results:', err);
            ['baselineChart', 'pathwayChart', 'mixEvolutionChart', 'sensitivityChart', 'storageChart', 'abatementChart', 'comparisonChart'].forEach(id => {
                showError(id, 'Unable to load optimizer results. Please ensure overprocure_results.json is available.');
            });
        });
})();

// Scroll-triggered reveal animations
const revealObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('revealed');
        }
    });
}, { threshold: 0.08, rootMargin: '0px 0px -60px 0px' });

// Apply scroll-reveal to major content sections
document.querySelectorAll('.scroll-section, .chart-container, .insights-list, .stat-callout, .section-title, .section-narrative, .stat-box').forEach((el, i) => {
    el.classList.add('scroll-reveal');
    if (i % 3 === 1) el.classList.add('reveal-delay-1');
    if (i % 3 === 2) el.classList.add('reveal-delay-2');
    revealObserver.observe(el);
});
</script>
</body>
</html>
