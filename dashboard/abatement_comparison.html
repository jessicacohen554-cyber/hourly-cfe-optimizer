<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Abatement Cost Comparison â€” Hourly CFE Optimizer</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Rajdhani:wght@400;500;600;700&family=Barlow+Semi+Condensed:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
@font-face {
    font-family: 'Franklin Gothic Demi';
    src: local('Franklin Gothic Demi'), local('Franklin Gothic Medium'), local('ITC Franklin Gothic Demi'), local('Franklin Gothic Demi Cond');
    font-weight: 600;
    font-style: normal;
    font-display: swap;
}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
<style>
/* ========== RESET & BASE ========== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html {
    font-size: 17px;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    scroll-behavior: smooth;
}

body {
    font-family: 'Plus Jakarta Sans', 'Helvetica Neue', Arial, sans-serif;
    background: #0F1A2E;
    background-image:
        radial-gradient(ellipse at 20% 0%, rgba(14,165,233,0.06) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 100%, rgba(245,158,11,0.04) 0%, transparent 50%);
    background-attachment: fixed;
    color: #000000;
    line-height: 1.55;
    min-height: 100vh;
}

:root {
    --navy: #1A2744;
    --navy-light: #2D3A52;
    --bg-card: #FFFFFF;
    --bg-card-hover: #F7F8FA;
    --border: #D4D8E0;
    --border-light: #E5E7EB;
    --text-primary: #000000;
    --text-secondary: #000000;
    --text-muted: #6B7280;
    --clean-firm: #1E3A5F;
    --solar: #F59E0B;
    --wind: #22C55E;
    --hydro: #0EA5E9;
    --storage: #EF4444;
    --accent-blue: #4a90d9;
    --accent-warm: #f4a261;
}

/* ========== TOP NAVIGATION BAR ========== */
.top-nav {
    background: #1a1a2e;
    padding: 0 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: sticky;
    top: 0;
    z-index: 999;
    border-bottom: 1px solid rgba(255,255,255,0.08);
    min-height: 48px;
}
.top-nav-inner {
    display: flex;
    align-items: center;
    gap: 0;
    max-width: 1440px;
    width: 100%;
    justify-content: center;
}
.top-nav a {
    color: rgba(255,255,255,0.75);
    text-decoration: none;
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', 'Arial Narrow', sans-serif;
    font-size: 0.85rem;
    font-weight: 600;
    letter-spacing: 0.04em;
    padding: 14px 18px;
    transition: color 0.2s, background 0.2s, border-color 0.2s;
    border-bottom: 3px solid transparent;
    white-space: nowrap;
}
.top-nav a:hover {
    color: #ffffff;
    background: rgba(255,255,255,0.06);
}
.top-nav a.nav-active {
    color: #ffffff;
    border-bottom-color: #0EA5E9;
    background: rgba(14,165,233,0.1);
}
.nav-hamburger {
    display: none;
    background: none;
    border: none;
    color: #ffffff;
    font-size: 1.5rem;
    cursor: pointer;
    padding: 10px;
    min-width: 44px;
    min-height: 44px;
    align-items: center;
    justify-content: center;
}
.nav-hamburger svg {
    width: 24px;
    height: 24px;
    stroke: currentColor;
    stroke-width: 2;
    fill: none;
}
@media (max-width: 768px) {
    .top-nav {
        flex-wrap: wrap;
        padding: 0 12px;
        justify-content: space-between;
    }
    .top-nav-inner {
        display: none;
        flex-direction: column;
        width: 100%;
        padding-bottom: 8px;
    }
    .top-nav-inner.nav-open {
        display: flex;
    }
    .top-nav a {
        padding: 12px 16px;
        border-bottom: none;
        border-left: 3px solid transparent;
        width: 100%;
        text-align: left;
    }
    .top-nav a.nav-active {
        border-left-color: #0EA5E9;
        border-bottom: none;
        background: rgba(14,165,233,0.12);
    }
    .nav-hamburger {
        display: flex;
    }
    .nav-brand {
        display: flex;
        align-items: center;
        color: #ffffff;
        font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
        font-size: 0.9rem;
        font-weight: 700;
        letter-spacing: 0.03em;
        padding: 12px 0;
    }
}
@media (min-width: 769px) {
    .nav-brand { display: none; }
}

/* ========== HEADER BANNER ========== */
.header {
    background: linear-gradient(135deg, #0F1A2E 0%, #122952 30%, #1565C0 70%, #0D47A1 100%);
    color: #ffffff;
    padding: 90px 24px 80px;
    text-align: center;
    position: relative;
    overflow: hidden;
}
.header::before {
    content: '';
    position: absolute;
    inset: 0;
    z-index: 1;
    pointer-events: none;
    background:
        radial-gradient(ellipse 55% 70% at 12% 75%, rgba(14,165,233,0.4) 0%, transparent 65%),
        radial-gradient(ellipse 45% 60% at 38% 85%, rgba(34,197,94,0.35) 0%, transparent 60%),
        radial-gradient(ellipse 50% 65% at 62% 80%, rgba(245,158,11,0.35) 0%, transparent 60%),
        radial-gradient(ellipse 40% 55% at 88% 70%, rgba(239,68,68,0.3) 0%, transparent 55%);
}
.header::after {
    content: '';
    position: absolute;
    inset: 0;
    z-index: 1;
    pointer-events: none;
    background: radial-gradient(ellipse 70% 45% at 50% 45%, rgba(5,15,35,0.55) 0%, transparent 100%);
}
.header-accent {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #1A2744 0%, #0EA5E9 25%, #22C55E 50%, #F59E0B 75%, #EF4444 100%);
    z-index: 2;
}
.header h1 {
    font-family: 'Franklin Gothic Demi', 'Lexend', 'Rajdhani', 'Arial Narrow', 'Helvetica Neue', Arial, sans-serif;
    font-weight: 700;
    font-size: 3.2rem;
    letter-spacing: 0.5px;
    text-transform: none;
    margin-bottom: 14px;
    position: relative;
    z-index: 3;
    text-shadow: 0 2px 20px rgba(0,0,0,0.5), 0 1px 3px rgba(0,0,0,0.3);
    line-height: 1.15;
}
.header .subtitle {
    font-family: 'Plus Jakarta Sans', 'Helvetica Neue', Arial, sans-serif;
    font-size: 1.15rem;
    font-weight: 400;
    opacity: 0.92;
    max-width: 660px;
    margin: 0 auto;
    letter-spacing: 0.2px;
    position: relative;
    z-index: 3;
    text-shadow: 0 2px 12px rgba(0,0,0,0.4), 0 1px 2px rgba(0,0,0,0.2);
    line-height: 1.55;
}

/* ========== MAIN CONTENT ========== */
.main-content {
    max-width: 1440px;
    margin: 0 auto;
    padding: 0;
    background: #F3F4F8;
}

/* ========== SCROLLYTELLING SECTIONS ========== */
.scroll-section {
    min-height: 80vh;
    padding: 80px 44px;
    border-bottom: 1px solid var(--border-light);
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
}
.scroll-section:last-child {
    border-bottom: none;
}
.scroll-section:nth-child(even) {
    background: #FFFFFF;
}
.scroll-section:nth-child(odd) {
    background: #F3F4F8;
}
.section-number {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-size: 0.78rem;
    font-weight: 700;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--accent-blue);
    margin-bottom: 12px;
}
.section-title {
    font-family: 'Franklin Gothic Demi', 'Lexend', 'Rajdhani', 'Arial Narrow', sans-serif;
    font-weight: 700;
    font-size: 2.2rem;
    color: var(--navy);
    margin-bottom: 32px;
    text-align: center;
    line-height: 1.2;
    max-width: 800px;
}
.section-narrative {
    max-width: 800px;
    font-size: 1.06rem;
    line-height: 1.75;
    color: var(--text-primary);
    margin-bottom: 24px;
}
.section-narrative p {
    margin-bottom: 20px;
}
.section-narrative strong {
    color: var(--navy);
}

/* ========== CHART CONTAINERS ========== */
.chart-container {
    width: 100%;
    max-width: 900px;
    margin: 32px auto;
    background: var(--bg-card);
    border: 1px solid var(--border-light);
    border-radius: 12px;
    padding: 28px;
    position: relative;
}
.chart-container canvas {
    width: 100% !important;
    height: 420px !important;
}
.chart-container .chart-title {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-weight: 600;
    font-size: 1.0rem;
    color: var(--navy);
    margin-bottom: 16px;
    text-align: center;
}
.chart-container-wide {
    max-width: 1100px;
}
.chart-container-wide canvas {
    height: 520px !important;
}

/* ========== SCENARIO TOGGLE ========== */
.scenario-toggle-bar {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin-bottom: 28px;
    flex-wrap: wrap;
}
.scenario-btn {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-size: 0.82rem;
    font-weight: 600;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    padding: 10px 22px;
    border-radius: 6px;
    border: 2px solid var(--border);
    background: #ffffff;
    color: var(--navy);
    cursor: pointer;
    transition: all 0.2s;
    min-height: 44px;
}
.scenario-btn:hover {
    border-color: var(--accent-blue);
    background: rgba(74,144,217,0.06);
}
.scenario-btn.active {
    border-color: var(--accent-blue);
    background: var(--accent-blue);
    color: #ffffff;
}

/* ========== LADDER VISUALIZATION ========== */
.ladder-container {
    width: 100%;
    max-width: 1100px;
    margin: 32px auto;
    background: var(--bg-card);
    border: 1px solid var(--border-light);
    border-radius: 12px;
    padding: 36px 28px;
    position: relative;
    overflow: hidden;
}
.ladder-title {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-weight: 600;
    font-size: 1.1rem;
    color: var(--navy);
    margin-bottom: 8px;
    text-align: center;
}
.ladder-subtitle {
    font-size: 0.88rem;
    color: var(--text-muted);
    text-align: center;
    margin-bottom: 28px;
}
.ladder-scale {
    display: flex;
    align-items: flex-end;
    position: relative;
    height: 480px;
    padding-left: 80px;
    padding-right: 20px;
    margin-bottom: 8px;
}
.ladder-y-axis {
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 75px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 4px 0;
}
.ladder-y-label {
    font-family: 'Barlow Semi Condensed', sans-serif;
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-muted);
    text-align: right;
    padding-right: 10px;
}
.ladder-bars {
    display: flex;
    align-items: flex-end;
    gap: 6px;
    flex: 1;
    height: 100%;
    position: relative;
}
.ladder-bar-group {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 100%;
    position: relative;
}
.ladder-bar {
    width: 100%;
    max-width: 84px;
    position: absolute;
    bottom: 0;
    border-radius: 4px 4px 0 0;
    transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1);
    cursor: pointer;
    opacity: 0.92;
}
.ladder-bar:hover {
    opacity: 1;
    transform: scaleX(1.04);
    box-shadow: 0 4px 20px rgba(0,0,0,0.15);
}
.ladder-bar-inner {
    position: absolute;
    bottom: 0;
    width: 100%;
    border-radius: 4px 4px 0 0;
    background: rgba(255,255,255,0.18);
}
.ladder-bar-label {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-size: 0.68rem;
    font-weight: 600;
    color: var(--text-primary);
    text-align: center;
    margin-top: 8px;
    line-height: 1.25;
    max-width: 90px;
    word-wrap: break-word;
}
.ladder-bar-cost {
    position: absolute;
    top: -22px;
    left: 50%;
    transform: translateX(-50%);
    font-family: 'Barlow Semi Condensed', sans-serif;
    font-size: 0.72rem;
    font-weight: 700;
    color: var(--navy);
    white-space: nowrap;
}
/* Grid threshold markers on the ladder */
.ladder-grid-markers {
    position: absolute;
    left: 80px;
    right: 20px;
    top: 0;
    bottom: 0;
    pointer-events: none;
}
.ladder-grid-line {
    position: absolute;
    left: 0;
    right: 0;
    height: 2px;
    border-top: 2px dashed;
    opacity: 0.7;
    display: flex;
    align-items: center;
}
.ladder-grid-tag {
    position: absolute;
    right: -5px;
    transform: translateX(100%);
    font-family: 'Barlow Semi Condensed', sans-serif;
    font-size: 0.7rem;
    font-weight: 700;
    padding: 2px 6px;
    border-radius: 3px;
    white-space: nowrap;
}

/* ========== TOOLTIP ========== */
.ladder-tooltip {
    display: none;
    position: fixed;
    z-index: 1000;
    background: rgba(26,39,68,0.96);
    color: #ffffff;
    padding: 14px 18px;
    border-radius: 8px;
    font-size: 0.85rem;
    line-height: 1.5;
    max-width: 280px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    pointer-events: none;
}
.ladder-tooltip .tt-title {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.92rem;
    margin-bottom: 6px;
}
.ladder-tooltip .tt-range {
    opacity: 0.85;
    font-size: 0.82rem;
}

/* ========== INFLECTION TABLE ========== */
.inflection-table-wrap {
    width: 100%;
    max-width: 960px;
    margin: 32px auto;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
}
.inflection-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.92rem;
    background: var(--bg-card);
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 2px 12px rgba(0,0,0,0.06);
}
.inflection-table thead {
    background: var(--navy);
    color: #ffffff;
}
.inflection-table th {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-weight: 600;
    font-size: 0.82rem;
    letter-spacing: 0.04em;
    text-transform: uppercase;
    padding: 14px 16px;
    text-align: center;
    white-space: nowrap;
}
.inflection-table th:first-child {
    text-align: left;
    padding-left: 20px;
}
.inflection-table td {
    padding: 14px 16px;
    text-align: center;
    border-bottom: 1px solid var(--border-light);
    font-weight: 500;
}
.inflection-table td:first-child {
    text-align: left;
    padding-left: 20px;
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-weight: 600;
    color: var(--navy);
}
.inflection-table tbody tr:hover {
    background: rgba(74,144,217,0.04);
}
.inflection-table tbody tr:last-child td {
    border-bottom: none;
}
/* Cell color coding */
.cell-green { background: rgba(76,175,80,0.12); color: #2e7d32; font-weight: 700; }
.cell-yellow { background: rgba(255,152,0,0.12); color: #e65100; font-weight: 700; }
.cell-orange { background: rgba(255,87,34,0.12); color: #bf360c; font-weight: 700; }
.cell-red { background: rgba(233,30,99,0.12); color: #880e4f; font-weight: 700; }

/* ========== CALLOUT BOX ========== */
.callout-box {
    max-width: 800px;
    margin: 28px auto;
    padding: 24px 28px;
    background: linear-gradient(135deg, rgba(74,144,217,0.08) 0%, rgba(14,165,233,0.06) 100%);
    border-left: 4px solid var(--accent-blue);
    border-radius: 0 10px 10px 0;
    font-size: 1rem;
    line-height: 1.7;
    color: var(--text-primary);
}
.callout-box strong {
    color: var(--navy);
}
.callout-box-warn {
    background: linear-gradient(135deg, rgba(255,152,0,0.08) 0%, rgba(255,87,34,0.06) 100%);
    border-left-color: #FF9800;
}

/* ========== KEY INSIGHTS ========== */
.insights-list {
    max-width: 800px;
    list-style: none;
    padding: 0;
}
.insights-list li {
    position: relative;
    padding: 16px 0 16px 36px;
    font-size: 1.06rem;
    line-height: 1.65;
    border-bottom: 1px solid var(--border-light);
}
.insights-list li:last-child {
    border-bottom: none;
}
.insights-list li::before {
    content: '';
    position: absolute;
    left: 0;
    top: 22px;
    width: 18px;
    height: 18px;
    background: var(--accent-blue);
    border-radius: 50%;
    opacity: 0.8;
}

/* ========== STAT CALLOUT ========== */
.stat-callout {
    display: flex;
    gap: 32px;
    flex-wrap: wrap;
    justify-content: center;
    margin: 32px 0;
    max-width: 900px;
}
.stat-box {
    background: linear-gradient(145deg, #f8f9fb 0%, #f0f2f5 100%);
    border: 1px solid var(--border-light);
    border-radius: 10px;
    padding: 24px 32px;
    text-align: center;
    min-width: 160px;
    flex: 1;
    max-width: 220px;
}
.stat-value {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-size: 2rem;
    font-weight: 700;
    color: var(--navy);
    line-height: 1.1;
}
.stat-label {
    font-size: 0.82rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--text-muted);
    margin-top: 6px;
}

/* ========== REGION CARDS (Section 6) ========== */
.region-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 24px;
    max-width: 1000px;
    margin: 32px auto;
    width: 100%;
}
.region-card {
    background: var(--bg-card);
    border: 1px solid var(--border-light);
    border-radius: 12px;
    padding: 28px;
    transition: box-shadow 0.2s, transform 0.2s;
}
.region-card:hover {
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    transform: translateY(-2px);
}
.region-card-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
}
.region-card-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    flex-shrink: 0;
}
.region-card-name {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-weight: 700;
    font-size: 1.2rem;
    color: var(--navy);
}
.region-card p {
    font-size: 0.96rem;
    line-height: 1.7;
    color: var(--text-primary);
    margin-bottom: 12px;
}
.region-card p:last-child {
    margin-bottom: 0;
}

/* ========== PORTFOLIO VIZ ========== */
.portfolio-legend {
    display: flex;
    gap: 24px;
    justify-content: center;
    flex-wrap: wrap;
    margin-top: 16px;
}
.portfolio-legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.84rem;
    font-weight: 500;
    color: var(--text-muted);
}
.portfolio-legend-swatch {
    width: 14px;
    height: 14px;
    border-radius: 3px;
}

/* ========== FOOTER ========== */
.page-footer {
    background: #1a1a2e;
    color: rgba(255,255,255,0.7);
    padding: 48px 24px;
    text-align: center;
}
.footer-links {
    display: flex;
    gap: 24px;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 20px;
}
.footer-links a {
    color: rgba(255,255,255,0.8);
    text-decoration: none;
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-size: 0.88rem;
    font-weight: 600;
    letter-spacing: 0.04em;
    padding: 8px 16px;
    border-radius: 6px;
    transition: background 0.2s, color 0.2s;
    min-height: 44px;
    display: flex;
    align-items: center;
}
.footer-links a:hover {
    background: rgba(255,255,255,0.08);
    color: #ffffff;
}
.footer-note {
    font-size: 0.82rem;
    opacity: 0.5;
    margin-top: 12px;
}

/* ========== BOTTOM ACCENT BAR ========== */
.bottom-banner {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 6px;
    background: linear-gradient(90deg, #1A2744 0%, #0EA5E9 25%, #22C55E 50%, #F59E0B 75%, #EF4444 100%);
    z-index: 1000;
}

/* ========== ANIMATED COUNTER ========== */
.counter-row {
    display: flex;
    gap: 48px;
    justify-content: center;
    flex-wrap: wrap;
    margin: 36px 0;
    max-width: 1000px;
}
.counter-item {
    text-align: center;
    min-width: 140px;
}
.counter-value {
    font-family: 'Franklin Gothic Demi', 'Barlow Semi Condensed', sans-serif;
    font-size: 2.8rem;
    font-weight: 700;
    line-height: 1.1;
    background: linear-gradient(135deg, var(--navy) 0%, var(--accent-blue) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}
.counter-unit {
    font-size: 0.82rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--text-muted);
    margin-top: 4px;
}

/* ========== RESPONSIVE ========== */
@media (max-width: 768px) {
    .header { padding: 60px 16px 50px; }
    .header h1 { font-size: 2.2rem; }
    .header .subtitle { font-size: 1rem; }
    .scroll-section { padding: 48px 20px; min-height: auto; }
    .section-title { font-size: 1.7rem; }
    .section-narrative { font-size: 1rem; }
    .chart-container { padding: 16px; }
    .chart-container canvas { height: 300px !important; }
    .chart-container-wide canvas { height: 350px !important; }
    .stat-callout { gap: 16px; }
    .stat-box { min-width: 130px; padding: 16px 20px; }
    .stat-value { font-size: 1.6rem; }
    .ladder-container { padding: 20px 12px; }
    .ladder-scale { height: 360px; padding-left: 60px; }
    .ladder-y-axis { width: 55px; }
    .ladder-y-label { font-size: 0.65rem; }
    .ladder-bar-label { font-size: 0.6rem; }
    .counter-value { font-size: 2.2rem; }
    .counter-row { gap: 24px; }
    .region-cards { grid-template-columns: 1fr; }
    .inflection-table { font-size: 0.82rem; }
    .inflection-table th, .inflection-table td { padding: 10px 8px; }
}
@media (max-width: 480px) {
    .header h1 { font-size: 1.8rem; }
    .stat-callout { flex-direction: column; align-items: center; }
    .stat-box { max-width: 100%; width: 100%; }
    .ladder-scale { height: 280px; padding-left: 50px; }
    .ladder-bar-label { font-size: 0.55rem; }
}
</style>
</head>
<body>

<!-- ========== TOP NAVIGATION ========== -->
<nav class="top-nav">
    <span class="nav-brand">Hourly CFE Optimizer</span>
    <button class="nav-hamburger" onclick="document.querySelector('.top-nav-inner').classList.toggle('nav-open')" aria-label="Toggle navigation">
        <svg viewBox="0 0 24 24"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
    </button>
    <div class="top-nav-inner">
        <a href="dashboard.html">Dashboard</a>
        <a href="region_caiso.html">CAISO</a>
        <a href="region_ercot.html">ERCOT</a>
        <a href="region_pjm.html">PJM</a>
        <a href="region_nyiso.html">NYISO</a>
        <a href="region_neiso.html">NEISO</a>
        <a href="abatement_comparison.html" class="nav-active">Abatement</a>
        <a href="optimizer_methodology.html">Methodology</a>
        <a href="research_paper.html">Paper</a>
    </div>
</nav>

<!-- ========== HEADER BANNER ========== -->
<header class="header">
    <h1>Abatement Cost Comparison</h1>
    <p class="subtitle">When Grid Decarbonization Meets Its Alternatives</p>
    <div class="header-accent"></div>
</header>

<!-- ========== MAIN CONTENT ========== -->
<main class="main-content">

    <!-- ================================================================ -->
    <!-- SECTION 1: THE BIG PICTURE                                       -->
    <!-- ================================================================ -->
    <section class="scroll-section">
        <span class="section-number">Section 1</span>
        <h2 class="section-title">The Marginal Abatement Cost Curve: Why the Last Ton Is the Most Expensive</h2>
        <div class="section-narrative">
            <p>Imagine squeezing water from a towel. The first wrings are easy -- water pours out almost effortlessly. But as the towel gets drier, each twist extracts less and less. The final drops require extraordinary force for a vanishingly small return. Grid decarbonization works the same way.</p>

            <p>The concept behind this page is the <strong>marginal abatement cost curve</strong> -- a tool economists have used for decades to rank climate interventions by cost-effectiveness. The idea is simple: line up every way to reduce or remove a ton of CO2, from cheapest to most expensive. At the left side of the curve sit the low-hanging fruit: energy efficiency upgrades that often pay for themselves, or building solar in sunny regions where it undercuts fossil fuels on price alone. At the right side sit the heroic measures: capturing carbon directly from the atmosphere at $400-600 per ton, or squeezing the last 2-3% of grid decarbonization by deploying long-duration storage to cover multi-day winter doldrums.</p>

            <p>This page asks a question that procurement professionals rarely confront directly: <strong>at what point does pushing grid decarbonization further stop being the smartest use of a climate dollar?</strong> When does a dollar spent on sustainable aviation fuel, industrial efficiency, or even direct air capture deliver more climate impact than chasing the last percentage point of hourly clean energy?</p>

            <p>The answer, as we will see, depends on where you are, what assumptions you make about future costs, and how you value different forms of carbon reduction. But the general pattern is striking and consistent: there is a point -- typically between 92% and 98% hourly clean energy -- where the grid decarbonization curve crosses into territory where alternatives become competitive or even cheaper.</p>
        </div>

        <div class="counter-row">
            <div class="counter-item">
                <div class="counter-value" data-target="10" data-suffix="x">10x</div>
                <div class="counter-unit">Cost increase<br>from 85% to 100%</div>
            </div>
            <div class="counter-item">
                <div class="counter-value" data-target="95" data-suffix="%">95%</div>
                <div class="counter-unit">Where costs<br>typically spike</div>
            </div>
            <div class="counter-item">
                <div class="counter-value" data-target="5" data-suffix="">5</div>
                <div class="counter-unit">Regions with<br>different stories</div>
            </div>
        </div>

        <div class="callout-box">
            <strong>What is a marginal abatement cost?</strong> It measures the cost of eliminating one additional ton of CO2. If moving from 90% to 91% hourly clean energy costs $2 million more and avoids 10,000 additional tons, the marginal abatement cost is $200/ton. This number tends to rise steeply at higher grid decarbonization targets, because the remaining "dirty" hours are the hardest and most expensive to replace.
        </div>
    </section>

    <!-- ================================================================ -->
    <!-- SECTION 2: GRID DECARBONIZATION COST CURVE                       -->
    <!-- ================================================================ -->
    <section class="scroll-section">
        <span class="section-number">Section 2</span>
        <h2 class="section-title">The Grid Decarbonization Cost Curve: Five Regions, One Pattern</h2>
        <div class="section-narrative">
            <p>Every region tells the same story, but at different volumes. Below, five regional marginal abatement cost curves are overlaid on a single chart. The x-axis shows the hourly clean energy target (from 75% to 100%), and the y-axis shows what each additional ton of CO2 avoidance costs at that threshold.</p>

            <p>Notice the <strong>hockey stick shape</strong>. From 75% to roughly 90%, marginal costs are moderate -- typically $30 to $120 per ton depending on the region. This is the zone where solar, wind, and batteries are doing the heavy lifting, and each incremental percentage point adds cost at a roughly linear rate. But somewhere between 90% and 95%, the curve bends sharply upward. This is the inflection zone, where the easy hours are fully matched and the remaining gaps require increasingly expensive resources: long-duration storage, clean firm generation running at low utilization, or CCS-CCGT plants backstopping multi-day lulls.</p>

            <p>The divergence between regions tells a powerful story. ERCOT (Texas), blessed with abundant, cheap wind and favorable CCS geology, keeps costs below $200/ton through roughly 97%. NYISO (New York), constrained by expensive siting, limited renewable resources, and no sequestration geology, crosses $200/ton by 93%. Understanding your region's curve is the first step toward setting a rational decarbonization target.</p>
        </div>

        <div class="scenario-toggle-bar">
            <button class="scenario-btn active" onclick="setScenario('medium', this)">Medium Costs</button>
            <button class="scenario-btn" onclick="setScenario('low', this)">Low Costs</button>
            <button class="scenario-btn" onclick="setScenario('high', this)">High Costs</button>
        </div>

        <div class="chart-container chart-container-wide">
            <div class="chart-title">Marginal Cost of Grid Decarbonization by Region ($/ton CO2 avoided)</div>
            <canvas id="macCurveChart"></canvas>
        </div>

        <div class="callout-box">
            <strong>Why the hockey stick?</strong> At lower targets, you are matching hours when the wind is blowing or the sun is shining -- cheap power for cheap displacement. As targets rise, the remaining unmatched hours are the worst: winter nights, cloudy windless weeks, peak demand evenings. Filling these gaps requires overbuilding generation, deploying expensive storage, or running clean firm plants that sit idle most of the year. Low utilization drives high per-MWh (and per-ton) costs.
        </div>
    </section>

    <!-- ================================================================ -->
    <!-- SECTION 3: THE COMPARISON LANDSCAPE                              -->
    <!-- ================================================================ -->
    <section class="scroll-section">
        <span class="section-number">Section 3</span>
        <h2 class="section-title">The Abatement Ladder: Where Grid Costs Meet the Alternatives</h2>
        <div class="section-narrative">
            <p>Now we place grid decarbonization costs in context. The visualization below is a modern take on the <strong>Liebreich ladder</strong> -- ranking carbon abatement and removal options from cheapest to most expensive. Each bar represents a different mitigation or removal pathway, with the bar height spanning from its low-cost estimate to its high-cost estimate. The darker core band shows the mid-range cost.</p>

            <p>Overlaid on this landscape are dashed horizontal lines showing where each region's grid decarbonization costs land at key thresholds. As you read from left to right, you are climbing the cost ladder. The critical insight: <strong>at lower grid targets (85-90%), grid decarbonization is among the cheapest abatement options available. At higher targets (97-100%), it rivals or exceeds the cost of direct air capture.</strong></p>

            <p>Hover over any bar to see its full cost range, source, and where regional grid costs intersect it.</p>
        </div>

        <div class="ladder-container">
            <div class="ladder-title">The Abatement Cost Ladder: Grid Decarbonization vs. Alternatives</div>
            <div class="ladder-subtitle">Bars show low-to-high cost range for each option. Dashed lines mark regional grid decarbonization costs at 90%, 95%, and 99% targets.</div>

            <div class="ladder-scale" id="ladderScale">
                <div class="ladder-y-axis" id="ladderYAxis"></div>
                <div class="ladder-bars" id="ladderBars"></div>
                <div class="ladder-grid-markers" id="ladderMarkers"></div>
            </div>
            <div id="ladderLabels" style="display:flex; gap:6px; padding-left:80px; padding-right:20px;"></div>
        </div>
        <div class="ladder-tooltip" id="ladderTooltip"></div>

        <div class="chart-container chart-container-wide" style="margin-top:24px;">
            <div class="chart-title">Alternative View: Cost Band Comparison with Grid Crossover Points</div>
            <canvas id="bandChart"></canvas>
        </div>

        <div class="callout-box callout-box-warn">
            <strong>A critical nuance:</strong> These comparisons are not perfectly apples-to-apples. Grid decarbonization avoids emissions in real-time with high additionality. Carbon credits vary enormously in quality. DAC permanently removes CO2 but at very high cost. SAF reduces hard-to-abate aviation emissions that have no grid alternative. Each option has a different role in a net-zero portfolio -- the question is not "which is best" but "what is the right mix at the right price point."
        </div>
    </section>

    <!-- ================================================================ -->
    <!-- SECTION 4: INFLECTION POINT ANALYSIS                             -->
    <!-- ================================================================ -->
    <section class="scroll-section">
        <span class="section-number">Section 4</span>
        <h2 class="section-title">Inflection Points: Where Grid Costs Exceed Key Benchmarks</h2>
        <div class="section-narrative">
            <p>For every region, there is a threshold beyond which pushing grid decarbonization further costs more per ton than each major benchmark. The table below identifies those crossover points. Read it as: "In ERCOT, grid decarbonization costs exceed the EU carbon price at 96% hourly clean energy." This does not mean ERCOT should stop at 96% -- it means that beyond 96%, the procurement professional should be actively evaluating whether alternative abatement pathways deliver better value for the marginal dollar.</p>

            <p>The color coding tells the story at a glance: <span style="color:#2e7d32; font-weight:700;">green cells</span> indicate the region stays cost-competitive deep into high targets (above 96%). <span style="color:#e65100; font-weight:700;">Orange cells</span> mark moderate inflection points (92-95%). <span style="color:#880e4f; font-weight:700;">Red cells</span> flag regions where grid costs exceed the benchmark relatively early (below 92%).</p>
        </div>

        <div class="inflection-table-wrap">
            <table class="inflection-table" id="inflectionTable">
                <thead>
                    <tr>
                        <th>Region</th>
                        <th>Social Cost of Carbon<br>($51/ton EPA)</th>
                        <th>EU ETS Price<br>($80/ton)</th>
                        <th>SAF Range<br>($150-400/ton)</th>
                        <th>DAC Range<br>($250-600/ton)</th>
                        <th>Exceeds $500/ton<br>(Extreme cost)</th>
                    </tr>
                </thead>
                <tbody id="inflectionBody">
                </tbody>
            </table>
        </div>

        <div class="callout-box">
            <strong>Reading the table:</strong> ERCOT's cheap wind keeps grid decarbonization competitive up to 97% before exceeding the DAC cost floor. NYISO, constrained by expensive siting and limited renewables, crosses the DAC threshold at just 93%. PJM's large coal fleet means each clean MWh displaces more carbon, keeping per-ton costs lower than regions with already-cleaner grids. These differences are not marginal -- they can mean a 5-percentage-point gap in where the rational crossover occurs.
        </div>

        <div class="stat-callout">
            <div class="stat-box">
                <div class="stat-value">97%</div>
                <div class="stat-label">ERCOT stays<br>below DAC cost</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">93%</div>
                <div class="stat-label">NYISO crosses<br>DAC threshold</div>
            </div>
            <div class="stat-box">
                <div class="stat-value">4%</div>
                <div class="stat-label">Gap between<br>best & worst</div>
            </div>
        </div>
    </section>

    <!-- ================================================================ -->
    <!-- SECTION 5: NET-ZERO PORTFOLIO QUESTION                           -->
    <!-- ================================================================ -->
    <section class="scroll-section">
        <span class="section-number">Section 5</span>
        <h2 class="section-title">The Net-Zero Portfolio Question: When to Diversify Beyond the Grid</h2>
        <div class="section-narrative">
            <p>No organization achieves net-zero through a single strategy. The question is not whether to diversify, but when. The chart below illustrates a conceptual framework: for each dollar spent on decarbonization, what is the optimal allocation between pushing grid clean energy higher versus investing in alternative abatement and removal?</p>

            <p>At lower grid targets (75-90%), the answer is clear: <strong>grid decarbonization dominates.</strong> Each dollar achieves more CO2 reduction per dollar on the grid than anywhere else. Solar and wind are cheap, batteries are proven, and the marginal abatement cost is well below the cost of alternatives.</p>

            <p>But as grid targets rise past the 90-95% inflection, the calculus shifts. The chart shows a conceptual "optimal portfolio" where the share allocated to grid decarbonization declines and the share going to alternatives (DAC, offsets, SAF, industrial efficiency) rises. The crossover point varies by region -- earlier for NYISO, later for ERCOT -- but the principle is universal.</p>

            <p><strong>This is the 90/10 insight:</strong> For most regions, pushing grid clean energy from the current baseline to roughly 90-95% is the most cost-effective thing you can do. The remaining 5-10% may be better addressed through a diversified portfolio of grid hardening, carbon removal, and cross-sector investment.</p>
        </div>

        <div class="chart-container chart-container-wide">
            <div class="chart-title">Conceptual Optimal Portfolio: Grid Decarbonization vs. Alternative Investments</div>
            <canvas id="portfolioChart"></canvas>
            <div class="portfolio-legend">
                <div class="portfolio-legend-item">
                    <div class="portfolio-legend-swatch" style="background: #4a90d9;"></div>
                    Grid Decarbonization
                </div>
                <div class="portfolio-legend-item">
                    <div class="portfolio-legend-swatch" style="background: #22C55E;"></div>
                    Energy Efficiency & Electrification
                </div>
                <div class="portfolio-legend-item">
                    <div class="portfolio-legend-swatch" style="background: #FF9800;"></div>
                    Cross-Sector (SAF, Green H2)
                </div>
                <div class="portfolio-legend-item">
                    <div class="portfolio-legend-swatch" style="background: #E91E63;"></div>
                    Carbon Removal (DAC, BECCS)
                </div>
            </div>
        </div>

        <div class="callout-box">
            <strong>The portfolio mindset:</strong> A company targeting net-zero might optimally push its grid procurement to 92% hourly clean energy (where grid costs are $120/ton), then allocate the next tranche of budget to high-quality carbon removal at $250/ton for the remaining 8%. Total cost? Substantially less than pushing the grid to 100% where marginal costs might reach $800/ton. The 8% gap is filled by removal credits that permanently sequester CO2 -- achieving the same climate outcome at a fraction of the cost.
        </div>
    </section>

    <!-- ================================================================ -->
    <!-- SECTION 6: REGIONAL DEEP-DIVES ON CROSSOVER POINTS               -->
    <!-- ================================================================ -->
    <section class="scroll-section">
        <span class="section-number">Section 6</span>
        <h2 class="section-title">Regional Crossover Stories: Five Grids, Five Strategies</h2>
        <div class="section-narrative">
            <p>Each region's grid has a unique personality that shapes when and how the crossover to alternative abatement makes sense. Below, we explore the distinct dynamics that drive each region's cost curve and where the rational diversification point lies.</p>
        </div>

        <div class="region-cards">
            <!-- CAISO -->
            <div class="region-card">
                <div class="region-card-header">
                    <div class="region-card-dot" style="background: #F59E0B;"></div>
                    <div class="region-card-name">CAISO (California)</div>
                </div>
                <p>California's solar abundance makes the first 85-90% of grid decarbonization remarkably affordable. The state's existing 22% solar fleet, combined with the nation's lowest clean firm costs (geothermal from the Salton Sea and Imperial Valley at $78/MWh), keeps marginal abatement costs below $80/ton through 90%.</p>
                <p>But solar saturation is CAISO's Achilles heel. Every additional percentage point above 93% requires either massive battery overbuilding to shift solar into evening and overnight hours, or expensive LDES to bridge multi-day cloudy stretches. Costs cross the $250/ton DAC floor at roughly 95%, earlier than ERCOT but later than the eastern ISOs.</p>
                <p><strong>Strategy:</strong> Push grid to 93-95%, then evaluate a DAC/BECCS portfolio for the residual gap. California's emerging DAC industry (Heirloom, CarbonCapture Inc.) could provide local removal credits at declining costs.</p>
            </div>

            <!-- ERCOT -->
            <div class="region-card">
                <div class="region-card-header">
                    <div class="region-card-dot" style="background: #22C55E;"></div>
                    <div class="region-card-name">ERCOT (Texas)</div>
                </div>
                <p>Texas is the cost leader in grid decarbonization, and it is not particularly close. ERCOT's marginal abatement curve stays below $100/ton through 93% and below $200/ton through 96%. The reasons: the nation's cheapest wind ($40/MWh at Medium), favorable CCS-CCGT geology along the Gulf Coast ($71/MWh), and the lowest storage costs in the country due to fast permitting and low labor costs.</p>
                <p>ERCOT also benefits from a unique CO2 intensity story. Its remaining fossil fleet is almost entirely natural gas (coal is largely retired), which means each displaced MWh avoids moderate emissions -- neither as high as PJM's coal-heavy grid nor as low as CAISO's already-clean fleet.</p>
                <p><strong>Strategy:</strong> ERCOT is the one region where pushing to 97% grid clean energy may be cheaper than most alternatives. Gulf Coast DAC potential (1PointFive, Carbon Engineering) could handle the last 3% at declining costs as the industry scales.</p>
            </div>

            <!-- PJM -->
            <div class="region-card">
                <div class="region-card-header">
                    <div class="region-card-dot" style="background: #4a90d9;"></div>
                    <div class="region-card-name">PJM (Mid-Atlantic)</div>
                </div>
                <p>PJM presents a paradox: its grid is one of the dirtiest (substantial remaining coal fleet), which means each clean MWh displaces more carbon than in any other region. This drives down the per-ton cost of abatement even when per-MWh procurement costs are higher. PJM's marginal abatement cost stays below the EU ETS price through 94%.</p>
                <p>The coal-switching dynamic creates a non-linear curve. As natural gas prices rise, coal generation increases, pushing up emission rates -- which paradoxically makes clean energy procurement more cost-effective per ton. Under high gas price scenarios, PJM's grid decarbonization remains competitive against DAC through 96%.</p>
                <p><strong>Strategy:</strong> PJM's high carbon intensity makes grid investment highly efficient per ton. Push to 94-96%, then complement with industrial electrification credits in the region's heavy manufacturing corridor.</p>
            </div>

            <!-- NYISO -->
            <div class="region-card">
                <div class="region-card-header">
                    <div class="region-card-dot" style="background: #E91E63;"></div>
                    <div class="region-card-name">NYISO (New York)</div>
                </div>
                <p>New York has the most expensive path to high grid decarbonization. Constrained siting (dense population, environmental review requirements), the highest wholesale prices in the study ($42/MWh average), and no CCS sequestration geology drive costs up faster than any other region. NYISO crosses the $250/ton DAC floor at just 93%.</p>
                <p>The silver lining is NYISO's existing nuclear and hydro fleet. With 18% nuclear and 16% hydro already on the grid, the starting point is strong -- roughly 39% clean energy before adding any new resources. But expanding beyond this baseload advantage requires expensive wind (largely offshore) and clean firm resources at the highest costs in the country ($98/MWh nuclear at Medium).</p>
                <p><strong>Strategy:</strong> The 90/10 rule applies most forcefully here. Push grid to 90-92%, then invest heavily in high-quality carbon removal and cross-sector abatement. New York's climate leadership position could pioneer "portfolio decarbonization" as a procurement model.</p>
            </div>

            <!-- NEISO -->
            <div class="region-card">
                <div class="region-card-header">
                    <div class="region-card-dot" style="background: #9C27B0;"></div>
                    <div class="region-card-name">NEISO (New England)</div>
                </div>
                <p>New England occupies a middle position, but with unusually wide uncertainty bands. The region's decarbonization future hinges heavily on offshore wind, which offers enormous potential but at costs that remain uncertain ($73/MWh at Medium, but with high-scenario estimates reaching $95/MWh after the recent PPA renegotiations).</p>
                <p>NEISO's existing nuclear fleet (24% of generation) provides a strong foundation, and its moderate hydro resources (4.4%) add seasonal flexibility. But limited solar potential (New England's latitude and cloud cover) and expensive onshore siting mean the region leans heavily on offshore wind and clean firm for incremental clean energy.</p>
                <p><strong>Strategy:</strong> NEISO's optimal crossover depends heavily on offshore wind cost outcomes. Under optimistic scenarios, push to 94%; under pessimistic scenarios, diversify at 91%. Monitor Vineyard Wind and other projects for cost signals before committing to targets above 93%.</p>
            </div>
        </div>
    </section>

    <!-- ================================================================ -->
    <!-- SECTION 7: IMPLICATIONS & KEY TAKEAWAYS                          -->
    <!-- ================================================================ -->
    <section class="scroll-section">
        <span class="section-number">Section 7</span>
        <h2 class="section-title">Key Takeaways: The Strategic Case for Portfolio Decarbonization</h2>
        <div class="section-narrative">
            <p>The analysis above leads to several conclusions that should reshape how organizations think about climate procurement strategy. These are not theoretical arguments -- they emerge directly from the cost data and regional optimization results.</p>
        </div>

        <ol class="insights-list" style="list-style:none; counter-reset:takeaway;">
            <li style="counter-increment:takeaway;">
                <strong>Grid decarbonization is the single best climate investment up to roughly 90% hourly clean energy.</strong> Across all five regions and all sensitivity scenarios, pushing grid procurement from the current baseline to 90% delivers abatement at costs well below alternatives. This is not a close call. Solar, wind, and batteries are mature, scalable, and cost-effective. Every organization should be pushing grid clean energy higher before considering alternatives.
            </li>
            <li style="counter-increment:takeaway;">
                <strong>The inflection zone between 92% and 97% is where strategy matters most.</strong> This is the range where regional differences, cost assumptions, and technology bets dramatically affect the optimal path. A one-size-fits-all target is a poor substitute for region-specific analysis. ERCOT can rationally target 97%; NYISO should likely cap at 92% and diversify.
            </li>
            <li style="counter-increment:takeaway;">
                <strong>The marginal cost of the last 3% often exceeds the cost of permanent carbon removal.</strong> At 97%+ grid clean energy, marginal abatement costs in most regions exceed $300-500/ton -- approaching or surpassing the cost of high-quality DAC. An organization spending $500/ton to squeeze the last 3% from the grid could instead purchase DAC removal credits for $400/ton and achieve the same (or better) climate outcome.
            </li>
            <li style="counter-increment:takeaway;">
                <strong>Region matters as much as target ambition.</strong> The gap between the cheapest region (ERCOT) and most expensive region (NYISO) is equivalent to 4-5 percentage points of grid target. A 95% target in ERCOT costs roughly the same per ton as a 90% target in NYISO. Multi-region procurement strategies should optimize across geography, not apply uniform targets.
            </li>
            <li style="counter-increment:takeaway;">
                <strong>The social cost of carbon ($51-185/ton) provides a useful floor test.</strong> Grid decarbonization is unambiguously justified at any target where marginal costs remain below the social cost of carbon. For most regions at Medium costs, this holds through 90-94%. Investments above this line are still valuable but require stronger strategic justification.
            </li>
            <li style="counter-increment:takeaway;">
                <strong>Cost trajectory matters: DAC is getting cheaper, grid's last mile is not.</strong> Grid decarbonization costs at 98-100% are structurally high because they reflect the physics of intermittency -- cloudy windless periods will always require expensive backup. DAC costs, by contrast, are on a learning curve. Today's $400/ton may be $200/ton by 2030. The rational portfolio shifts more toward removal as DAC scales.
            </li>
            <li style="counter-increment:takeaway;">
                <strong>The "90/10 framework" is a practical starting point.</strong> Push grid clean energy to 90-95% (region-dependent), then allocate remaining decarbonization budget to a diversified portfolio of carbon removal, cross-sector abatement (SAF, industrial efficiency), and high-quality credits. This approach maximizes climate impact per dollar while maintaining ambitious grid procurement targets.
            </li>
        </ol>

        <div class="callout-box" style="margin-top:36px;">
            <strong>The bottom line for procurement professionals:</strong> Grid decarbonization is not a destination -- it is a portfolio allocation problem. The smartest climate strategies will not be defined by how high they push a single number (grid % clean energy) but by how efficiently they allocate every dollar across the full spectrum of abatement and removal options. Set your grid target in the cost-effective zone, invest in the grid to get there, and deploy the savings from not chasing 100% into alternatives that deliver permanent, additional climate impact.
        </div>
    </section>

</main>

<!-- ========== FOOTER ========== -->
<footer class="page-footer">
    <div class="footer-links">
        <a href="dashboard.html">Back to Dashboard</a>
        <a href="region_caiso.html">CAISO</a>
        <a href="region_ercot.html">ERCOT</a>
        <a href="region_pjm.html">PJM</a>
        <a href="region_nyiso.html">NYISO</a>
        <a href="region_neiso.html">NEISO</a>
        <a href="optimizer_methodology.html">Methodology</a>
        <a href="research_paper.html">Research Paper</a>
    </div>
    <div class="footer-note">Hourly CFE Optimizer â€” 2025 Snapshot Model</div>
</footer>

<!-- ========== BOTTOM ACCENT BAR ========== -->
<div class="bottom-banner"></div>

<!-- ========================================================================= -->
<!-- JAVASCRIPT: Data, Charts, Visualizations                                  -->
<!-- ========================================================================= -->
<script>
// ============================================================================
// DATA: Placeholder regional MAC curves (plausible illustrative data)
// These will be replaced with real optimizer output when available.
// ============================================================================

const THRESHOLDS = [75, 80, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100];

// Marginal abatement cost $/ton CO2 at each threshold, by region and scenario
// Designed to tell a plausible story: hockey stick, regional divergence
const MAC_DATA = {
    medium: {
        CAISO:  [22, 28, 38, 42, 48, 56, 68, 82, 100, 125, 158, 200, 260, 350, 480, 650, 900, 1350],
        ERCOT:  [15, 20, 28, 31, 35, 40, 47, 56, 68,  82,  100, 125, 160, 210, 290, 410, 580, 850],
        PJM:    [18, 24, 34, 38, 44, 52, 62, 75, 92,  115, 145, 185, 240, 325, 450, 620, 860, 1250],
        NYISO:  [30, 40, 55, 62, 72, 85, 102, 125, 155, 195, 250, 320, 420, 560, 740, 980, 1300, 1850],
        NEISO:  [26, 35, 48, 54, 62, 74, 88, 108, 132, 165, 210, 270, 350, 470, 640, 870, 1180, 1700]
    },
    low: {
        CAISO:  [16, 20, 28, 31, 35, 40, 48, 58, 72,  90,  115, 148, 195, 265, 365, 500, 700, 1050],
        ERCOT:  [10, 14, 20, 22, 25, 28, 34, 40, 48,  58,  72,  90,  115, 152, 210, 300, 425, 640],
        PJM:    [13, 17, 24, 27, 31, 37, 44, 54, 66,  82,  105, 135, 175, 238, 330, 460, 645, 950],
        NYISO:  [22, 28, 40, 45, 52, 62, 74, 90, 112, 142, 182, 235, 310, 415, 555, 740, 990, 1420],
        NEISO:  [19, 25, 35, 39, 45, 53, 64, 78, 96,  120, 154, 200, 260, 350, 480, 655, 895, 1300]
    },
    high: {
        CAISO:  [30, 38, 52, 58, 66, 78, 94, 115, 140, 175, 220, 280, 365, 490, 670, 910, 1260, 1880],
        ERCOT:  [22, 28, 38, 42, 48, 55, 65, 78,  95,  115, 142, 178, 228, 300, 415, 580, 815, 1200],
        PJM:    [25, 32, 46, 52, 60, 72, 86, 105, 128, 160, 202, 258, 335, 455, 628, 865, 1200, 1740],
        NYISO:  [40, 54, 75, 85, 98, 118, 140, 172, 215, 270, 345, 445, 580, 775, 1020, 1350, 1800, 2550],
        NEISO:  [35, 47, 65, 74, 85, 100, 120, 148, 182, 228, 290, 375, 485, 650, 885, 1200, 1640, 2350]
    }
};

const REGION_COLORS = {
    CAISO: '#F59E0B',
    ERCOT: '#22C55E',
    PJM:   '#4a90d9',
    NYISO: '#E91E63',
    NEISO: '#9C27B0'
};

// Benchmark abatement cost data
const BENCHMARKS = [
    { name: 'Energy Efficiency',       low: 0,   mid: 20,  high: 50,  color: '#4CAF50' },
    { name: 'Voluntary Carbon Credits', low: 10,  mid: 50,  high: 150, color: '#9E9E9E' },
    { name: 'Industrial Electrification', low: 30, mid: 75, high: 150, color: '#8BC34A' },
    { name: 'Enhanced Weathering',      low: 50,  mid: 125, high: 200, color: '#795548' },
    { name: 'EU ETS Price',             low: 60,  mid: 80,  high: 100, color: '#2196F3' },
    { name: 'Social Cost of Carbon',    low: 51,  mid: 51,  high: 185, color: '#FF9800' },
    { name: 'BECCS',                    low: 100, mid: 175, high: 300, color: '#009688' },
    { name: 'Green H2 (Industrial)',    low: 100, mid: 200, high: 350, color: '#00BCD4' },
    { name: 'SAF',                      low: 150, mid: 250, high: 400, color: '#FF5722' },
    { name: 'DAC + Storage',            low: 250, mid: 400, high: 600, color: '#E91E63' }
];

// ============================================================================
// CHART 1: Regional MAC Curves (Section 2)
// ============================================================================

let macChart = null;
let currentScenario = 'medium';

function buildMacChart(scenario) {
    const ctx = document.getElementById('macCurveChart').getContext('2d');
    const data = MAC_DATA[scenario];

    const datasets = Object.keys(data).map(region => ({
        label: region,
        data: THRESHOLDS.map((t, i) => ({ x: t, y: data[region][i] })),
        borderColor: REGION_COLORS[region],
        backgroundColor: REGION_COLORS[region] + '18',
        borderWidth: 2.5,
        pointRadius: 3,
        pointHoverRadius: 6,
        fill: false,
        tension: 0.3
    }));

    // Horizontal benchmark lines
    const annotations = {
        sccLine: {
            type: 'line', yMin: 51, yMax: 51,
            borderColor: '#FF9800', borderWidth: 1.5, borderDash: [6, 4],
            label: { display: true, content: 'Social Cost of Carbon ($51)', position: 'start',
                     font: { size: 10, weight: 600 }, color: '#FF9800', backgroundColor: 'rgba(255,255,255,0.85)', padding: 3 }
        },
        euEtsLine: {
            type: 'line', yMin: 80, yMax: 80,
            borderColor: '#2196F3', borderWidth: 1.5, borderDash: [6, 4],
            label: { display: true, content: 'EU ETS ($80)', position: 'end',
                     font: { size: 10, weight: 600 }, color: '#2196F3', backgroundColor: 'rgba(255,255,255,0.85)', padding: 3 }
        },
        safLine: {
            type: 'line', yMin: 250, yMax: 250,
            borderColor: '#FF5722', borderWidth: 1.5, borderDash: [6, 4],
            label: { display: true, content: 'SAF Mid ($250)', position: 'start',
                     font: { size: 10, weight: 600 }, color: '#FF5722', backgroundColor: 'rgba(255,255,255,0.85)', padding: 3 }
        },
        dacLine: {
            type: 'line', yMin: 400, yMax: 400,
            borderColor: '#E91E63', borderWidth: 1.5, borderDash: [6, 4],
            label: { display: true, content: 'DAC Mid ($400)', position: 'end',
                     font: { size: 10, weight: 600 }, color: '#E91E63', backgroundColor: 'rgba(255,255,255,0.85)', padding: 3 }
        }
    };

    if (macChart) macChart.destroy();

    macChart = new Chart(ctx, {
        type: 'line',
        data: { datasets },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: { mode: 'nearest', intersect: false },
            scales: {
                x: {
                    type: 'linear',
                    min: 74, max: 101,
                    title: { display: true, text: 'Hourly Clean Energy Target (%)', font: { size: 13, weight: 600 } },
                    ticks: {
                        stepSize: 5,
                        callback: v => v + '%',
                        font: { size: 11 }
                    },
                    grid: { color: 'rgba(0,0,0,0.06)' }
                },
                y: {
                    type: 'logarithmic',
                    min: 10,
                    max: 2800,
                    title: { display: true, text: 'Marginal Abatement Cost ($/ton CO2)', font: { size: 13, weight: 600 } },
                    ticks: {
                        callback: v => {
                            if ([10,20,50,100,200,500,1000,2000].includes(v)) return '$' + v.toLocaleString();
                            return '';
                        },
                        font: { size: 11 }
                    },
                    grid: { color: 'rgba(0,0,0,0.06)' }
                }
            },
            plugins: {
                legend: {
                    position: 'top',
                    labels: { usePointStyle: true, pointStyle: 'circle', padding: 18, font: { size: 12, weight: 600 } }
                },
                tooltip: {
                    callbacks: {
                        title: items => items[0].raw.x + '% Target',
                        label: item => item.dataset.label + ': $' + item.raw.y.toLocaleString() + '/ton'
                    }
                },
                annotation: { annotations },
                datalabels: { display: false }
            }
        }
    });
}

function setScenario(scenario, btn) {
    currentScenario = scenario;
    document.querySelectorAll('.scenario-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    buildMacChart(scenario);
}

// ============================================================================
// CHART 2: The Abatement Ladder (Section 3) â€” Custom HTML/CSS/JS
// ============================================================================

function buildLadder() {
    const maxCost = 650;
    const scaleHeight = document.getElementById('ladderScale').offsetHeight || 480;
    const barsContainer = document.getElementById('ladderBars');
    const labelsContainer = document.getElementById('ladderLabels');
    const yAxisContainer = document.getElementById('ladderYAxis');
    const markersContainer = document.getElementById('ladderMarkers');

    // Y-axis labels
    const yTicks = [0, 50, 100, 150, 200, 250, 300, 400, 500, 600];
    yAxisContainer.innerHTML = '';
    yTicks.reverse().forEach(tick => {
        const label = document.createElement('div');
        label.className = 'ladder-y-label';
        label.textContent = '$' + tick;
        yAxisContainer.appendChild(label);
    });

    // Bars
    barsContainer.innerHTML = '';
    labelsContainer.innerHTML = '';
    BENCHMARKS.forEach((b, i) => {
        const group = document.createElement('div');
        group.className = 'ladder-bar-group';

        // Full range bar (low to high)
        const bar = document.createElement('div');
        bar.className = 'ladder-bar';
        const lowPct = (Math.min(b.low, maxCost) / maxCost) * 100;
        const highPct = (Math.min(b.high, maxCost) / maxCost) * 100;
        const midPct = (Math.min(b.mid, maxCost) / maxCost) * 100;
        bar.style.bottom = lowPct + '%';
        bar.style.height = (highPct - lowPct) + '%';
        bar.style.background = `linear-gradient(to top, ${b.color}55, ${b.color}cc)`;
        bar.style.border = `1px solid ${b.color}`;

        // Inner mid band (darker core)
        const inner = document.createElement('div');
        inner.className = 'ladder-bar-inner';
        const innerBottom = ((b.mid - b.low) / (b.high - b.low || 1)) * 100;
        inner.style.bottom = Math.max(0, innerBottom - 15) + '%';
        inner.style.height = '30%';
        inner.style.background = b.color;
        inner.style.opacity = '0.7';
        bar.appendChild(inner);

        // Cost label on top
        const costLabel = document.createElement('div');
        costLabel.className = 'ladder-bar-cost';
        costLabel.textContent = '$' + b.mid;
        bar.appendChild(costLabel);

        // Tooltip on hover
        bar.addEventListener('mouseenter', (e) => {
            const tooltip = document.getElementById('ladderTooltip');
            tooltip.innerHTML = `<div class="tt-title">${b.name}</div><div class="tt-range">Low: $${b.low}/ton<br>Mid: $${b.mid}/ton<br>High: $${b.high}/ton</div>`;
            tooltip.style.display = 'block';
            positionTooltip(e, tooltip);
        });
        bar.addEventListener('mousemove', (e) => {
            positionTooltip(e, document.getElementById('ladderTooltip'));
        });
        bar.addEventListener('mouseleave', () => {
            document.getElementById('ladderTooltip').style.display = 'none';
        });

        group.appendChild(bar);
        barsContainer.appendChild(group);

        // Bottom label
        const label = document.createElement('div');
        label.className = 'ladder-bar-label';
        label.textContent = b.name;
        label.style.flex = '1';
        label.style.textAlign = 'center';
        labelsContainer.appendChild(label);
    });

    // Grid threshold marker lines
    markersContainer.innerHTML = '';
    const gridMarkers = [
        { label: 'Grid 90% (ERCOT)', cost: 56, color: REGION_COLORS.ERCOT },
        { label: 'Grid 90% (NYISO)', cost: 125, color: REGION_COLORS.NYISO },
        { label: 'Grid 95% (ERCOT)', cost: 160, color: REGION_COLORS.ERCOT },
        { label: 'Grid 95% (NYISO)', cost: 420, color: REGION_COLORS.NYISO },
        { label: 'Grid 99% (ERCOT)', cost: 580, color: REGION_COLORS.ERCOT },
    ];

    gridMarkers.forEach(m => {
        const line = document.createElement('div');
        line.className = 'ladder-grid-line';
        const pct = (Math.min(m.cost, maxCost) / maxCost) * 100;
        line.style.bottom = pct + '%';
        line.style.borderColor = m.color;

        const tag = document.createElement('div');
        tag.className = 'ladder-grid-tag';
        tag.textContent = m.label;
        tag.style.background = m.color;
        tag.style.color = '#fff';
        tag.style.fontSize = '0.65rem';
        line.appendChild(tag);

        markersContainer.appendChild(line);
    });
}

function positionTooltip(e, tooltip) {
    const x = e.clientX + 16;
    const y = e.clientY - 10;
    tooltip.style.left = Math.min(x, window.innerWidth - 300) + 'px';
    tooltip.style.top = Math.min(y, window.innerHeight - 150) + 'px';
}

// ============================================================================
// CHART 3: Band Comparison Chart (Section 3, alternative view)
// ============================================================================

function buildBandChart() {
    const ctx = document.getElementById('bandChart').getContext('2d');

    // Horizontal floating bar chart: each benchmark is a row
    const labels = BENCHMARKS.map(b => b.name);
    const backgroundColors = BENCHMARKS.map(b => b.color + '40');
    const borderColors = BENCHMARKS.map(b => b.color);

    // Floating bars (low to high range)
    const barData = BENCHMARKS.map(b => [b.low, b.high]);
    // Mid point markers
    const midPoints = BENCHMARKS.map(b => b.mid);

    // Grid crossover scatter points for each region at different thresholds
    const gridScatter = [];
    const regions = ['CAISO', 'ERCOT', 'PJM', 'NYISO', 'NEISO'];
    const markerThresholds = [90, 95, 99];
    const thresholdSymbols = { 90: 'circle', 95: 'triangle', 99: 'rectRot' };

    regions.forEach(region => {
        markerThresholds.forEach(t => {
            const tIdx = THRESHOLDS.indexOf(t);
            if (tIdx === -1) return;
            const cost = MAC_DATA.medium[region][tIdx];
            gridScatter.push({
                region,
                threshold: t,
                cost,
                color: REGION_COLORS[region]
            });
        });
    });

    const chart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels,
            datasets: [
                {
                    label: 'Cost Range (Low to High)',
                    data: barData,
                    backgroundColor: backgroundColors,
                    borderColor: borderColors,
                    borderWidth: 2,
                    borderRadius: 4,
                    borderSkipped: false,
                    barPercentage: 0.65
                },
                {
                    label: 'Mid Estimate',
                    data: midPoints.map((v, i) => v),
                    type: 'scatter',
                    pointRadius: 7,
                    pointStyle: 'rectRounded',
                    backgroundColor: borderColors.map(c => c + 'cc'),
                    borderColor: borderColors,
                    borderWidth: 2,
                    parsing: {
                        xAxisKey: undefined,
                        yAxisKey: undefined
                    },
                    // Place scatter points manually
                    xAxisID: 'x',
                    yAxisID: 'y'
                }
            ]
        },
        options: {
            indexAxis: 'y',
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    min: 0,
                    max: 650,
                    title: { display: true, text: '$/ton CO2', font: { size: 13, weight: 600 } },
                    ticks: {
                        stepSize: 50,
                        callback: v => '$' + v,
                        font: { size: 10 }
                    },
                    grid: { color: 'rgba(0,0,0,0.06)' }
                },
                y: {
                    ticks: { font: { size: 11, weight: 500 } },
                    grid: { display: false }
                }
            },
            plugins: {
                legend: { display: false },
                tooltip: {
                    callbacks: {
                        label: (ctx) => {
                            if (Array.isArray(ctx.raw)) {
                                return `Range: $${ctx.raw[0]} - $${ctx.raw[1]}/ton`;
                            }
                            return `Mid: $${ctx.raw}/ton`;
                        }
                    }
                },
                datalabels: { display: false },
                annotation: {
                    annotations: {
                        ercot90: { type: 'line', xMin: 56, xMax: 56, borderColor: REGION_COLORS.ERCOT + 'aa', borderWidth: 2, borderDash: [4, 3],
                            label: { display: true, content: 'ERCOT 90%', position: 'start', font: { size: 9 }, color: REGION_COLORS.ERCOT, backgroundColor: 'rgba(255,255,255,0.9)', padding: 2 } },
                        caiso95: { type: 'line', xMin: 260, xMax: 260, borderColor: REGION_COLORS.CAISO + 'aa', borderWidth: 2, borderDash: [4, 3],
                            label: { display: true, content: 'CAISO 95%', position: 'end', font: { size: 9 }, color: REGION_COLORS.CAISO, backgroundColor: 'rgba(255,255,255,0.9)', padding: 2 } },
                        nyiso95: { type: 'line', xMin: 420, xMax: 420, borderColor: REGION_COLORS.NYISO + 'aa', borderWidth: 2, borderDash: [4, 3],
                            label: { display: true, content: 'NYISO 95%', position: 'start', font: { size: 9 }, color: REGION_COLORS.NYISO, backgroundColor: 'rgba(255,255,255,0.9)', padding: 2 } },
                        pjm97: { type: 'line', xMin: 450, xMax: 450, borderColor: REGION_COLORS.PJM + 'aa', borderWidth: 2, borderDash: [4, 3],
                            label: { display: true, content: 'PJM 97%', position: 'end', font: { size: 9 }, color: REGION_COLORS.PJM, backgroundColor: 'rgba(255,255,255,0.9)', padding: 2 } }
                    }
                }
            }
        }
    });
}

// ============================================================================
// TABLE: Inflection Point Analysis (Section 4)
// ============================================================================

function buildInflectionTable() {
    // Plausible threshold values where marginal cost exceeds each benchmark
    // Based on our MAC data â€” find where each region's medium curve crosses each cost level
    const benchmarkLevels = {
        'scc': 51,     // Social cost of carbon (EPA)
        'euEts': 80,   // EU ETS
        'safLow': 150, // SAF low end
        'dacLow': 250  // DAC low end
    };

    function findCrossover(regionData, costLevel) {
        for (let i = 0; i < regionData.length; i++) {
            if (regionData[i] >= costLevel) {
                return THRESHOLDS[i];
            }
        }
        return '>100';
    }

    function cellClass(val) {
        if (val === '>100') return 'cell-green';
        if (val >= 97) return 'cell-green';
        if (val >= 95) return 'cell-yellow';
        if (val >= 92) return 'cell-orange';
        return 'cell-red';
    }

    const tbody = document.getElementById('inflectionBody');
    const regions = ['CAISO', 'ERCOT', 'PJM', 'NYISO', 'NEISO'];
    const medData = MAC_DATA.medium;

    // Also add a column for $500
    regions.forEach(region => {
        const row = document.createElement('tr');
        const scc = findCrossover(medData[region], 51);
        const euEts = findCrossover(medData[region], 80);
        const saf = findCrossover(medData[region], 150);
        const dac = findCrossover(medData[region], 250);
        const extreme = findCrossover(medData[region], 500);

        row.innerHTML = `
            <td>${region}</td>
            <td class="${cellClass(scc)}">${scc === '>100' ? '>100%' : scc + '%'}</td>
            <td class="${cellClass(euEts)}">${euEts === '>100' ? '>100%' : euEts + '%'}</td>
            <td class="${cellClass(saf)}">${saf === '>100' ? '>100%' : saf + '%'}</td>
            <td class="${cellClass(dac)}">${dac === '>100' ? '>100%' : dac + '%'}</td>
            <td class="${cellClass(extreme)}">${extreme === '>100' ? '>100%' : extreme + '%'}</td>
        `;
        tbody.appendChild(row);
    });
}

// ============================================================================
// CHART 4: Portfolio Optimization (Section 5)
// ============================================================================

function buildPortfolioChart() {
    const ctx = document.getElementById('portfolioChart').getContext('2d');

    // X-axis: grid target from 75 to 100
    const targets = [75, 80, 85, 88, 90, 92, 94, 95, 96, 97, 98, 99, 100];

    // Stacked area: conceptual optimal portfolio allocation (% of total decarbonization budget)
    // As grid target rises, grid share declines and alternatives increase
    const gridShare =     [95, 92, 88, 85, 80, 72, 62, 55, 45, 35, 25, 18, 10];
    const efficiencyShare = [3, 5,  7,  8,  10, 12, 14, 15, 16, 16, 15, 14, 12];
    const crossSector =   [1.5, 2, 3,  4,  5,  8,  12, 15, 18, 22, 26, 28, 30];
    const removal =       [0.5, 1, 2,  3,  5,  8,  12, 15, 21, 27, 34, 40, 48];

    new Chart(ctx, {
        type: 'line',
        data: {
            labels: targets.map(t => t + '%'),
            datasets: [
                {
                    label: 'Grid Decarbonization',
                    data: gridShare,
                    backgroundColor: 'rgba(74,144,217,0.35)',
                    borderColor: '#4a90d9',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4,
                    pointRadius: 3
                },
                {
                    label: 'Energy Efficiency & Electrification',
                    data: efficiencyShare,
                    backgroundColor: 'rgba(34,197,94,0.30)',
                    borderColor: '#22C55E',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4,
                    pointRadius: 3
                },
                {
                    label: 'Cross-Sector (SAF, Green H2)',
                    data: crossSector,
                    backgroundColor: 'rgba(255,152,0,0.30)',
                    borderColor: '#FF9800',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4,
                    pointRadius: 3
                },
                {
                    label: 'Carbon Removal (DAC, BECCS)',
                    data: removal,
                    backgroundColor: 'rgba(233,30,99,0.30)',
                    borderColor: '#E91E63',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.4,
                    pointRadius: 3
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: { mode: 'index', intersect: false },
            scales: {
                x: {
                    title: { display: true, text: 'Grid Clean Energy Target', font: { size: 13, weight: 600 } },
                    ticks: { font: { size: 11 } },
                    grid: { color: 'rgba(0,0,0,0.04)' }
                },
                y: {
                    stacked: false,
                    min: 0,
                    max: 100,
                    title: { display: true, text: 'Share of Decarbonization Budget (%)', font: { size: 13, weight: 600 } },
                    ticks: {
                        callback: v => v + '%',
                        font: { size: 11 }
                    },
                    grid: { color: 'rgba(0,0,0,0.06)' }
                }
            },
            plugins: {
                legend: { display: false },
                tooltip: {
                    callbacks: {
                        label: (ctx) => ctx.dataset.label + ': ' + ctx.raw + '%'
                    }
                },
                datalabels: { display: false },
                annotation: {
                    annotations: {
                        inflection: {
                            type: 'line',
                            xMin: 4, xMax: 4,  // index of 90%
                            borderColor: 'rgba(0,0,0,0.25)',
                            borderWidth: 2,
                            borderDash: [6, 4],
                            label: {
                                display: true,
                                content: 'Inflection Zone',
                                position: 'start',
                                font: { size: 11, weight: 600 },
                                color: 'rgba(0,0,0,0.5)',
                                backgroundColor: 'rgba(255,255,255,0.8)',
                                padding: 4
                            }
                        }
                    }
                }
            }
        }
    });
}

// ============================================================================
// INITIALIZATION
// ============================================================================

document.addEventListener('DOMContentLoaded', () => {
    buildMacChart('medium');
    buildLadder();
    buildBandChart();
    buildInflectionTable();
    buildPortfolioChart();

    // Animated counters
    const counters = document.querySelectorAll('.counter-value[data-target]');
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const el = entry.target;
                const target = parseInt(el.dataset.target);
                const suffix = el.dataset.suffix || '';
                animateCounter(el, target, suffix);
                observer.unobserve(el);
            }
        });
    }, { threshold: 0.5 });

    counters.forEach(c => observer.observe(c));

    // Resize ladder on window resize
    let resizeTimeout;
    window.addEventListener('resize', () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(buildLadder, 200);
    });
});

function animateCounter(el, target, suffix) {
    const duration = 1200;
    const start = performance.now();
    function update(now) {
        const elapsed = now - start;
        const progress = Math.min(elapsed / duration, 1);
        const eased = 1 - Math.pow(1 - progress, 3);
        const current = Math.round(target * eased);
        el.textContent = current + suffix;
        if (progress < 1) requestAnimationFrame(update);
    }
    requestAnimationFrame(update);
}
</script>

</body>
</html>
